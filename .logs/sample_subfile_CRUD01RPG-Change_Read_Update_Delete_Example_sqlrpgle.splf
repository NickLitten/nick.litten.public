>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
CPC2198: Current library changed to NLITTEN1.
CPC2196: Library NLITTEN1 added to library list.

>> executing command: crtsqlrpgi obj(NLITTEN1/CRUD01RPG) srcstmf('/home/nlitten/builds/nick.litten.public/sample_subfile/CRUD01RPG-Change_Read_Update_Delete_Example.sqlrpgle') COMMIT(*NONE ) OBJTYPE(*MODULE) OPTION(*EVENTF) OUTPUT(*PRINT) TEXT('Change Read Update Delete Example') TGTRLS(V7R4M0) DBGVIEW(*SOURCE) RPGPPOPT(*LVL2) COMPILEOPT('TGTCCSID(*JOB) OPTIMIZE() INCDIR(''includes'')')
>> liblist: QSYS QSYS2 QHLPSYS QUSRSYS QSHELL NLITTEN1 NLITTEN1 QTEMP QGPL
>> executing time: 2025-05-09-08.21.10.00

RNS9308: Compilation stopped. Severity 30 errors found in program.
RNS9309: Compilation failed. Module CRUD01RPG not created in library NLITTEN1.
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      1
  Command  . . . . . . . . . . . . :   CRTRPGMOD
    Issued by  . . . . . . . . . . :     NICKLITTEN
  Module . . . . . . . . . . . . . :   CRUD01RPG
    Library  . . . . . . . . . . . :     NLITTEN1
  Text 'description' . . . . . . . :   Change Read Update Delete Example
  Source stream file   . . . . . . :   /home/nlitten/builds/nick.litten.public/sample_sub
                                       file/CRUD01RPG-Change_Read_Update_Delete_Example.s
                                       qlrpgle
    CCSID  . . . . . . . . . . . . :     1208
  Target CCSID . . . . . . . . . . :   *JOB (37)
  Text 'description' . . . . . . . :
  Last Change  . . . . . . . . . . :   25-05-09  06:44:57
  Generation severity level  . . . :   10
  Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                       *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                       *DEBUGIO   *UNREF     *EVENTF
  Debugging views  . . . . . . . . :   *ALL
  Debug encryption key . . . . . . :   *NONE
  Output . . . . . . . . . . . . . :   *PRINT
  Optimization level . . . . . . . :   *NONE
  Source listing indentation . . . :   *NONE
  Type conversion options  . . . . :   *NONE
  Sort sequence  . . . . . . . . . :   *JOB
  Language identifier  . . . . . . :   *JOB
  Replace module . . . . . . . . . :   *YES
  Authority  . . . . . . . . . . . :   *LIBCRTAUT
  Truncate numeric . . . . . . . . :   *YES
  Fix numeric  . . . . . . . . . . :   *NONE
  Target release . . . . . . . . . :   V7R4M0
  Allow null values  . . . . . . . :   *NO
  Storage model . . .  . . . . . . :   *INHERIT
  Binding directory  . . . . . . . :   *NONE
  Define condition names . . . . . :   *NONE
  Enable performance collection  . :   *PEP
  Profiling data . . . . . . . . . :   *NOCOL
  Licensed Internal Code options . :
  Generate program interface . . . :   *NO
  Include directory  . . . . . . . :   includes
  Preprocessor options . . . . . . :   *NORMVCOMMENT *EXPINCLUDE   *NOSEQSRC
  Output source file . . . . . . . :   QSQLPRE
    Library  . . . . . . . . . . . :     QTEMP
  Output source member . . . . . . :   CRUD01RPG
  MINIMUM OUTPUT LINE LENGTH . . . :   100
  Require prototype for export . . :   *NO
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      2
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
                          S o u r c e   L i s t i n g
     1 **free                                                                                                               000001
     2                                                                                                                      000002
     3 // --------------------------------------------------------------------------                                        000003
     4 // *** WORK IN PROGRESS _ NOT FINISHED YET ***                                                                       000004
     5 // --------------------------------------------------------------------------                                        000005
     6 ctl-opt main(mainline) copyright('| CRUD01RPG 2025.04.11');                                                          000006
     7                                                                                                                      000007
     8 dcl-f CRUD01PNL workstn sfile(SFLTASK:taskrrn) usropn infds(infds);                                                  000008
     9                                                                                                                      000009
    10 /include 'information_data_structures.rpgleinc'                                                                      000010
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
        *--------------------------------------------------------------------------------------------*
        * RPG member name  . . . . . :  informati+                                                   *                     1
        * External name  . . . . . . :  includes/information_data_structures.rpgleinc                *                     1
        * Last change  . . . . . . . :  25-05-09  06:41:09                                           *                     1
        *--------------------------------------------------------------------------------------------*
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    11+**FREE                                                                                                              1000001
    12+                                                                                                                    1000002
    13+Dcl-Ds infds qualified;                                                                                             1000003
    14+  FileOpen ind pos(9); // File Open Indicator?                                                                      1000004
    15+  FileEOF ind pos(10); // File at End of File?                                                                      1000005
    16+  ListingLine char(8) pos(30);                                                                                      1000006
    17+  // --SpecialStatus zoned(5) pos(38);                                                                              1000007
    18+  File char(10) pos(83);                                                                                            1000008
    19+  fileType int(5) pos(147);                                                                                         1000009
    20+  Lib char(10) pos(93);                                                                                             1000010
    21+  RcdLen int(5) pos(125);                                                                                           1000011
    22+  keyLen int(5) pos(127); // Max key len                                                                            1000012
    23+  Mbr char(10) pos(129);                                                                                            1000013
    24+  RcdsReadSinceOpen int(10) pos(156); // number of records retrieved since open                                     1000014
    25+  Ccsid int(5) pos(218);                                                                                            1000015
    26+  RRNlastRead int(10) pos(247); // relative record number of last record processed                                  1000016
    27+  Rcdfmt char(10) pos(261);                                                                                         1000017
    28+  SflRcdNbr int(5) pos(378);                                                                                        1000018
    29+  RRN int(10) pos(397);                                                                                             1000019
    30+  // DSPF BITs                                                                                                      1000020
    31+  funcKey char(1) pos(369); // DS@AID for nice "funckey = PageDown" type syntax                                     1000021
    32+  RowColumn int(5) pos(370); // DS@POS - cursor row & column                                                        1000022
    33+  firstRrnOnScreen int(5) pos(378); // DS@TOP SFL RRN Top of scrn                                                   1000023
    34+  totalSflRows int(5) pos(380); // DS@TOT records in subfile                                                        1000024
    35+  // PRTF BITs                                                                                                      1000025
    36+  printPageSize int(5) pos(152); // PR@SIZ page size                                                                1000026
    37+  printOverflow int(5) pos(188); // PR@FLW printer file overflow                                                    1000027
    38+  printCurrentLine int(5) pos(367); // PR@CLN current line number                                                   1000028
    39+  // *PRTF Stuff:                                                                                                   1000029
    40+  PageSize int(5) pos(152); // PR@SIZ page size                                                                     1000030
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      3
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    41+  Overflow int(5) pos(188); // PR@FLW printer file overflow                                                         1000031
    42+  CurrentLine int(5) pos(367); // PR@CLN current line number                                                        1000032
    43+  CurrentPage int(10) pos(369);                                                                                     1000033
    44+  // Error MSGID -- available after POST                                                                            1000034
    45+  MsgID char(7) pos(46);                                                                                            1000035
    46+  ODPtype char(2) pos(81); // ODP Type                                                                              1000036
    47+  splf char(10) pos(103);                                                                                           1000037
    48+  splfLib char(10) pos(113);                                                                                        1000038
    49+  splfNumber int(5) pos(123);                                                                                       1000039
    50+  // *DSPF Stuff:                                                                                                   1000040
    51+  SflRRN int(5) pos(376);                                                                                           1000041
    52+  SflMinRRN int(5) pos(378);                                                                                        1000042
    53+  SflNumRcds int(5) pos(380);                                                                                       1000043
    54+  ActualCursor char(2) pos(382);                                                                                    1000044
    55+  NumberOfRows int(5) pos(282);                                                                                     1000045
    56+  NumberOfCols int(5) pos(284);                                                                                     1000046
    57+  nbrOfRows int(5) pos(152);                                                                                        1000047
    58+  nbrOfCol int(5) pos(154);                                                                                         1000048
    59+  nbrRcds int(10) pos(156);                                                                                         1000049
    60+  accessType char(2) pos(160);                                                                                      1000050
    61+  DupKey char(1) pos(162);                                                                                          1000051
    62+  srcFile char(1) pos(163);                                                                                         1000052
    63+  VolumeLavelOffset int(5) pos(184);                                                                                1000053
    64+  MaxRcdsInBlock int(5) pos(186);                                                                                   1000054
    65+  BlockIncrement int(5) pos(190);                                                                                   1000055
    66+  deviceClass char(1) pos(271);                                                                                     1000056
    67+  deviceType char(6) pos(272);                                                                                      1000057
    68+  Requester char(1) pos(278);                                                                                       1000058
    69+  AcquireStatus char(1) pos(279);                                                                                   1000059
    70+  InviteStatus char(1) pos(280);                                                                                    1000060
    71+  DataAvailable char(1) pos(281);                                                                                   1000061
    72+  AllowBlink char(1) pos(286);                                                                                      1000062
    73+  OnlineOffline char(1) pos(287);                                                                                   1000063
    74+  DisplayLocation char(1) pos(288);                                                                                 1000064
    75+  DisplayType char(1) pos(289);                                                                                     1000065
    76+  KeyboardType char(1) pos(290);                                                                                    1000066
    77+  ControllerInfo char(1) pos(342);                                                                                  1000067
    78+  ColorCapable char(1) pos(343);                                                                                    1000068
    79+  MiscFlags1 char(1) pos(196);                                                                                      1000069
    80+  OepCount int(5) pos(207);                                                                                         1000070
    81+  NumBasedMbrs int(5) pos(211);                                                                                     1000071
    82+  MiscFlags2 char(1) pos(213);                                                                                      1000072
    83+  OpenID char(2) pos(214);                                                                                          1000073
    84+  RcdFmtLen int(5) pos(216);                                                                                        1000074
    85+  MiscFlags3 char(1) pos(220);                                                                                      1000075
    86+  NUM_DEVS int(5) pos(227);                                                                                         1000076
    87+  writeCount int(10) pos(243);                                                                                      1000077
    88+  readCount int(10) pos(247);                                                                                       1000078
    89+  writeReadCount int(10) pos(251);                                                                                  1000079
    90+  otherIOCount int(10) pos(255);                                                                                    1000080
    91+  currentOperations char(1) pos(260);                                                                               1000081
    92+  DevClass char(2) pos(271);                                                                                        1000082
    93+  PgmDevName char(10) pos(273);                                                                                     1000083
    94+  IOrcdLen int(10) pos(283);                                                                                        1000084
    95+  PgmDevice char(10) pos(241);                                                                                      1000085
    96+  DeviceDesc char(10) pos(251);                                                                                     1000086
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      4
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    97+  user char(10) pos(261);                                                                                           1000087
    98+  // Disk :                                                                                                         1000088
    99+  NbrLockedRcds int(5) pos(377);                                                                                    1000089
   100+  FilePosBits char(1) pos(385);                                                                                     1000090
   101+  RcdDeletedBits char(1) pos(384);                                                                                  1000091
   102+  Numkeys int(5) pos(387);                                                                                          1000092
   103+  Keylength int(5) pos(393);                                                                                        1000093
   104+  MemberNumber int(5) pos(395);                                                                                     1000094
   105+end-ds;                                                                                                             1000095
   106+                                                                                                                    1000096
   107+Dcl-Ds infds_DB likeds(infds);                                                                                      1000097
   108+Dcl-Ds infds_DSPF likeds(infds);                                                                                    1000098
   109+Dcl-Ds infds_PRTF likeds(infds);                                                                                    1000099
   110+                                                                                                                    1000100
   111+// Hexadecimal representation of function Keys                                                                      1000101
   112+// If you use an INFDS against your display file you can check functions by                                         1000102
   113+// using : IF infs.funcKey = PFKEY03;                                                                               1000103
   114+Dcl-C ENTER CONST(X'F1');                                                                                           1000104
   115+Dcl-C HELP CONST(X'F3');                                                                                            1000105
   116+Dcl-C PAGEUP CONST(X'F4');                                                                                          1000106
   117+Dcl-C PAGEDOWN CONST(X'F5');                                                                                        1000107
   118+Dcl-C PRINT CONST(X'F6');                                                                                           1000108
   119+Dcl-C RECORDBACKSPAC CONST(X'F8');                                                                                  1000109
   120+Dcl-C PFKEY01 CONST(X'31');                                                                                         1000110
   121+Dcl-C PFKEY02 CONST(X'32');                                                                                         1000111
   122+Dcl-C PFKEY03 CONST(X'33');                                                                                         1000112
   123+Dcl-C PFKEY04 CONST(X'34');                                                                                         1000113
   124+Dcl-C PFKEY05 CONST(X'35');                                                                                         1000114
   125+Dcl-C PFKEY06 CONST(X'36');                                                                                         1000115
   126+Dcl-C PFKEY07 CONST(X'37');                                                                                         1000116
   127+Dcl-C PFKEY08 CONST(X'38');                                                                                         1000117
   128+Dcl-C PFKEY09 CONST(X'39');                                                                                         1000118
   129+Dcl-C PFKEY10 CONST(X'3A');                                                                                         1000119
   130+Dcl-C PFKEY11 CONST(X'3B');                                                                                         1000120
   131+Dcl-C PFKEY12 CONST(X'3C');                                                                                         1000121
   132+Dcl-C PFKEY13 CONST(X'B1');                                                                                         1000122
   133+Dcl-C PFKEY14 CONST(X'B2');                                                                                         1000123
   134+Dcl-C PFKEY15 CONST(X'B3');                                                                                         1000124
   135+Dcl-C PFKEY16 CONST(X'B4');                                                                                         1000125
   136+Dcl-C PFKEY17 CONST(X'B5');                                                                                         1000126
   137+Dcl-C PFKEY18 CONST(X'B6');                                                                                         1000127
   138+Dcl-C PFKEY19 CONST(X'B7');                                                                                         1000128
   139+Dcl-C PFKEY20 CONST(X'B8');                                                                                         1000129
   140+Dcl-C PFKEY21 CONST(X'B9');                                                                                         1000130
   141+Dcl-C PFKEY22 CONST(X'BA');                                                                                         1000131
   142+Dcl-C PFKEY23 CONST(X'BB');                                                                                         1000132
   143+Dcl-C PFKEY24 CONST(X'BC');                                                                                         1000133
   144+Dcl-C CLEAR CONST(X'BD');                                                                                           1000134
   145+                                                                                                                    1000135
   146                                                                                                                      000011
   147 // Validation indicators                                                                                             000012
   148 Dcl-S ptrDisplayIndicators Pointer Inz(%Addr(*In));                                                                  000013
   149 Dcl-Ds DisplayIndicators Based(ptrDisplayIndicators);                                                                000014
   150   // Subfile indicators                                                                                              000015
   151   SflDsp          Ind Pos(99);                                                                                       000016
   152   SflDspCtl       Ind Pos(98);                                                                                       000017
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      5
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   153   SflClr          Ind Pos(97);                                                                                       000018
   154   SflEnd          Ind Pos(96);                                                                                       000019
   155   // Validation Errors                                                                                               000020
   156   Taskidexisterror_31 Ind Pos(31);                                                                                   000021
   157   Startdateerror_32  Ind Pos(32);                                                                                    000022
   158   Enddateerror_33 Ind Pos(33);                                                                                       000023
   159   Dategreaterthanerror_34 Ind Pos(34);                                                                               000024
   160   ProtectFields_35 Ind Pos(35);                                                                                      000025
   161   ProtectFields_36 Ind Pos(36);                                                                                      000026
   162   IndErrors char(20) Pos(31);                                                                                        000027
   163 end-ds;                                                                                                              000028
   164                                                                                                                      000029
   165 // Variable Pointer for SQL Errors                                                                                   000030
   166 Dcl-S pSqlstate Pointer Inz(%Addr(SQLState));                                                                        000031
   167                                                                                                                      000032
   168 Dcl-Ds Ds_SqlState based(pSqlstate);                                                                                 000033
   169   xSqlstate char(2);                                                                                                 000034
   170 end-ds;                                                                                                              000035
   171                                                                                                                      000036
   172 // Constant error on SQL                                                                                             000037
   173 Dcl-C SUCCESS_ON_SQL '00';                                                                                           000038
   174 Dcl-C WARNING_ON_SQL '01';                                                                                           000039
   175 Dcl-C NODATA_ON_SQL  '02';                                                                                           000040
   176                                                                                                                      000041
   177 // Data structure based in the query neccesary for fill the subfile of                                               000042
   178 // the file CRUD01TBL                                                                                                000043
   179 Dcl-Ds Ds_taskdata qualified;                                                                                        000044
   180   Taskid     zoned(10);                                                                                              000045
   181   Nametask    char(20);                                                                                              000046
   182   Start_date zoned(8);                                                                                               000047
   183   End_date   zoned(8);                                                                                               000048
   184   Taskstate  zoned(1);                                                                                               000049
   185 end-ds;                                                                                                              000050
   186                                                                                                                      000051
   187 // Data structure for general use in CRUD operations                                                                 000052
   188 Dcl-Ds Ds_datacrud extname('CRUD01TBL') qualified end-ds;                                                            000053
   189                                                                                                                      000054
   190 // Relative record number for SFLTASK subfile task                                                                   000055
   191 Dcl-S taskrrn zoned(3:0);                                                                                            000056
   192                                                                                                                      000057
   193 // Variables for subfile scroll position                                                                             000058
   194 Dcl-S Initialpos zoned(10:0) inz(0);                                                                                 000059
   195 Dcl-S Finalpos zoned(10:0) inz(10);                                                                                  000060
   196                                                                                                                      000061
   197 // Previous initial and finalpos for indicates final                                                                 000062
   198 Dcl-S Previnitialpos zoned(10:0);                                                                                    000063
   199 Dcl-S PrevFinalpos zoned(10:0) ;                                                                                     000064
   200                                                                                                                      000065
   201 // Variable for apply filter to subfile query                                                                        000066
   202 Dcl-S w_Wheresfl char(500) inz(*blanks);                                                                             000067
   203                                                                                                                      000068
   204 // Quantity of records per page in subfile change the inz value depend                                               000069
   205 // of your subfile capacity                                                                                          000070
   206 Dcl-C PERPAGE 10;                                                                                                    000071
   207                                                                                                                      000072
   208 // Variable for indicates that crud operations are finalized                                                         000073
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      6
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   209 Dcl-S w_Crudfinalize Ind;                                                                                            000074
   210                                                                                                                      000075
   211 // Variable with current user                                                                                        000076
   212 Dcl-S CurrentUser char(10) inz(*user);                                                                               000077
   213                                                                                                                      000078
   214                                                                                                                      000079
   215                                                                                                                      000080
   216                                                                                                                      000081
   217                                                                                                                      000082
   218                                                                                                                      000083
   219 // --------------------------------------------------------------------------                                        000084
   220 // This is the mainline process that is executed when the program is called                                          000085
   221 // --------------------------------------------------------------------------                                        000086
   222 Dcl-Proc mainline;                                                                                                   000087
   223                                                                                                                      000088
   224   Dcl-S choice char(1) inz(*blanks);                                                                                 000089
   225                                                                                                                      000090
   226   open CRUD01PNL;                                                                                                    000091
   227                                                                                                                      000092
   228   // The value 'S' is for Subfile Menu                                                                               000093
   229   choice = 'S';                                                                                                      000094
   230                                                                                                                      000095
   231   ShowScreen(choice);                                                                                                000096
   232                                                                                                                      000097
   233   // Termination of program                                                                                          000098
   234   close CRUD01PNL;                                                                                                   000099
   235   *Inlr = *On;                                                                                                       000100
   236 end-proc;                                                                                                            000101
   237                                                                                                                      000102
   238                                                                                                                      000103
   239                                                                                                                      000104
   240                                                                                                                      000105
   241                                                                                                                      000106
   242                                                                                                                      000107
   243 // --------------------------------------------------------------------------                                        000108
   244 // This procedure receives a parameter for the titles that are written                                               000109
   245 // --------------------------------------------------------------------------                                        000110
   246 Dcl-Proc WriteScreen;                                                                                                000111
   247   Dcl-Pi WriteScreen;                                                                                                000112
   248     p_choice char(1);                                                                                                000113
   249   end-pi;                                                                                                            000114
   250                                                                                                                      000115
   251   // Secondary titles                                                                                                000116
   252   TITLE2 = Center('Created by Some Bloke':%len(TITLE2));                                                             000117
   253   TITLE3 = Center('Back in 2018':%len(TITLE3));                                                                      000118
   254                                                                                                                      000119
   255   // Principal title                                                                                                 000120
   256   Select;                                                                                                            000121
   257                                                                                                                      000122
   258       // CRUD Options                                                                                                000123
   259     When (p_choice = 'I');                                                                                           000124
   260       TITLE1 = Center('TASKS ADMINISTRATOR INSERT':%len(TITLE1));                                                    000125
   261     When (p_choice = 'M');                                                                                           000126
   262       TITLE1 = Center('TASKS ADMINISTRATOR MODIFY':%len(TITLE1));                                                    000127
   263     When (p_choice = 'D');                                                                                           000128
   264       TITLE1 = Center('TASKS ADMINISTRATOR DELETE':%len(TITLE1));                                                    000129
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      7
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   265     When (p_choice = 'V');                                                                                           000130
   266       TITLE1 = Center('TASKS ADMINISTRATOR VIEW':%len(TITLE1));                                                      000131
   267                                                                                                                      000132
   268       // Subfile                                                                                                     000133
   269     When (p_choice = 'S');                                                                                           000134
   270       TITLE1 = Center('TASKS ADMINISTRATOR MAIN MENU':%len(TITLE1));                                                 000135
   271   EndSl;                                                                                                             000136
   272                                                                                                                      000137
   273   // Use an IF/ELSEIF as a different way of doing SELECT groups                                                      000138
   274   // here is an example:                                                                                             000139
   275   If (p_choice = 'S');                                                                                               000140
   276     FOOTTEXT = 'F3=Exit  F5=Refresh  F6=Create';                                                                     000141
   277   elseif (p_choice = 'I' or p_choice= 'M' or p_choice= 'D');                                                         000142
   278     FOOTTEXT = 'F3=Exit      F10=Confirm';                                                                           000143
   279   elseif (p_choice = 'V');                                                                                           000144
   280     FOOTTEXT = 'F3=Exit  ';                                                                                          000145
   281   EndIf;                                                                                                             000146
   282                                                                                                                      000147
   283   write HEADER;                                                                                                      000148
   284   write FOOTER;                                                                                                      000149
   285 end-proc;                                                                                                            000150
   286                                                                                                                      000151
   287                                                                                                                      000152
   288                                                                                                                      000153
   289                                                                                                                      000154
   290                                                                                                                      000155
   291                                                                                                                      000156
   292                                                                                                                      000157
   293                                                                                                                      000158
   294                                                                                                                      000159
   295                                                                                                                      000160
   296                                                                                                                      000161
   297                                                                                                                      000162
   298 // --------------------------------------------------------------------------                                        000163
   299 // This procedure executes and show the screen choiced by parameter                                                  000164
   300 // --------------------------------------------------------------------------                                        000165
   301 Dcl-Proc ShowScreen;                                                                                                 000166
   302   Dcl-Pi ShowScreen ;                                                                                                000167
   303     p_choice char(1);                                                                                                000168
   304   end-pi;                                                                                                            000169
   305                                                                                                                      000170
   306   Select;                                                                                                            000171
   307     When (p_choice = 'I');                                                                                           000172
   308       InsertScreen(p_choice);                                                                                        000173
   309     When (p_choice = 'S');                                                                                           000174
   310       ShowSubfile(p_choice);                                                                                         000175
   311     When (p_choice = 'M');                                                                                           000176
   312       ModifyScreen(p_choice);                                                                                        000177
   313     When (p_choice = 'D');                                                                                           000178
   314       DeleteScreen(p_choice);                                                                                        000179
   315     When (p_choice = 'V');                                                                                           000180
   316       ViewScreen(p_choice);                                                                                          000181
   317   EndSl;                                                                                                             000182
   318                                                                                                                      000183
   319 end-proc;                                                                                                            000184
   320                                                                                                                      000185
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      8
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   321                                                                                                                      000186
   322                                                                                                                      000187
   323                                                                                                                      000188
   324                                                                                                                      000189
   325                                                                                                                      000190
   326                                                                                                                      000191
   327 // --------------------------------------------------------------------------                                        000192
   328 // Show Window to user for confirm the current action                                                                000193
   329 // --------------------------------------------------------------------------                                        000194
   330 Dcl-Proc ShowWdw;                                                                                                    000195
   331   Dcl-Pi ShowWdw;                                                                                                    000196
   332     p_choice char(1);                                                                                                000197
   333   end-pi;                                                                                                            000198
   334                                                                                                                      000199
   335   // 'C' for confirm save record in database                                                                         000200
   336   If (p_choice = 'C');                                                                                               000201
   337     WDWTEXT1 = 'Are you sure to execute this action?';                                                               000202
   338     WDWTEXT2 = 'Please type Y/N ';                                                                                   000203
   339     write WDWCONFIRM;                                                                                                000204
   340     exfmt WDWCONFIRM;                                                                                                000205
   341   EndIf;                                                                                                             000206
   342                                                                                                                      000207
   343   // 'M' for message information                                                                                     000208
   344   If (p_choice = 'M');                                                                                               000209
   345     WDWMSG1 = 'Your record has been saved';                                                                          000210
   346     exfmt WDWMESSAGE;                                                                                                000211
   347   EndIf;                                                                                                             000212
   348                                                                                                                      000213
   349   If (p_choice = 'D');                                                                                               000214
   350     WDWMSG1 = 'Your record has been deleted';                                                                        000215
   351     exfmt WDWMESSAGE;                                                                                                000216
   352   EndIf;                                                                                                             000217
   353                                                                                                                      000218
   354   // 'E' for error message                                                                                           000219
   355   If (p_choice = 'E');                                                                                               000220
   356     WDWMSG1 = 'Error executing this action ';                                                                        000221
   357     exfmt WDWMESSAGE;                                                                                                000222
   358   EndIf;                                                                                                             000223
   359                                                                                                                      000224
   360 end-proc;                                                                                                            000225
   361                                                                                                                      000226
   362                                                                                                                      000227
   363                                                                                                                      000228
   364                                                                                                                      000229
   365                                                                                                                      000230
   366                                                                                                                      000231
   367                                                                                                                      000232
   368                                                                                                                      000233
   369                                                                                                                      000234
   370                                                                                                                      000235
   371                                                                                                                      000236
   372 // --------------------------------------------------------------------------                                        000237
   373 // This procedure Center the titles of the screen                                                                    000238
   374 // --------------------------------------------------------------------------                                        000239
   375 Dcl-Proc Center;                                                                                                     000240
   376   Dcl-Pi Center char(80);                                                                                            000241
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page      9
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   377     Par_Text char(80) value;                                                                                         000242
   378     Par_Length zoned(2:0) value;                                                                                     000243
   379   end-pi;                                                                                                            000244
   380                                                                                                                      000245
   381   // Local variables                                                                                                 000246
   382   Dcl-S LenBlanks zoned(2:0);                                                                                        000247
   383   Dcl-S InitPosition zoned(2:0);                                                                                     000248
   384   Dcl-S Centeredtext char(80);                                                                                       000249
   385                                                                                                                      000250
   386   LenBlanks= Par_Length - %Len(%Trim(Par_Text));                                                                     000251
   387   InitPosition = LenBlanks /2;                                                                                       000252
   388   %Subst(Centeredtext:InitPosition)= %Trim(Par_Text);                                                                000253
   389   Return Centeredtext;                                                                                               000254
   390                                                                                                                      000255
   391 end-proc;                                                                                                            000256
   392                                                                                                                      000257
   393                                                                                                                      000258
   394                                                                                                                      000259
   395                                                                                                                      000260
   396                                                                                                                      000261
   397                                                                                                                      000262
   398                                                                                                                      000263
   399                                                                                                                      000264
   400 // --------------------------------------------------------------------------                                        000265
   401 // Show the subfile in the screen                                                                                    000266
   402 // --------------------------------------------------------------------------                                        000267
   403 Dcl-Proc ShowSubfile;                                                                                                000268
   404   Dcl-Pi ShowSubfile;                                                                                                000269
   405     p_choice char(1);                                                                                                000270
   406   end-pi;                                                                                                            000271
   407                                                                                                                      000272
   408   Dcl-S w_exist char(1);                                                                                             000273
   409   Dcl-S choice char(1);                                                                                              000274
   410                                                                                                                      000275
   411   dow (not PFKEY03);                                                                                                 000276
   412     WriteScreen(p_choice);                                                                                           000277
   413     ActivateSubfile();                                                                                               000278
   414     exfmt SFLTASKCTL;                                                                                                000279
   415                                                                                                                      000280
   416     Select ;                                                                                                         000281
   417       When (PFKEY03);                                                                                                000282
   418         PFKEY03 = *Off;                                                                                              000283
   419         reset Initialpos;                                                                                            000284
   420         reset Finalpos;                                                                                              000285
   421         leave;                                                                                                       000286
   422       When (infds.funcKey = PAGEUP);                                                                                 000287
   423         If (Initialpos = 0 and Finalpos = 10);                                                                       000288
   424           iter;                                                                                                      000289
   425         elseif (Initialpos > 1 and Finalpos > 10);                                                                   000290
   426           Initialpos -= 11;                                                                                          000291
   427           Finalpos -= 10;                                                                                            000292
   428           ShowScreen(p_choice);                                                                                      000293
   429           leave;                                                                                                     000294
   430         EndIf;                                                                                                       000295
   431                                                                                                                      000296
   432       When (infds.funcKey = PAGEDOWN);                                                                               000297
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     10
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   433                                                                                                                      000298
   434         If (Initialpos > 0 and Finalpos > 10);                                                                       000299
   435                                                                                                                      000300
   436           exec sql                                                                                                   000301
   437           SELECT '1'                                                                                                 000302
   438             INTO : w_exist                                                                                           000303
   439             FROM (SELECT A.*,                                                                                        000304
   440                          RowNumber()                                                                                 000305
   441                     Over()                                                                                           000306
   442                     as RNum                                                                                          000307
   443                     FROM CRUD01TBL AS A                                                                              000308
   444                     Where 1 = 1)                                                                                     000309
   445             as Tbl                                                                                                   000310
   446             Where RNum BetWeen : Initialpos AND                                                                      000311
   447                   :Finalpos                                                                                          000312
   448             FETCH FIRST ROW ONLY;                                                                                    000313
   449                                                                                                                      000314
   450           If (w_exist <> '1');                                                                                       000315
   451             Initialpos -= 11;                                                                                        000316
   452             Finalpos -= 10;                                                                                          000317
   453           EndIf;                                                                                                     000318
   454                                                                                                                      000319
   455           ShowScreen(p_choice);                                                                                      000320
   456           leave;                                                                                                     000321
   457                                                                                                                      000322
   458         Else;                                                                                                        000323
   459           ShowScreen(p_choice);                                                                                      000324
   460           leave;                                                                                                     000325
   461         EndIf;                                                                                                       000326
   462                                                                                                                      000327
   463       When (pfkey(05));                                                                                              000328
   464                                                                                                                      000329
   465         reset Initialpos;                                                                                            000330
   466         reset Finalpos;                                                                                              000331
   467                                                                                                                      000332
   468         ShowScreen(p_choice);                                                                                        000333
   469         leave;                                                                                                       000334
   470       When (pfkey(06));                                                                                              000335
   471         choice = 'I';                                                                                                000336
   472         ShowScreen(choice);                                                                                          000337
   473         leave;                                                                                                       000338
   474       Other;                                                                                                         000339
   475         reset w_Wheresfl;                                                                                            000340
   476                                                                                                                      000341
   477         // if there are selected records in subfile then executes                                                    000342
   478         If (taskrrn > *zeros);                                                                                       000343
   479           for taskrrn = 1 to PERPAGE;                                                                                000344
   480             chain taskrrn SFLTASK;                                                                                   000345
   481             If (%found());                                                                                           000346
   482                                                                                                                      000347
   483               Select;                                                                                                000348
   484                 When (OPCTASK = '2');                                                                                000349
   485                                                                                                                      000350
   486                   clear Ds_datacrud;                                                                                 000351
   487                                                                                                                      000352
   488                   // Loads the data into data structure                                                              000353
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     11
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   489                   exec sql                                                                                           000354
   490                 SELECT * INTO:Ds_datacrud                                                                            000355
   491                   FROM CRUD01TBL                                                                                     000356
   492                   WHERE TASK_ID = : SFLTASKID;                                                                       000357
   493                                                                                                                      000358
   494                   choice = 'M';                                                                                      000359
   495                   ShowScreen(choice);                                                                                000360
   496                   leave;                                                                                             000361
   497                 When (OPCTASK = '4');                                                                                000362
   498                   clear Ds_datacrud;                                                                                 000363
   499                                                                                                                      000364
   500                   // Loads the data into data structure                                                              000365
   501                   exec sql                                                                                           000366
   502                 SELECT * INTO:Ds_datacrud                                                                            000367
   503                   FROM CRUD01TBL                                                                                     000368
   504                   WHERE TASK_ID = : SFLTASKID;                                                                       000369
   505                                                                                                                      000370
   506                   choice = 'D';                                                                                      000371
   507                   ShowScreen(choice);                                                                                000372
   508                   leave;                                                                                             000373
   509                 When (OPCTASK = '5');                                                                                000374
   510                   clear Ds_datacrud;                                                                                 000375
   511                                                                                                                      000376
   512                   // Loads the data into data structure                                                              000377
   513                   exec sql                                                                                           000378
   514                 SELECT * INTO:Ds_datacrud                                                                            000379
   515                   FROM CRUD01TBL                                                                                     000380
   516                   WHERE TASK_ID = : SFLTASKID;                                                                       000381
   517                                                                                                                      000382
   518                   choice = 'V';                                                                                      000383
   519                   ShowScreen(choice);                                                                                000384
   520                   leave;                                                                                             000385
   521               EndSl;                                                                                                 000386
   522               // Clean the field                                                                                     000387
   523               OPCTASK = *Blanks;                                                                                     000388
   524               Update SFLTASK;                                                                                        000389
   525             Else;                                                                                                    000390
   526               leave;                                                                                                 000391
   527             EndIf;                                                                                                   000392
   528           endfor;                                                                                                    000393
   529         EndIf;                                                                                                       000394
   530     EndSl;                                                                                                           000395
   531     If (w_Crudfinalize = *On);                                                                                       000396
   532       w_Crudfinalize = *Off;                                                                                         000397
   533       leave;                                                                                                         000398
   534     EndIf;                                                                                                           000399
   535                                                                                                                      000400
   536   enddo;                                                                                                             000401
   537                                                                                                                      000402
   538 end-proc ;                                                                                                           000403
   539                                                                                                                      000404
   540                                                                                                                      000405
   541                                                                                                                      000406
   542                                                                                                                      000407
   543                                                                                                                      000408
   544                                                                                                                      000409
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     12
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   545                                                                                                                      000410
   546 // --------------------------------------------------------------------------                                        000411
   547 // handle all screen validation                                                                                      000412
   548 // --------------------------------------------------------------------------                                        000413
   549 Dcl-Proc ScreenValidation ;                                                                                          000414
   550   Dcl-Pi ScreenValidation Ind;                                                                                       000415
   551     p_choice char(1);                                                                                                000416
   552   end-pi;                                                                                                            000417
   553                                                                                                                      000418
   554   Dcl-S w_ValidisnotOK Ind;                                                                                          000419
   555   Dcl-S w_Exists char(1);                                                                                            000420
   556                                                                                                                      000421
   557   // Set zeros in general variable based in  DisplayIndicators                                                       000422
   558   IndErrors = *zeros;                                                                                                000423
   559                                                                                                                      000424
   560   If (p_choice = 'I'); // Validations for Insert                                                                     000425
   561                                                                                                                      000426
   562     TurnoffErrors();                                                                                                 000427
   563                                                                                                                      000428
   564     // Search Task id entered into database                                                                          000429
   565     exec sql                                                                                                         000430
   566       SELECT '1'                                                                                                     000431
   567         INTO : w_Exists                                                                                              000432
   568         FROM CRUD01TBL                                                                                               000433
   569         WHERE TASK_ID = :CRUDTASKID;                                                                                 000434
   570                                                                                                                      000435
   571     Taskidexisterror_31 = (w_Exists = '1');                                                                          000436
   572                                                                                                                      000437
   573     // Validation of dates                                                                                           000438
   574     test(De) *iso STARTDATE; //Validates if date is in YYYYMMDD                                                      000439
   575                                                                                                                      000440
   576     Startdateerror_32 = %error;                                                                                      000441
   577                                                                                                                      000442
   578     test(De) *iso ENDDATE;                                                                                           000443
   579                                                                                                                      000444
   580     Enddateerror_33 = %error;                                                                                        000445
   581                                                                                                                      000446
   582     If (STARTDATE <> *zeros and ENDDATE <> *zeros                                                                    000447
   583         and Startdateerror_32 = *Off and Enddateerror_33 = *Off);                                                    000448
   584       If (STARTDATE > ENDDATE);                                                                                      000449
   585         Dategreaterthanerror_34 = *On;                                                                               000450
   586       EndIf;                                                                                                         000451
   587     EndIf;                                                                                                           000452
   588   EndIf;                                                                                                             000453
   589                                                                                                                      000454
   590   w_ValidisnotOK = IndErrors <> *Zeros;                                                                              000455
   591                                                                                                                      000456
   592   Return w_ValidisnotOK;                                                                                             000457
   593 end-proc;                                                                                                            000458
   594                                                                                                                      000459
   595                                                                                                                      000460
   596                                                                                                                      000461
   597                                                                                                                      000462
   598                                                                                                                      000463
   599                                                                                                                      000464
   600 // --------------------------------------------------------------------------                                        000465
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     13
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   601 // reset errors                                                                                                      000466
   602 // --------------------------------------------------------------------------                                        000467
   603 Dcl-Proc TurnoffErrors;                                                                                              000468
   604   Taskidexisterror_31 = *Off;                                                                                        000469
   605   Startdateerror_32 = *Off;                                                                                          000470
   606   Enddateerror_33 = *Off;                                                                                            000471
   607   Dategreaterthanerror_34 = *Off;                                                                                    000472
   608 end-proc ;                                                                                                           000473
   609                                                                                                                      000474
   610                                                                                                                      000475
   611                                                                                                                      000476
   612                                                                                                                      000477
   613                                                                                                                      000478
   614 // --------------------------------------------------------------------------                                        000479
   615 // This procedure set the sql variable to the procedure to                                                           000480
   616 // populate the subfile with data based in the customized                                                            000481
   617 // sql variable                                                                                                      000482
   618 // --------------------------------------------------------------------------                                        000483
   619 Dcl-Proc SubfileStart;                                                                                               000484
   620   Dcl-Pi SubfileStart;                                                                                               000485
   621   end-pi;                                                                                                            000486
   622                                                                                                                      000487
   623   // Variable for store the sql query required                                                                       000488
   624   Dcl-S sqlcustomized char(500);                                                                                     000489
   625                                                                                                                      000490
   626   sqlcustomized = 'SELECT TASK_ID , NAME , STARTDATE , ENDDATE , STATE '+                                            000491
   627                   'FROM (SELECT A.*, RowNumber() Over() as RNum FROM '+                                              000492
   628                   'CRUD01TBL AS A Where 1=1) as Tbl Where RNum '+                                                    000493
   629                   'BetWeen '+%char(Initialpos)+' and '+%char(Finalpos) +                                             000494
   630                   ' '+%trim(w_Wheresfl);                                                                             000495
   631                                                                                                                      000496
   632   FillSfl(sqlcustomized);                                                                                            000497
   633                                                                                                                      000498
   634 end-proc;                                                                                                            000499
   635                                                                                                                      000500
   636                                                                                                                      000501
   637                                                                                                                      000502
   638                                                                                                                      000503
   639                                                                                                                      000504
   640 // --------------------------------------------------------------------------                                        000505
   641 // Initialize and prepare the subfile                                                                                000506
   642 // --------------------------------------------------------------------------                                        000507
   643 Dcl-Proc Sflinitial;                                                                                                 000508
   644   SflEnd = *off;                                                                                                     000509
   645   SflClr = *on;                                                                                                      000510
   646   write SFLTASKCTL;                                                                                                  000511
   647   SflClr = *off;                                                                                                     000512
   648   taskrrn = *zeros;                                                                                                  000513
   649   SflDsp = *off;                                                                                                     000514
   650   SflDspCtl = *off;                                                                                                  000515
   651 end-proc;                                                                                                            000516
   652                                                                                                                      000517
   653                                                                                                                      000518
   654                                                                                                                      000519
   655                                                                                                                      000520
   656                                                                                                                      000521
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     14
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   657                                                                                                                      000522
   658                                                                                                                      000523
   659 // --------------------------------------------------------------------------                                        000524
   660 // Activate the subfile for being displayed on screen                                                                000525
   661 // --------------------------------------------------------------------------                                        000526
   662 Dcl-Proc ActivateSubfile;                                                                                            000527
   663   Sflinitial();                                                                                                      000528
   664   SubfileStart();                                                                                                    000529
   665                                                                                                                      000530
   666   SflEnd = Gettotalrecords() < 10;                                                                                   000531
   667                                                                                                                      000532
   668   If (taskrrn > 0);                                                                                                  000533
   669     SflDsp = *On;                                                                                                    000534
   670   Else;                                                                                                              000535
   671     write EMPTY;                                                                                                     000536
   672   EndIf;                                                                                                             000537
   673                                                                                                                      000538
   674   SflDspCtl = *On;                                                                                                   000539
   675 end-proc;                                                                                                            000540
   676                                                                                                                      000541
   677                                                                                                                      000542
   678                                                                                                                      000543
   679                                                                                                                      000544
   680                                                                                                                      000545
   681                                                                                                                      000546
   682                                                                                                                      000547
   683                                                                                                                      000548
   684 // --------------------------------------------------------------------------                                        000549
   685 // Fill the subfile with a Cursor                                                                                    000550
   686 // --------------------------------------------------------------------------                                        000551
   687 Dcl-Proc FillSfl;                                                                                                    000552
   688   Dcl-Pi FillSfl;                                                                                                    000553
   689     Par_sqlcustomized char(500);                                                                                     000554
   690   end-pi;                                                                                                            000555
   691                                                                                                                      000556
   692   Dcl-S Count zoned(2:0);                                                                                            000557
   693                                                                                                                      000558
   694   Dcl-S LastRRN zoned(10:0);                                                                                         000559
   695                                                                                                                      000560
   696   // Set previous values for indicates final of subfile is it is                                                     000561
   697   // necessary                                                                                                       000562
   698   clear Previnitialpos;                                                                                              000563
   699   clear PrevFinalpos;                                                                                                000564
   700                                                                                                                      000565
   701   Previnitialpos = Initialpos;                                                                                       000566
   702   PrevFinalpos = Finalpos;                                                                                           000567
   703                                                                                                                      000568
   704   clear Ds_taskdata;                                                                                                 000569
   705                                                                                                                      000570
   706   exec sql                                                                                                           000571
   707     PREPARE YOURQUERY FROM : Par_sqlcustomized;                                                                      000572
   708                                                                                                                      000573
   709   exec sql                                                                                                           000574
   710     DECLARE TASK_CURSOR INSENSITIVE SCROLL CURSOR FOR YOURQUERY;                                                     000575
   711                                                                                                                      000576
   712   exec sql                                                                                                           000577
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     15
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   713     OPEN TASK_CURSOR;                                                                                                000578
   714                                                                                                                      000579
   715   exec sql                                                                                                           000580
   716     FETCH NEXT FROM TASK_CURSOR INTO : Ds_taskdata;                                                                  000581
   717                                                                                                                      000582
   718   dow (xSQLState <> NODATA_ON_SQL) and (Count < PERPAGE);                                                            000583
   719     Count = Count+1;                                                                                                 000584
   720     LastRRN = LastRRN+1;                                                                                             000585
   721                                                                                                                      000586
   722     If (xSQLState = SUCCESS_ON_SQL);                                                                                 000587
   723       DatatoSfl();                                                                                                   000588
   724     EndIf;                                                                                                           000589
   725                                                                                                                      000590
   726     exec sql                                                                                                         000591
   727       FETCH NEXT FROM TASK_CURSOR INTO : Ds_taskdata;                                                                000592
   728     If (xSQLState <> SUCCESS_ON_SQL);                                                                                000593
   729       If (taskrrn = 10);                                                                                             000594
   730         Initialpos += Count+1;                                                                                       000595
   731         Finalpos += LastRRN;                                                                                         000596
   732       EndIf;                                                                                                         000597
   733     EndIf;                                                                                                           000598
   734   enddo;                                                                                                             000599
   735                                                                                                                      000600
   736   exec sql                                                                                                           000601
   737     CLOSE TASK_CURSOR;                                                                                               000602
   738 end-proc;                                                                                                            000603
   739                                                                                                                      000604
   740                                                                                                                      000605
   741                                                                                                                      000606
   742                                                                                                                      000607
   743                                                                                                                      000608
   744                                                                                                                      000609
   745                                                                                                                      000610
   746 // --------------------------------------------------------------------------                                        000611
   747 // This procedure assign the data fetched from cursor to subfile                                                     000612
   748 // --------------------------------------------------------------------------                                        000613
   749 Dcl-Proc DatatoSfl;                                                                                                  000614
   750   taskrrn +=1;                                                                                                       000615
   751   SFLTASKID = Ds_taskdata.Taskid;                                                                                    000616
   752   SFLTASKNAM = Ds_taskdata.Nametask;                                                                                 000617
   753   SFLSTRDATE = Ds_taskdata.Start_date;                                                                               000618
   754   SFLENDDATE = Ds_taskdata.End_date;                                                                                 000619
   755   SFLSTATE = Ds_taskdata.Taskstate;                                                                                  000620
   756   write SFLTASK;                                                                                                     000621
   757   clear SFLTASK;                                                                                                     000622
   758 end-proc;                                                                                                            000623
   759                                                                                                                      000624
   760                                                                                                                      000625
   761                                                                                                                      000626
   762                                                                                                                      000627
   763                                                                                                                      000628
   764                                                                                                                      000629
   765                                                                                                                      000630
   766                                                                                                                      000631
   767 // --------------------------------------------------------------------------                                        000632
   768 // get total records                                                                                                 000633
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     16
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   769 // --------------------------------------------------------------------------                                        000634
   770 Dcl-Proc Gettotalrecords;                                                                                            000635
   771   Dcl-Pi Gettotalrecords zoned(10);                                                                                  000636
   772   end-pi;                                                                                                            000637
   773                                                                                                                      000638
   774   Dcl-S w_Total zoned(10:0);                                                                                         000639
   775                                                                                                                      000640
   776   Dcl-S sqlcustomized char(500);                                                                                     000641
   777                                                                                                                      000642
   778   sqlcustomized = 'SELECT COUNT(*) '+                                                                                000643
   779          'FROM (SELECT A.*, RowNumber() Over() as RNum FROM '+                                                       000644
   780          'CRUD01TBL AS A Where 1=1) as Tbl Where RNum '+                                                             000645
   781          'BetWeen '+%char(Previnitialpos)+' and '+%char(PrevFinalpos) +                                              000646
   782          ' '+%trim(w_Wheresfl);                                                                                      000647
   783                                                                                                                      000648
   784   exec sql                                                                                                           000649
   785     PREPARE QRY FROM: sqlcustomized;                                                                                 000650
   786                                                                                                                      000651
   787   exec sql                                                                                                           000652
   788     DECLARE QRYC CURSOR FOR QRY;                                                                                     000653
   789                                                                                                                      000654
   790   exec sql                                                                                                           000655
   791     OPEN QRYC;                                                                                                       000656
   792                                                                                                                      000657
   793   exec sql                                                                                                           000658
   794     FETCH QRYC INTO:w_Total;                                                                                         000659
   795                                                                                                                      000660
   796   exec sql                                                                                                           000661
   797     CLOSE QRYC;                                                                                                      000662
   798                                                                                                                      000663
   799   Return w_Total;                                                                                                    000664
   800 end-proc;                                                                                                            000665
   801                                                                                                                      000666
   802                                                                                                                      000667
   803                                                                                                                      000668
   804                                                                                                                      000669
   805                                                                                                                      000670
   806                                                                                                                      000671
   807                                                                                                                      000672
   808                                                                                                                      000673
   809 // --------------------------------------------------------------------------                                        000674
   810 // run the CRUD                                                                                                      000675
   811 // --------------------------------------------------------------------------                                        000676
   812 Dcl-Proc ExecuteCrudScreen;                                                                                          000677
   813   Dcl-Pi ExecuteCrudScreen;                                                                                          000678
   814     p_choice char(1);                                                                                                000679
   815   end-pi;                                                                                                            000680
   816                                                                                                                      000681
   817   If (p_choice = 'I'); // Insert Screen                                                                              000682
   818     InsertScreen(p_choice);                                                                                          000683
   819   EndIf;                                                                                                             000684
   820                                                                                                                      000685
   821   If (p_choice = 'M'); // Modify Screen                                                                              000686
   822     ModifyScreen(p_choice);                                                                                          000687
   823   EndIf;                                                                                                             000688
   824                                                                                                                      000689
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     17
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   825   If (p_choice = 'D'); // Delete Screen                                                                              000690
   826     DeleteScreen(p_choice);                                                                                          000691
   827   EndIf;                                                                                                             000692
   828                                                                                                                      000693
   829   If (p_choice = 'V'); // View Screen                                                                                000694
   830     ViewScreen(p_choice);                                                                                            000695
   831   EndIf;                                                                                                             000696
   832 end-proc;                                                                                                            000697
   833                                                                                                                      000698
   834                                                                                                                      000699
   835                                                                                                                      000700
   836                                                                                                                      000701
   837                                                                                                                      000702
   838                                                                                                                      000703
   839                                                                                                                      000704
   840 // --------------------------------------------------------------------------                                        000705
   841 // write the screen                                                                                                  000706
   842 // --------------------------------------------------------------------------                                        000707
   843 Dcl-Proc InsertScreen;                                                                                               000708
   844   Dcl-Pi InsertScreen;                                                                                               000709
   845     p_choice char(1);                                                                                                000710
   846   end-pi;                                                                                                            000711
   847                                                                                                                      000712
   848   Dcl-S choice char(1);                                                                                              000713
   849                                                                                                                      000714
   850   WriteScreen(p_choice);                                                                                             000715
   851                                                                                                                      000716
   852   dow (not PFKEY03);                                                                                                 000717
   853     ProtectFields_35 = *Off;                                                                                         000718
   854     ProtectFields_36 = *Off;                                                                                         000719
   855     exfmt CRUDTASK;                                                                                                  000720
   856     Select;                                                                                                          000721
   857       When (PFKEY03);                                                                                                000722
   858         clear CRUDTASK;                                                                                              000723
   859         reset Initialpos;                                                                                            000724
   860         reset Finalpos;                                                                                              000725
   861         PFKEY03 = *Off;                                                                                              000726
   862         choice = 'S';                                                                                                000727
   863         ShowScreen(choice);                                                                                          000728
   864         leave;                                                                                                       000729
   865       When (pfkey(10));                                                                                              000730
   866         If (ScreenValidation(p_choice) = *Off);                                                                      000731
   867                                                                                                                      000732
   868           // Executes window confirmation                                                                            000733
   869           choice = 'C';                                                                                              000734
   870           ShowWdw(choice);                                                                                           000735
   871           If (WDWCHOICE = 'Y');                                                                                      000736
   872             LoaddatatoDs();                                                                                          000737
   873                                                                                                                      000738
   874             exec sql                                                                                                 000739
   875             INSERT INTO CRUD01TBL                                                                                    000740
   876               VALUES (:Ds_datacrud);                                                                                 000741
   877                                                                                                                      000742
   878             If (xSQLState = SUCCESS_ON_SQL);                                                                         000743
   879               choice = 'M'; // Message of successful                                                                 000744
   880               ShowWdw(choice);                                                                                       000745
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     18
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   881               clear CRUDTASK;                                                                                        000746
   882               reset Initialpos;                                                                                      000747
   883               reset Finalpos;                                                                                        000748
   884               choice = 'S';                                                                                          000749
   885               ShowScreen(choice);                                                                                    000750
   886               leave;                                                                                                 000751
   887             Else;                                                                                                    000752
   888               choice = 'E'; // Error Message                                                                         000753
   889               ShowWdw(choice);                                                                                       000754
   890             EndIf;                                                                                                   000755
   891           Else ;                                                                                                     000756
   892             clear CRUDTASK;                                                                                          000757
   893           EndIf;                                                                                                     000758
   894         EndIf;                                                                                                       000759
   895                                                                                                                      000760
   896       Other;                                                                                                         000761
   897         If (ScreenValidation(p_choice) = *On);                                                                       000762
   898           iter;                                                                                                      000763
   899         EndIf ;                                                                                                      000764
   900     EndSl;                                                                                                           000765
   901   enddo;                                                                                                             000766
   902 end-proc;                                                                                                            000767
   903                                                                                                                      000768
   904                                                                                                                      000769
   905                                                                                                                      000770
   906 // --------------------------------------------------------------------------                                        000771
   907 // modify screen                                                                                                     000772
   908 // --------------------------------------------------------------------------                                        000773
   909 Dcl-Proc ModifyScreen;                                                                                               000774
   910   Dcl-Pi ModifyScreen;                                                                                               000775
   911     p_choice char(1);                                                                                                000776
   912   end-pi;                                                                                                            000777
   913                                                                                                                      000778
   914   Dcl-S choice char(1);                                                                                              000779
   915                                                                                                                      000780
   916   LoaddatatoScreen();                                                                                                000781
   917   WriteScreen(p_choice);                                                                                             000782
   918                                                                                                                      000783
   919   dow (not PFKEY03);                                                                                                 000784
   920     ProtectFields_35 = *On;                                                                                          000785
   921     exfmt CRUDTASK;                                                                                                  000786
   922     Select;                                                                                                          000787
   923       When (PFKEY03);                                                                                                000788
   924         ProtectFields_35 = *Off;                                                                                     000789
   925         clear CRUDTASK;                                                                                              000790
   926         clear OPCTASK;                                                                                               000791
   927         PFKEY03 = *Off;                                                                                              000792
   928         w_Crudfinalize = *On ;                                                                                       000793
   929         reset Initialpos;                                                                                            000794
   930         reset Finalpos;                                                                                              000795
   931         choice = 'S';                                                                                                000796
   932         ShowScreen(choice);                                                                                          000797
   933         leave;                                                                                                       000798
   934       When (pfkey(10));                                                                                              000799
   935         If (ScreenValidation(p_choice) = *Off);                                                                      000800
   936                                                                                                                      000801
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     19
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   937           // Executes window confirmation                                                                            000802
   938           choice = 'C';                                                                                              000803
   939           ShowWdw(choice);                                                                                           000804
   940           If (WDWCHOICE = 'Y');                                                                                      000805
   941                                                                                                                      000806
   942             exec sql                                                                                                 000807
   943             UPDATE CRUD01TBL                                                                                         000808
   944               SET NAME = :NAMETASK,                                                                                  000809
   945                   DESCR = :DESCRP,                                                                                   000810
   946                   ENDDES = :SOLUTION,                                                                                000811
   947                   STARTDATE = :STARTDATE,                                                                            000812
   948                   ENDDATE = :ENDDATE,                                                                                000813
   949                   STATE = :STATETASK,                                                                                000814
   950                   OWNER = :CurrentUser                                                                               000815
   951               WHERE TASK_ID = : CRUDTASKID;                                                                          000816
   952                                                                                                                      000817
   953             If (xSQLState = SUCCESS_ON_SQL);                                                                         000818
   954               choice = 'M'; // Message of successful                                                                 000819
   955               ShowWdw(choice);                                                                                       000820
   956               clear CRUDTASK;                                                                                        000821
   957               clear OPCTASK;                                                                                         000822
   958               reset Initialpos;                                                                                      000823
   959               reset Finalpos;                                                                                        000824
   960               choice = 'S';                                                                                          000825
   961               ShowScreen(choice);                                                                                    000826
   962               w_Crudfinalize = *On ;                                                                                 000827
   963               leave;                                                                                                 000828
   964             Else;                                                                                                    000829
   965               choice = 'E'; // Error Message                                                                         000830
   966               ShowWdw(choice);                                                                                       000831
   967             EndIf;                                                                                                   000832
   968           Else ;                                                                                                     000833
   969             clear CRUDTASK;                                                                                          000834
   970           EndIf;                                                                                                     000835
   971         EndIf;                                                                                                       000836
   972                                                                                                                      000837
   973       Other;                                                                                                         000838
   974         If (ScreenValidation(p_choice) = *On);                                                                       000839
   975           iter;                                                                                                      000840
   976         EndIf ;                                                                                                      000841
   977     EndSl;                                                                                                           000842
   978   enddo;                                                                                                             000843
   979 end-proc;                                                                                                            000844
   980                                                                                                                      000845
   981                                                                                                                      000846
   982                                                                                                                      000847
   983                                                                                                                      000848
   984                                                                                                                      000849
   985                                                                                                                      000850
   986                                                                                                                      000851
   987                                                                                                                      000852
   988 // --------------------------------------------------------------------------                                        000853
   989 // delete screen                                                                                                     000854
   990 // --------------------------------------------------------------------------                                        000855
   991 Dcl-Proc DeleteScreen;                                                                                               000856
   992   Dcl-Pi DeleteScreen;                                                                                               000857
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     20
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   993     p_choice char(1);                                                                                                000858
   994   end-pi;                                                                                                            000859
   995                                                                                                                      000860
   996   Dcl-S choice char(1);                                                                                              000861
   997                                                                                                                      000862
   998   LoaddatatoScreen();                                                                                                000863
   999   WriteScreen(p_choice);                                                                                             000864
  1000                                                                                                                      000865
  1001   dow (not PFKEY03);                                                                                                 000866
  1002     ProtectFields_35 = *On;                                                                                          000867
  1003     ProtectFields_36 = *On;                                                                                          000868
  1004     exfmt CRUDTASK;                                                                                                  000869
  1005     Select;                                                                                                          000870
  1006       When (PFKEY03);                                                                                                000871
  1007         ProtectFields_35 = *Off;                                                                                     000872
  1008         ProtectFields_36 = *Off;                                                                                     000873
  1009         clear CRUDTASK;                                                                                              000874
  1010         clear OPCTASK;                                                                                               000875
  1011         PFKEY03 = *Off;                                                                                              000876
  1012         w_Crudfinalize = *On ;                                                                                       000877
  1013         reset Initialpos;                                                                                            000878
  1014         reset Finalpos;                                                                                              000879
  1015         choice = 'S';                                                                                                000880
  1016         ShowScreen(choice);                                                                                          000881
  1017         leave;                                                                                                       000882
  1018       When (pfkey(10));                                                                                              000883
  1019         If (ScreenValidation(p_choice) = *Off);                                                                      000884
  1020                                                                                                                      000885
  1021           // Executes window confirmation                                                                            000886
  1022           choice = 'C';                                                                                              000887
  1023           ShowWdw(choice);                                                                                           000888
  1024           If (WDWCHOICE = 'Y');                                                                                      000889
  1025                                                                                                                      000890
  1026             exec sql                                                                                                 000891
  1027             DELETE FROM CRUD01TBL WHERE TASK_ID = : CRUDTASKID;                                                      000892
  1028                                                                                                                      000893
  1029             If (xSQLState = SUCCESS_ON_SQL);                                                                         000894
  1030               ShowWdw(p_choice);                                                                                     000895
  1031               clear CRUDTASK;                                                                                        000896
  1032               clear OPCTASK;                                                                                         000897
  1033               reset Initialpos;                                                                                      000898
  1034               reset Finalpos;                                                                                        000899
  1035               choice = 'S';                                                                                          000900
  1036               ShowScreen(choice);                                                                                    000901
  1037               w_Crudfinalize = *On ;                                                                                 000902
  1038               leave;                                                                                                 000903
  1039             Else;                                                                                                    000904
  1040               choice = 'E'; // Error Message                                                                         000905
  1041               ShowWdw(choice);                                                                                       000906
  1042             EndIf;                                                                                                   000907
  1043           Else ;                                                                                                     000908
  1044             clear CRUDTASK;                                                                                          000909
  1045           EndIf;                                                                                                     000910
  1046         EndIf;                                                                                                       000911
  1047                                                                                                                      000912
  1048       Other;                                                                                                         000913
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     21
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1049         If (ScreenValidation(p_choice) = *On);                                                                       000914
  1050           iter;                                                                                                      000915
  1051         EndIf ;                                                                                                      000916
  1052     EndSl;                                                                                                           000917
  1053   enddo;                                                                                                             000918
  1054 end-proc;                                                                                                            000919
  1055                                                                                                                      000920
  1056                                                                                                                      000921
  1057                                                                                                                      000922
  1058                                                                                                                      000923
  1059                                                                                                                      000924
  1060                                                                                                                      000925
  1061                                                                                                                      000926
  1062 // --------------------------------------------------------------------------                                        000927
  1063 // view the screen                                                                                                   000928
  1064 // --------------------------------------------------------------------------                                        000929
  1065 Dcl-Proc ViewScreen;                                                                                                 000930
  1066   Dcl-Pi ViewScreen;                                                                                                 000931
  1067     p_choice char(1);                                                                                                000932
  1068   end-pi;                                                                                                            000933
  1069                                                                                                                      000934
  1070   Dcl-S choice char(1);                                                                                              000935
  1071                                                                                                                      000936
  1072   LoaddatatoScreen();                                                                                                000937
  1073   WriteScreen(p_choice);                                                                                             000938
  1074                                                                                                                      000939
  1075   dow (not PFKEY03);                                                                                                 000940
  1076     ProtectFields_35 = *On;                                                                                          000941
  1077     ProtectFields_36 = *On;                                                                                          000942
  1078     exfmt CRUDTASK;                                                                                                  000943
  1079     If (PFKEY03);                                                                                                    000944
  1080       ProtectFields_35 = *Off;                                                                                       000945
  1081       ProtectFields_36 = *Off;                                                                                       000946
  1082       clear CRUDTASK;                                                                                                000947
  1083       clear OPCTASK;                                                                                                 000948
  1084       PFKEY03 = *Off;                                                                                                000949
  1085       w_Crudfinalize = *On ;                                                                                         000950
  1086       reset Initialpos;                                                                                              000951
  1087       reset Finalpos;                                                                                                000952
  1088       choice = 'S';                                                                                                  000953
  1089       ShowScreen(choice);                                                                                            000954
  1090       leave;                                                                                                         000955
  1091     EndIf;                                                                                                           000956
  1092   enddo;                                                                                                             000957
  1093 end-proc;                                                                                                            000958
  1094                                                                                                                      000959
  1095                                                                                                                      000960
  1096                                                                                                                      000961
  1097                                                                                                                      000962
  1098                                                                                                                      000963
  1099                                                                                                                      000964
  1100                                                                                                                      000965
  1101                                                                                                                      000966
  1102 // --------------------------------------------------------------------------                                        000967
  1103 // load screen data                                                                                                  000968
  1104 // --------------------------------------------------------------------------                                        000969
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     22
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1105 Dcl-Proc LoaddatatoScreen;                                                                                           000970
  1106   clear CRUDTASK;                                                                                                    000971
  1107   CRUDTASKID = Ds_datacrud.Task_id;                                                                                  000972
  1108   NAMETASK = Ds_datacrud.Name;                                                                                       000973
  1109   DESCRP = Ds_datacrud.Descr;                                                                                        000974
  1110   SOLUTION = Ds_datacrud.Enddes;                                                                                     000975
  1111   STARTDATE = Ds_datacrud.Startdate;                                                                                 000976
  1112   ENDDATE = Ds_datacrud.Enddate;                                                                                     000977
  1113   STATETASK = Ds_datacrud.State;                                                                                     000978
  1114 end-proc ;                                                                                                           000979
  1115                                                                                                                      000980
  1116                                                                                                                      000981
  1117                                                                                                                      000982
  1118                                                                                                                      000983
  1119                                                                                                                      000984
  1120                                                                                                                      000985
  1121                                                                                                                      000986
  1122                                                                                                                      000987
  1123                                                                                                                      000988
  1124 // --------------------------------------------------------------------------                                        000989
  1125 // load data to data structure                                                                                       000990
  1126 // --------------------------------------------------------------------------                                        000991
  1127 Dcl-Proc LoaddatatoDs;                                                                                               000992
  1128   clear Ds_datacrud;                                                                                                 000993
  1129   Ds_datacrud.Task_id = CRUDTASKID;                                                                                  000994
  1130   Ds_datacrud.Name = %trim(NAMETASK);                                                                                000995
  1131   Ds_datacrud.Descr = %trim(DESCRP);                                                                                 000996
  1132   Ds_datacrud.Enddes = %trim(SOLUTION);                                                                              000997
  1133   Ds_datacrud.Startdate = STARTDATE;                                                                                 000998
  1134   Ds_datacrud.Enddate = ENDDATE;                                                                                     000999
  1135   Ds_datacrud.State = STATETASK;                                                                                     001000
  1136   Ds_datacrud.Owner = CurrentUser;                                                                                   001001
  1137 end-proc;                                                                                                            001002
       * * * * *   E N D   O F   S O U R C E   * * * * *
                            / C o p y   M e m b e r s
Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
Number Id              Library    File       Member            Date     Time
    10    1 informati+ includes/information_data_struc+  1208  25-05-09 06:41:09
         * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     23
Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
                       C o m p i l e   T i m e   D a t a
    * * * * *   E N D   O F   C O M P I L E   T I M E   D A T A   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     24
                          M e s s a g e   S u m m a r y
 Msg id  Sv Number Message text
       * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:10        Page     25
                            F i n a l   S u m m a r y
  Message Totals:
    Information  (00) . . . . . . . :        0
    Warning      (10) . . . . . . . :        0
    Error        (20) . . . . . . . :        0
    Severe Error (30+)  . . . . . . :        0
    ---------------------------------  -------
    Total . . . . . . . . . . . . . :        0
  Source Totals:
    Records . . . . . . . . . . . . :     1137
    Specifications  . . . . . . . . :      685
    Data records  . . . . . . . . . :        0
    Comments  . . . . . . . . . . . :      407
         * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
Diagnostic check of source is complete. Highest severity is 00.
          * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     1
Source type...............RPG
Object name...............NLITTEN1/CRUD01RPG
Source file...............QTEMP/QSQLPRE
Member....................*OBJ
To source file............QTEMP/QSQLTEMP1
Options...................*LSTDBG
RPG preprocessor options..*LVL2
Listing option............*PRINT
Target release............V7R4M0
INCLUDE file..............*LIBL/QRPGLESRC
Commit....................*NONE
Allow copy of data........*OPTIMIZE
Close SQL cursor..........*ENDACTGRP
Allow blocking............*ALLREAD
Delay PREPARE.............*NO
Concurrent access
  resolution..............*DFT
Generation level..........10
Printer file..............*LIBL/QSYSPRT
Date format...............*JOB
Date separator............*JOB
Time format...............*HMS
Time separator ...........*JOB
Replace...................*YES
Relational database.......*LOCAL
User .....................*CURRENT
RDB connect method........*DUW
Default collection........*NONE
Dynamic default
  collection..............*NO
Package name..............*OBJLIB/*OBJ
Path......................*NAMING
SQL rules.................*DB2
Created object type.......*MODULE
Debugging view............*SOURCE
Debugging encryption key..*NONE
User profile .............*NAMING
Dynamic user profile......*USER
Sort sequence.............*JOB
Language ID...............*JOB
IBM SQL flagging..........*NOFLAG
ANS flagging..............*NONE
Text......................Change Read Update Delete Example
Source file CCSID.........37
Job CCSID.................37
Decimal result options:
  Maximum precision.......31
  Maximum scale...........31
  Minimum divide scale....0
DECFLOAT rounding mode....*HALFEVEN
Compiler options..........TGTCCSID(*JOB) OPTIMIZE() INCDIR('includes')
Source member changed on 25-05-09  08:21:10
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     2
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
    1   **free                                                                                                 000001   25-05-09
    2                                                                                                          000002   25-05-09
    3   // --------------------------------------------------------------------------                          000003   25-05-09
    4   // *** WORK IN PROGRESS _ NOT FINISHED YET ***                                                         000004   25-05-09
    5   // --------------------------------------------------------------------------                          000005   25-05-09
    6   ctl-opt main(mainline) copyright('| CRUD01RPG 2025.04.11');                                            000006   25-05-09
    7                                                                                                          000007   25-05-09
    8   dcl-f CRUD01PNL workstn sfile(SFLTASK:taskrrn) usropn infds(infds);                                    000008   25-05-09
    9                                                                                                          000009   25-05-09
   10   // /include 'information_data_structures.rpgleinc'                                                     000010   25-05-09
   11   **END-FREE                                                                                             000000
   12   **FREE                                                                                                 000001   25-05-09
   13                                                                                                          000002   25-05-09
   14   Dcl-Ds infds qualified;                                                                                000003   25-05-09
   15     FileOpen ind pos(9); // File Open Indicator?                                                         000004   25-05-09
   16     FileEOF ind pos(10); // File at End of File?                                                         000005   25-05-09
   17     ListingLine char(8) pos(30);                                                                         000006   25-05-09
   18     // --SpecialStatus zoned(5) pos(38);                                                                 000007   25-05-09
   19     File char(10) pos(83);                                                                               000008   25-05-09
   20     fileType int(5) pos(147);                                                                            000009   25-05-09
   21     Lib char(10) pos(93);                                                                                000010   25-05-09
   22     RcdLen int(5) pos(125);                                                                              000011   25-05-09
   23     keyLen int(5) pos(127); // Max key len                                                               000012   25-05-09
   24     Mbr char(10) pos(129);                                                                               000013   25-05-09
   25     RcdsReadSinceOpen int(10) pos(156); // number of records retrieved since open                        000014   25-05-09
   26     Ccsid int(5) pos(218);                                                                               000015   25-05-09
   27     RRNlastRead int(10) pos(247); // relative record number of last record processed                     000016   25-05-09
   28     Rcdfmt char(10) pos(261);                                                                            000017   25-05-09
   29     SflRcdNbr int(5) pos(378);                                                                           000018   25-05-09
   30     RRN int(10) pos(397);                                                                                000019   25-05-09
   31     // DSPF BITs                                                                                         000020   25-05-09
   32     funcKey char(1) pos(369); // DS@AID for nice "funckey = PageDown" type syntax                        000021   25-05-09
   33     RowColumn int(5) pos(370); // DS@POS - cursor row & column                                           000022   25-05-09
   34     firstRrnOnScreen int(5) pos(378); // DS@TOP SFL RRN Top of scrn                                      000023   25-05-09
   35     totalSflRows int(5) pos(380); // DS@TOT records in subfile                                           000024   25-05-09
   36     // PRTF BITs                                                                                         000025   25-05-09
   37     printPageSize int(5) pos(152); // PR@SIZ page size                                                   000026   25-05-09
   38     printOverflow int(5) pos(188); // PR@FLW printer file overflow                                       000027   25-05-09
   39     printCurrentLine int(5) pos(367); // PR@CLN current line number                                      000028   25-05-09
   40     // *PRTF Stuff:                                                                                      000029   25-05-09
   41     PageSize int(5) pos(152); // PR@SIZ page size                                                        000030   25-05-09
   42     Overflow int(5) pos(188); // PR@FLW printer file overflow                                            000031   25-05-09
   43     CurrentLine int(5) pos(367); // PR@CLN current line number                                           000032   25-05-09
   44     CurrentPage int(10) pos(369);                                                                        000033   25-05-09
   45     // Error MSGID -- available after POST                                                               000034   25-05-09
   46     MsgID char(7) pos(46);                                                                               000035   25-05-09
   47     ODPtype char(2) pos(81); // ODP Type                                                                 000036   25-05-09
   48     splf char(10) pos(103);                                                                              000037   25-05-09
   49     splfLib char(10) pos(113);                                                                           000038   25-05-09
   50     splfNumber int(5) pos(123);                                                                          000039   25-05-09
   51     // *DSPF Stuff:                                                                                      000040   25-05-09
   52     SflRRN int(5) pos(376);                                                                              000041   25-05-09
   53     SflMinRRN int(5) pos(378);                                                                           000042   25-05-09
   54     SflNumRcds int(5) pos(380);                                                                          000043   25-05-09
   55     ActualCursor char(2) pos(382);                                                                       000044   25-05-09
   56     NumberOfRows int(5) pos(282);                                                                        000045   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     3
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
   57     NumberOfCols int(5) pos(284);                                                                        000046   25-05-09
   58     nbrOfRows int(5) pos(152);                                                                           000047   25-05-09
   59     nbrOfCol int(5) pos(154);                                                                            000048   25-05-09
   60     nbrRcds int(10) pos(156);                                                                            000049   25-05-09
   61     accessType char(2) pos(160);                                                                         000050   25-05-09
   62     DupKey char(1) pos(162);                                                                             000051   25-05-09
   63     srcFile char(1) pos(163);                                                                            000052   25-05-09
   64     VolumeLavelOffset int(5) pos(184);                                                                   000053   25-05-09
   65     MaxRcdsInBlock int(5) pos(186);                                                                      000054   25-05-09
   66     BlockIncrement int(5) pos(190);                                                                      000055   25-05-09
   67     deviceClass char(1) pos(271);                                                                        000056   25-05-09
   68     deviceType char(6) pos(272);                                                                         000057   25-05-09
   69     Requester char(1) pos(278);                                                                          000058   25-05-09
   70     AcquireStatus char(1) pos(279);                                                                      000059   25-05-09
   71     InviteStatus char(1) pos(280);                                                                       000060   25-05-09
   72     DataAvailable char(1) pos(281);                                                                      000061   25-05-09
   73     AllowBlink char(1) pos(286);                                                                         000062   25-05-09
   74     OnlineOffline char(1) pos(287);                                                                      000063   25-05-09
   75     DisplayLocation char(1) pos(288);                                                                    000064   25-05-09
   76     DisplayType char(1) pos(289);                                                                        000065   25-05-09
   77     KeyboardType char(1) pos(290);                                                                       000066   25-05-09
   78     ControllerInfo char(1) pos(342);                                                                     000067   25-05-09
   79     ColorCapable char(1) pos(343);                                                                       000068   25-05-09
   80     MiscFlags1 char(1) pos(196);                                                                         000069   25-05-09
   81     OepCount int(5) pos(207);                                                                            000070   25-05-09
   82     NumBasedMbrs int(5) pos(211);                                                                        000071   25-05-09
   83     MiscFlags2 char(1) pos(213);                                                                         000072   25-05-09
   84     OpenID char(2) pos(214);                                                                             000073   25-05-09
   85     RcdFmtLen int(5) pos(216);                                                                           000074   25-05-09
   86     MiscFlags3 char(1) pos(220);                                                                         000075   25-05-09
   87     NUM_DEVS int(5) pos(227);                                                                            000076   25-05-09
   88     writeCount int(10) pos(243);                                                                         000077   25-05-09
   89     readCount int(10) pos(247);                                                                          000078   25-05-09
   90     writeReadCount int(10) pos(251);                                                                     000079   25-05-09
   91     otherIOCount int(10) pos(255);                                                                       000080   25-05-09
   92     currentOperations char(1) pos(260);                                                                  000081   25-05-09
   93     DevClass char(2) pos(271);                                                                           000082   25-05-09
   94     PgmDevName char(10) pos(273);                                                                        000083   25-05-09
   95     IOrcdLen int(10) pos(283);                                                                           000084   25-05-09
   96     PgmDevice char(10) pos(241);                                                                         000085   25-05-09
   97     DeviceDesc char(10) pos(251);                                                                        000086   25-05-09
   98     user char(10) pos(261);                                                                              000087   25-05-09
   99     // Disk :                                                                                            000088   25-05-09
  100     NbrLockedRcds int(5) pos(377);                                                                       000089   25-05-09
  101     FilePosBits char(1) pos(385);                                                                        000090   25-05-09
  102     RcdDeletedBits char(1) pos(384);                                                                     000091   25-05-09
  103     Numkeys int(5) pos(387);                                                                             000092   25-05-09
  104     Keylength int(5) pos(393);                                                                           000093   25-05-09
  105     MemberNumber int(5) pos(395);                                                                        000094   25-05-09
  106   end-ds;                                                                                                000095   25-05-09
  107                                                                                                          000096   25-05-09
  108   Dcl-Ds infds_DB likeds(infds);                                                                         000097   25-05-09
  109   Dcl-Ds infds_DSPF likeds(infds);                                                                       000098   25-05-09
  110   Dcl-Ds infds_PRTF likeds(infds);                                                                       000099   25-05-09
  111                                                                                                          000100   25-05-09
  112   // Hexadecimal representation of function Keys                                                         000101   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     4
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  113   // If you use an INFDS against your display file you can check functions by                            000102   25-05-09
  114   // using : IF infs.funcKey = PFKEY03;                                                                  000103   25-05-09
  115   Dcl-C ENTER CONST(X'F1');                                                                              000104   25-05-09
  116   Dcl-C HELP CONST(X'F3');                                                                               000105   25-05-09
  117   Dcl-C PAGEUP CONST(X'F4');                                                                             000106   25-05-09
  118   Dcl-C PAGEDOWN CONST(X'F5');                                                                           000107   25-05-09
  119   Dcl-C PRINT CONST(X'F6');                                                                              000108   25-05-09
  120   Dcl-C RECORDBACKSPAC CONST(X'F8');                                                                     000109   25-05-09
  121   Dcl-C PFKEY01 CONST(X'31');                                                                            000110   25-05-09
  122   Dcl-C PFKEY02 CONST(X'32');                                                                            000111   25-05-09
  123   Dcl-C PFKEY03 CONST(X'33');                                                                            000112   25-05-09
  124   Dcl-C PFKEY04 CONST(X'34');                                                                            000113   25-05-09
  125   Dcl-C PFKEY05 CONST(X'35');                                                                            000114   25-05-09
  126   Dcl-C PFKEY06 CONST(X'36');                                                                            000115   25-05-09
  127   Dcl-C PFKEY07 CONST(X'37');                                                                            000116   25-05-09
  128   Dcl-C PFKEY08 CONST(X'38');                                                                            000117   25-05-09
  129   Dcl-C PFKEY09 CONST(X'39');                                                                            000118   25-05-09
  130   Dcl-C PFKEY10 CONST(X'3A');                                                                            000119   25-05-09
  131   Dcl-C PFKEY11 CONST(X'3B');                                                                            000120   25-05-09
  132   Dcl-C PFKEY12 CONST(X'3C');                                                                            000121   25-05-09
  133   Dcl-C PFKEY13 CONST(X'B1');                                                                            000122   25-05-09
  134   Dcl-C PFKEY14 CONST(X'B2');                                                                            000123   25-05-09
  135   Dcl-C PFKEY15 CONST(X'B3');                                                                            000124   25-05-09
  136   Dcl-C PFKEY16 CONST(X'B4');                                                                            000125   25-05-09
  137   Dcl-C PFKEY17 CONST(X'B5');                                                                            000126   25-05-09
  138   Dcl-C PFKEY18 CONST(X'B6');                                                                            000127   25-05-09
  139   Dcl-C PFKEY19 CONST(X'B7');                                                                            000128   25-05-09
  140   Dcl-C PFKEY20 CONST(X'B8');                                                                            000129   25-05-09
  141   Dcl-C PFKEY21 CONST(X'B9');                                                                            000130   25-05-09
  142   Dcl-C PFKEY22 CONST(X'BA');                                                                            000131   25-05-09
  143   Dcl-C PFKEY23 CONST(X'BB');                                                                            000132   25-05-09
  144   Dcl-C PFKEY24 CONST(X'BC');                                                                            000133   25-05-09
  145   Dcl-C CLEAR CONST(X'BD');                                                                              000134   25-05-09
  146                                                                                                          000135   25-05-09
  147                                                                                                          000011   25-05-09
  148   // Validation indicators                                                                               000012   25-05-09
  149   Dcl-S ptrDisplayIndicators Pointer Inz(%Addr(*In));                                                    000013   25-05-09
  150   Dcl-Ds DisplayIndicators Based(ptrDisplayIndicators);                                                  000014   25-05-09
  151     // Subfile indicators                                                                                000015   25-05-09
  152     SflDsp          Ind Pos(99);                                                                         000016   25-05-09
  153     SflDspCtl       Ind Pos(98);                                                                         000017   25-05-09
  154     SflClr          Ind Pos(97);                                                                         000018   25-05-09
  155     SflEnd          Ind Pos(96);                                                                         000019   25-05-09
  156     // Validation Errors                                                                                 000020   25-05-09
  157     Taskidexisterror_31 Ind Pos(31);                                                                     000021   25-05-09
  158     Startdateerror_32  Ind Pos(32);                                                                      000022   25-05-09
  159     Enddateerror_33 Ind Pos(33);                                                                         000023   25-05-09
  160     Dategreaterthanerror_34 Ind Pos(34);                                                                 000024   25-05-09
  161     ProtectFields_35 Ind Pos(35);                                                                        000025   25-05-09
  162     ProtectFields_36 Ind Pos(36);                                                                        000026   25-05-09
  163     IndErrors char(20) Pos(31);                                                                          000027   25-05-09
  164   end-ds;                                                                                                000028   25-05-09
  165                                                                                                          000029   25-05-09
  166   // Variable Pointer for SQL Errors                                                                     000030   25-05-09
  167   Dcl-S pSqlstate Pointer Inz(%Addr(SQLState));                                                          000031   25-05-09
  168                                                                                                          000032   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     5
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  169   Dcl-Ds Ds_SqlState based(pSqlstate);                                                                   000033   25-05-09
  170     xSqlstate char(2);                                                                                   000034   25-05-09
  171   end-ds;                                                                                                000035   25-05-09
  172                                                                                                          000036   25-05-09
  173   // Constant error on SQL                                                                               000037   25-05-09
  174   Dcl-C SUCCESS_ON_SQL '00';                                                                             000038   25-05-09
  175   Dcl-C WARNING_ON_SQL '01';                                                                             000039   25-05-09
  176   Dcl-C NODATA_ON_SQL  '02';                                                                             000040   25-05-09
  177                                                                                                          000041   25-05-09
  178   // Data structure based in the query neccesary for fill the subfile of                                 000042   25-05-09
  179   // the file CRUD01TBL                                                                                  000043   25-05-09
  180   Dcl-Ds Ds_taskdata qualified;                                                                          000044   25-05-09
  181     Taskid     zoned(10);                                                                                000045   25-05-09
  182     Nametask    char(20);                                                                                000046   25-05-09
  183     Start_date zoned(8);                                                                                 000047   25-05-09
  184     End_date   zoned(8);                                                                                 000048   25-05-09
  185     Taskstate  zoned(1);                                                                                 000049   25-05-09
  186   end-ds;                                                                                                000050   25-05-09
  187                                                                                                          000051   25-05-09
  188   // Data structure for general use in CRUD operations                                                   000052   25-05-09
  189   Dcl-Ds Ds_datacrud extname('CRUD01TBL') qualified end-ds;                                              000053   25-05-09
  190                                                                                                          000054   25-05-09
  191   // Relative record number for SFLTASK subfile task                                                     000055   25-05-09
  192   Dcl-S taskrrn zoned(3:0);                                                                              000056   25-05-09
  193                                                                                                          000057   25-05-09
  194   // Variables for subfile scroll position                                                               000058   25-05-09
  195   Dcl-S Initialpos zoned(10:0) inz(0);                                                                   000059   25-05-09
  196   Dcl-S Finalpos zoned(10:0) inz(10);                                                                    000060   25-05-09
  197                                                                                                          000061   25-05-09
  198   // Previous initial and finalpos for indicates final                                                   000062   25-05-09
  199   Dcl-S Previnitialpos zoned(10:0);                                                                      000063   25-05-09
  200   Dcl-S PrevFinalpos zoned(10:0) ;                                                                       000064   25-05-09
  201                                                                                                          000065   25-05-09
  202   // Variable for apply filter to subfile query                                                          000066   25-05-09
  203   Dcl-S w_Wheresfl char(500) inz(*blanks);                                                               000067   25-05-09
  204                                                                                                          000068   25-05-09
  205   // Quantity of records per page in subfile change the inz value depend                                 000069   25-05-09
  206   // of your subfile capacity                                                                            000070   25-05-09
  207   Dcl-C PERPAGE 10;                                                                                      000071   25-05-09
  208                                                                                                          000072   25-05-09
  209   // Variable for indicates that crud operations are finalized                                           000073   25-05-09
  210   Dcl-S w_Crudfinalize Ind;                                                                              000074   25-05-09
  211                                                                                                          000075   25-05-09
  212   // Variable with current user                                                                          000076   25-05-09
  213   Dcl-S CurrentUser char(10) inz(*user);                                                                 000077   25-05-09
  214                                                                                                          000078   25-05-09
  215                                                                                                          000079   25-05-09
  216                                                                                                          000080   25-05-09
  217                                                                                                          000081   25-05-09
  218                                                                                                          000082   25-05-09
  219                                                                                                          000083   25-05-09
  220   // --------------------------------------------------------------------------                          000084   25-05-09
  221   // This is the mainline process that is executed when the program is called                            000085   25-05-09
  222   // --------------------------------------------------------------------------                          000086   25-05-09
  223   Dcl-Proc mainline;                                                                                     000087   25-05-09
  224                                                                                                          000088   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     6
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  225     Dcl-S choice char(1) inz(*blanks);                                                                   000089   25-05-09
  226                                                                                                          000090   25-05-09
  227     open CRUD01PNL;                                                                                      000091   25-05-09
  228                                                                                                          000092   25-05-09
  229     // The value 'S' is for Subfile Menu                                                                 000093   25-05-09
  230     choice = 'S';                                                                                        000094   25-05-09
  231                                                                                                          000095   25-05-09
  232     ShowScreen(choice);                                                                                  000096   25-05-09
  233                                                                                                          000097   25-05-09
  234     // Termination of program                                                                            000098   25-05-09
  235     close CRUD01PNL;                                                                                     000099   25-05-09
  236     *Inlr = *On;                                                                                         000100   25-05-09
  237   end-proc;                                                                                              000101   25-05-09
  238                                                                                                          000102   25-05-09
  239                                                                                                          000103   25-05-09
  240                                                                                                          000104   25-05-09
  241                                                                                                          000105   25-05-09
  242                                                                                                          000106   25-05-09
  243                                                                                                          000107   25-05-09
  244   // --------------------------------------------------------------------------                          000108   25-05-09
  245   // This procedure receives a parameter for the titles that are written                                 000109   25-05-09
  246   // --------------------------------------------------------------------------                          000110   25-05-09
  247   Dcl-Proc WriteScreen;                                                                                  000111   25-05-09
  248     Dcl-Pi WriteScreen;                                                                                  000112   25-05-09
  249       p_choice char(1);                                                                                  000113   25-05-09
  250     end-pi;                                                                                              000114   25-05-09
  251                                                                                                          000115   25-05-09
  252     // Secondary titles                                                                                  000116   25-05-09
  253     TITLE2 = Center('Created by Some Bloke':%len(TITLE2));                                               000117   25-05-09
  254     TITLE3 = Center('Back in 2018':%len(TITLE3));                                                        000118   25-05-09
  255                                                                                                          000119   25-05-09
  256     // Principal title                                                                                   000120   25-05-09
  257     Select;                                                                                              000121   25-05-09
  258                                                                                                          000122   25-05-09
  259         // CRUD Options                                                                                  000123   25-05-09
  260       When (p_choice = 'I');                                                                             000124   25-05-09
  261         TITLE1 = Center('TASKS ADMINISTRATOR INSERT':%len(TITLE1));                                      000125   25-05-09
  262       When (p_choice = 'M');                                                                             000126   25-05-09
  263         TITLE1 = Center('TASKS ADMINISTRATOR MODIFY':%len(TITLE1));                                      000127   25-05-09
  264       When (p_choice = 'D');                                                                             000128   25-05-09
  265         TITLE1 = Center('TASKS ADMINISTRATOR DELETE':%len(TITLE1));                                      000129   25-05-09
  266       When (p_choice = 'V');                                                                             000130   25-05-09
  267         TITLE1 = Center('TASKS ADMINISTRATOR VIEW':%len(TITLE1));                                        000131   25-05-09
  268                                                                                                          000132   25-05-09
  269         // Subfile                                                                                       000133   25-05-09
  270       When (p_choice = 'S');                                                                             000134   25-05-09
  271         TITLE1 = Center('TASKS ADMINISTRATOR MAIN MENU':%len(TITLE1));                                   000135   25-05-09
  272     EndSl;                                                                                               000136   25-05-09
  273                                                                                                          000137   25-05-09
  274     // Use an IF/ELSEIF as a different way of doing SELECT groups                                        000138   25-05-09
  275     // here is an example:                                                                               000139   25-05-09
  276     If (p_choice = 'S');                                                                                 000140   25-05-09
  277       FOOTTEXT = 'F3=Exit  F5=Refresh  F6=Create';                                                       000141   25-05-09
  278     elseif (p_choice = 'I' or p_choice= 'M' or p_choice= 'D');                                           000142   25-05-09
  279       FOOTTEXT = 'F3=Exit      F10=Confirm';                                                             000143   25-05-09
  280     elseif (p_choice = 'V');                                                                             000144   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     7
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  281       FOOTTEXT = 'F3=Exit  ';                                                                            000145   25-05-09
  282     EndIf;                                                                                               000146   25-05-09
  283                                                                                                          000147   25-05-09
  284     write HEADER;                                                                                        000148   25-05-09
  285     write FOOTER;                                                                                        000149   25-05-09
  286   end-proc;                                                                                              000150   25-05-09
  287                                                                                                          000151   25-05-09
  288                                                                                                          000152   25-05-09
  289                                                                                                          000153   25-05-09
  290                                                                                                          000154   25-05-09
  291                                                                                                          000155   25-05-09
  292                                                                                                          000156   25-05-09
  293                                                                                                          000157   25-05-09
  294                                                                                                          000158   25-05-09
  295                                                                                                          000159   25-05-09
  296                                                                                                          000160   25-05-09
  297                                                                                                          000161   25-05-09
  298                                                                                                          000162   25-05-09
  299   // --------------------------------------------------------------------------                          000163   25-05-09
  300   // This procedure executes and show the screen choiced by parameter                                    000164   25-05-09
  301   // --------------------------------------------------------------------------                          000165   25-05-09
  302   Dcl-Proc ShowScreen;                                                                                   000166   25-05-09
  303     Dcl-Pi ShowScreen ;                                                                                  000167   25-05-09
  304       p_choice char(1);                                                                                  000168   25-05-09
  305     end-pi;                                                                                              000169   25-05-09
  306                                                                                                          000170   25-05-09
  307     Select;                                                                                              000171   25-05-09
  308       When (p_choice = 'I');                                                                             000172   25-05-09
  309         InsertScreen(p_choice);                                                                          000173   25-05-09
  310       When (p_choice = 'S');                                                                             000174   25-05-09
  311         ShowSubfile(p_choice);                                                                           000175   25-05-09
  312       When (p_choice = 'M');                                                                             000176   25-05-09
  313         ModifyScreen(p_choice);                                                                          000177   25-05-09
  314       When (p_choice = 'D');                                                                             000178   25-05-09
  315         DeleteScreen(p_choice);                                                                          000179   25-05-09
  316       When (p_choice = 'V');                                                                             000180   25-05-09
  317         ViewScreen(p_choice);                                                                            000181   25-05-09
  318     EndSl;                                                                                               000182   25-05-09
  319                                                                                                          000183   25-05-09
  320   end-proc;                                                                                              000184   25-05-09
  321                                                                                                          000185   25-05-09
  322                                                                                                          000186   25-05-09
  323                                                                                                          000187   25-05-09
  324                                                                                                          000188   25-05-09
  325                                                                                                          000189   25-05-09
  326                                                                                                          000190   25-05-09
  327                                                                                                          000191   25-05-09
  328   // --------------------------------------------------------------------------                          000192   25-05-09
  329   // Show Window to user for confirm the current action                                                  000193   25-05-09
  330   // --------------------------------------------------------------------------                          000194   25-05-09
  331   Dcl-Proc ShowWdw;                                                                                      000195   25-05-09
  332     Dcl-Pi ShowWdw;                                                                                      000196   25-05-09
  333       p_choice char(1);                                                                                  000197   25-05-09
  334     end-pi;                                                                                              000198   25-05-09
  335                                                                                                          000199   25-05-09
  336     // 'C' for confirm save record in database                                                           000200   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     8
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  337     If (p_choice = 'C');                                                                                 000201   25-05-09
  338       WDWTEXT1 = 'Are you sure to execute this action?';                                                 000202   25-05-09
  339       WDWTEXT2 = 'Please type Y/N ';                                                                     000203   25-05-09
  340       write WDWCONFIRM;                                                                                  000204   25-05-09
  341       exfmt WDWCONFIRM;                                                                                  000205   25-05-09
  342     EndIf;                                                                                               000206   25-05-09
  343                                                                                                          000207   25-05-09
  344     // 'M' for message information                                                                       000208   25-05-09
  345     If (p_choice = 'M');                                                                                 000209   25-05-09
  346       WDWMSG1 = 'Your record has been saved';                                                            000210   25-05-09
  347       exfmt WDWMESSAGE;                                                                                  000211   25-05-09
  348     EndIf;                                                                                               000212   25-05-09
  349                                                                                                          000213   25-05-09
  350     If (p_choice = 'D');                                                                                 000214   25-05-09
  351       WDWMSG1 = 'Your record has been deleted';                                                          000215   25-05-09
  352       exfmt WDWMESSAGE;                                                                                  000216   25-05-09
  353     EndIf;                                                                                               000217   25-05-09
  354                                                                                                          000218   25-05-09
  355     // 'E' for error message                                                                             000219   25-05-09
  356     If (p_choice = 'E');                                                                                 000220   25-05-09
  357       WDWMSG1 = 'Error executing this action ';                                                          000221   25-05-09
  358       exfmt WDWMESSAGE;                                                                                  000222   25-05-09
  359     EndIf;                                                                                               000223   25-05-09
  360                                                                                                          000224   25-05-09
  361   end-proc;                                                                                              000225   25-05-09
  362                                                                                                          000226   25-05-09
  363                                                                                                          000227   25-05-09
  364                                                                                                          000228   25-05-09
  365                                                                                                          000229   25-05-09
  366                                                                                                          000230   25-05-09
  367                                                                                                          000231   25-05-09
  368                                                                                                          000232   25-05-09
  369                                                                                                          000233   25-05-09
  370                                                                                                          000234   25-05-09
  371                                                                                                          000235   25-05-09
  372                                                                                                          000236   25-05-09
  373   // --------------------------------------------------------------------------                          000237   25-05-09
  374   // This procedure Center the titles of the screen                                                      000238   25-05-09
  375   // --------------------------------------------------------------------------                          000239   25-05-09
  376   Dcl-Proc Center;                                                                                       000240   25-05-09
  377     Dcl-Pi Center char(80);                                                                              000241   25-05-09
  378       Par_Text char(80) value;                                                                           000242   25-05-09
  379       Par_Length zoned(2:0) value;                                                                       000243   25-05-09
  380     end-pi;                                                                                              000244   25-05-09
  381                                                                                                          000245   25-05-09
  382     // Local variables                                                                                   000246   25-05-09
  383     Dcl-S LenBlanks zoned(2:0);                                                                          000247   25-05-09
  384     Dcl-S InitPosition zoned(2:0);                                                                       000248   25-05-09
  385     Dcl-S Centeredtext char(80);                                                                         000249   25-05-09
  386                                                                                                          000250   25-05-09
  387     LenBlanks= Par_Length - %Len(%Trim(Par_Text));                                                       000251   25-05-09
  388     InitPosition = LenBlanks /2;                                                                         000252   25-05-09
  389     %Subst(Centeredtext:InitPosition)= %Trim(Par_Text);                                                  000253   25-05-09
  390     Return Centeredtext;                                                                                 000254   25-05-09
  391                                                                                                          000255   25-05-09
  392   end-proc;                                                                                              000256   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page     9
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  393                                                                                                          000257   25-05-09
  394                                                                                                          000258   25-05-09
  395                                                                                                          000259   25-05-09
  396                                                                                                          000260   25-05-09
  397                                                                                                          000261   25-05-09
  398                                                                                                          000262   25-05-09
  399                                                                                                          000263   25-05-09
  400                                                                                                          000264   25-05-09
  401   // --------------------------------------------------------------------------                          000265   25-05-09
  402   // Show the subfile in the screen                                                                      000266   25-05-09
  403   // --------------------------------------------------------------------------                          000267   25-05-09
  404   Dcl-Proc ShowSubfile;                                                                                  000268   25-05-09
  405     Dcl-Pi ShowSubfile;                                                                                  000269   25-05-09
  406       p_choice char(1);                                                                                  000270   25-05-09
  407     end-pi;                                                                                              000271   25-05-09
  408                                                                                                          000272   25-05-09
  409     Dcl-S w_exist char(1);                                                                               000273   25-05-09
  410     Dcl-S choice char(1);                                                                                000274   25-05-09
  411                                                                                                          000275   25-05-09
  412     dow (not PFKEY03);                                                                                   000276   25-05-09
  413       WriteScreen(p_choice);                                                                             000277   25-05-09
  414       ActivateSubfile();                                                                                 000278   25-05-09
  415       exfmt SFLTASKCTL;                                                                                  000279   25-05-09
  416                                                                                                          000280   25-05-09
  417       Select ;                                                                                           000281   25-05-09
  418         When (PFKEY03);                                                                                  000282   25-05-09
  419           PFKEY03 = *Off;                                                                                000283   25-05-09
  420           reset Initialpos;                                                                              000284   25-05-09
  421           reset Finalpos;                                                                                000285   25-05-09
  422           leave;                                                                                         000286   25-05-09
  423         When (infds.funcKey = PAGEUP);                                                                   000287   25-05-09
  424           If (Initialpos = 0 and Finalpos = 10);                                                         000288   25-05-09
  425             iter;                                                                                        000289   25-05-09
  426           elseif (Initialpos > 1 and Finalpos > 10);                                                     000290   25-05-09
  427             Initialpos -= 11;                                                                            000291   25-05-09
  428             Finalpos -= 10;                                                                              000292   25-05-09
  429             ShowScreen(p_choice);                                                                        000293   25-05-09
  430             leave;                                                                                       000294   25-05-09
  431           EndIf;                                                                                         000295   25-05-09
  432                                                                                                          000296   25-05-09
  433         When (infds.funcKey = PAGEDOWN);                                                                 000297   25-05-09
  434                                                                                                          000298   25-05-09
  435           If (Initialpos > 0 and Finalpos > 10);                                                         000299   25-05-09
  436                                                                                                          000300   25-05-09
  437             exec sql                                                                                     000301   25-05-09
  438             SELECT '1'                                                                                   000302   25-05-09
  439               INTO : w_exist                                                                             000303   25-05-09
  440               FROM (SELECT A.*,                                                                          000304   25-05-09
  441                            RowNumber()                                                                   000305   25-05-09
  442                       Over()                                                                             000306   25-05-09
  443                       as RNum                                                                            000307   25-05-09
  444                       FROM CRUD01TBL AS A                                                                000308   25-05-09
  445                       Where 1 = 1)                                                                       000309   25-05-09
  446               as Tbl                                                                                     000310   25-05-09
  447               Where RNum BetWeen : Initialpos AND                                                        000311   25-05-09
  448                     :Finalpos                                                                            000312   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    10
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  449               FETCH FIRST ROW ONLY;                                                                      000313   25-05-09
  450                                                                                                          000314   25-05-09
  451             If (w_exist <> '1');                                                                         000315   25-05-09
  452               Initialpos -= 11;                                                                          000316   25-05-09
  453               Finalpos -= 10;                                                                            000317   25-05-09
  454             EndIf;                                                                                       000318   25-05-09
  455                                                                                                          000319   25-05-09
  456             ShowScreen(p_choice);                                                                        000320   25-05-09
  457             leave;                                                                                       000321   25-05-09
  458                                                                                                          000322   25-05-09
  459           Else;                                                                                          000323   25-05-09
  460             ShowScreen(p_choice);                                                                        000324   25-05-09
  461             leave;                                                                                       000325   25-05-09
  462           EndIf;                                                                                         000326   25-05-09
  463                                                                                                          000327   25-05-09
  464         When (pfkey(05));                                                                                000328   25-05-09
  465                                                                                                          000329   25-05-09
  466           reset Initialpos;                                                                              000330   25-05-09
  467           reset Finalpos;                                                                                000331   25-05-09
  468                                                                                                          000332   25-05-09
  469           ShowScreen(p_choice);                                                                          000333   25-05-09
  470           leave;                                                                                         000334   25-05-09
  471         When (pfkey(06));                                                                                000335   25-05-09
  472           choice = 'I';                                                                                  000336   25-05-09
  473           ShowScreen(choice);                                                                            000337   25-05-09
  474           leave;                                                                                         000338   25-05-09
  475         Other;                                                                                           000339   25-05-09
  476           reset w_Wheresfl;                                                                              000340   25-05-09
  477                                                                                                          000341   25-05-09
  478           // if there are selected records in subfile then executes                                      000342   25-05-09
  479           If (taskrrn > *zeros);                                                                         000343   25-05-09
  480             for taskrrn = 1 to PERPAGE;                                                                  000344   25-05-09
  481               chain taskrrn SFLTASK;                                                                     000345   25-05-09
  482               If (%found());                                                                             000346   25-05-09
  483                                                                                                          000347   25-05-09
  484                 Select;                                                                                  000348   25-05-09
  485                   When (OPCTASK = '2');                                                                  000349   25-05-09
  486                                                                                                          000350   25-05-09
  487                     clear Ds_datacrud;                                                                   000351   25-05-09
  488                                                                                                          000352   25-05-09
  489                     // Loads the data into data structure                                                000353   25-05-09
  490                     exec sql                                                                             000354   25-05-09
  491                   SELECT * INTO:Ds_datacrud                                                              000355   25-05-09
  492                     FROM CRUD01TBL                                                                       000356   25-05-09
  493                     WHERE TASK_ID = : SFLTASKID;                                                         000357   25-05-09
  494                                                                                                          000358   25-05-09
  495                     choice = 'M';                                                                        000359   25-05-09
  496                     ShowScreen(choice);                                                                  000360   25-05-09
  497                     leave;                                                                               000361   25-05-09
  498                   When (OPCTASK = '4');                                                                  000362   25-05-09
  499                     clear Ds_datacrud;                                                                   000363   25-05-09
  500                                                                                                          000364   25-05-09
  501                     // Loads the data into data structure                                                000365   25-05-09
  502                     exec sql                                                                             000366   25-05-09
  503                   SELECT * INTO:Ds_datacrud                                                              000367   25-05-09
  504                     FROM CRUD01TBL                                                                       000368   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    11
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  505                     WHERE TASK_ID = : SFLTASKID;                                                         000369   25-05-09
  506                                                                                                          000370   25-05-09
  507                     choice = 'D';                                                                        000371   25-05-09
  508                     ShowScreen(choice);                                                                  000372   25-05-09
  509                     leave;                                                                               000373   25-05-09
  510                   When (OPCTASK = '5');                                                                  000374   25-05-09
  511                     clear Ds_datacrud;                                                                   000375   25-05-09
  512                                                                                                          000376   25-05-09
  513                     // Loads the data into data structure                                                000377   25-05-09
  514                     exec sql                                                                             000378   25-05-09
  515                   SELECT * INTO:Ds_datacrud                                                              000379   25-05-09
  516                     FROM CRUD01TBL                                                                       000380   25-05-09
  517                     WHERE TASK_ID = : SFLTASKID;                                                         000381   25-05-09
  518                                                                                                          000382   25-05-09
  519                     choice = 'V';                                                                        000383   25-05-09
  520                     ShowScreen(choice);                                                                  000384   25-05-09
  521                     leave;                                                                               000385   25-05-09
  522                 EndSl;                                                                                   000386   25-05-09
  523                 // Clean the field                                                                       000387   25-05-09
  524                 OPCTASK = *Blanks;                                                                       000388   25-05-09
  525                 Update SFLTASK;                                                                          000389   25-05-09
  526               Else;                                                                                      000390   25-05-09
  527                 leave;                                                                                   000391   25-05-09
  528               EndIf;                                                                                     000392   25-05-09
  529             endfor;                                                                                      000393   25-05-09
  530           EndIf;                                                                                         000394   25-05-09
  531       EndSl;                                                                                             000395   25-05-09
  532       If (w_Crudfinalize = *On);                                                                         000396   25-05-09
  533         w_Crudfinalize = *Off;                                                                           000397   25-05-09
  534         leave;                                                                                           000398   25-05-09
  535       EndIf;                                                                                             000399   25-05-09
  536                                                                                                          000400   25-05-09
  537     enddo;                                                                                               000401   25-05-09
  538                                                                                                          000402   25-05-09
  539   end-proc ;                                                                                             000403   25-05-09
  540                                                                                                          000404   25-05-09
  541                                                                                                          000405   25-05-09
  542                                                                                                          000406   25-05-09
  543                                                                                                          000407   25-05-09
  544                                                                                                          000408   25-05-09
  545                                                                                                          000409   25-05-09
  546                                                                                                          000410   25-05-09
  547   // --------------------------------------------------------------------------                          000411   25-05-09
  548   // handle all screen validation                                                                        000412   25-05-09
  549   // --------------------------------------------------------------------------                          000413   25-05-09
  550   Dcl-Proc ScreenValidation ;                                                                            000414   25-05-09
  551     Dcl-Pi ScreenValidation Ind;                                                                         000415   25-05-09
  552       p_choice char(1);                                                                                  000416   25-05-09
  553     end-pi;                                                                                              000417   25-05-09
  554                                                                                                          000418   25-05-09
  555     Dcl-S w_ValidisnotOK Ind;                                                                            000419   25-05-09
  556     Dcl-S w_Exists char(1);                                                                              000420   25-05-09
  557                                                                                                          000421   25-05-09
  558     // Set zeros in general variable based in  DisplayIndicators                                         000422   25-05-09
  559     IndErrors = *zeros;                                                                                  000423   25-05-09
  560                                                                                                          000424   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    12
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  561     If (p_choice = 'I'); // Validations for Insert                                                       000425   25-05-09
  562                                                                                                          000426   25-05-09
  563       TurnoffErrors();                                                                                   000427   25-05-09
  564                                                                                                          000428   25-05-09
  565       // Search Task id entered into database                                                            000429   25-05-09
  566       exec sql                                                                                           000430   25-05-09
  567         SELECT '1'                                                                                       000431   25-05-09
  568           INTO : w_Exists                                                                                000432   25-05-09
  569           FROM CRUD01TBL                                                                                 000433   25-05-09
  570           WHERE TASK_ID = :CRUDTASKID;                                                                   000434   25-05-09
  571                                                                                                          000435   25-05-09
  572       Taskidexisterror_31 = (w_Exists = '1');                                                            000436   25-05-09
  573                                                                                                          000437   25-05-09
  574       // Validation of dates                                                                             000438   25-05-09
  575       test(De) *iso STARTDATE; //Validates if date is in YYYYMMDD                                        000439   25-05-09
  576                                                                                                          000440   25-05-09
  577       Startdateerror_32 = %error;                                                                        000441   25-05-09
  578                                                                                                          000442   25-05-09
  579       test(De) *iso ENDDATE;                                                                             000443   25-05-09
  580                                                                                                          000444   25-05-09
  581       Enddateerror_33 = %error;                                                                          000445   25-05-09
  582                                                                                                          000446   25-05-09
  583       If (STARTDATE <> *zeros and ENDDATE <> *zeros                                                      000447   25-05-09
  584           and Startdateerror_32 = *Off and Enddateerror_33 = *Off);                                      000448   25-05-09
  585         If (STARTDATE > ENDDATE);                                                                        000449   25-05-09
  586           Dategreaterthanerror_34 = *On;                                                                 000450   25-05-09
  587         EndIf;                                                                                           000451   25-05-09
  588       EndIf;                                                                                             000452   25-05-09
  589     EndIf;                                                                                               000453   25-05-09
  590                                                                                                          000454   25-05-09
  591     w_ValidisnotOK = IndErrors <> *Zeros;                                                                000455   25-05-09
  592                                                                                                          000456   25-05-09
  593     Return w_ValidisnotOK;                                                                               000457   25-05-09
  594   end-proc;                                                                                              000458   25-05-09
  595                                                                                                          000459   25-05-09
  596                                                                                                          000460   25-05-09
  597                                                                                                          000461   25-05-09
  598                                                                                                          000462   25-05-09
  599                                                                                                          000463   25-05-09
  600                                                                                                          000464   25-05-09
  601   // --------------------------------------------------------------------------                          000465   25-05-09
  602   // reset errors                                                                                        000466   25-05-09
  603   // --------------------------------------------------------------------------                          000467   25-05-09
  604   Dcl-Proc TurnoffErrors;                                                                                000468   25-05-09
  605     Taskidexisterror_31 = *Off;                                                                          000469   25-05-09
  606     Startdateerror_32 = *Off;                                                                            000470   25-05-09
  607     Enddateerror_33 = *Off;                                                                              000471   25-05-09
  608     Dategreaterthanerror_34 = *Off;                                                                      000472   25-05-09
  609   end-proc ;                                                                                             000473   25-05-09
  610                                                                                                          000474   25-05-09
  611                                                                                                          000475   25-05-09
  612                                                                                                          000476   25-05-09
  613                                                                                                          000477   25-05-09
  614                                                                                                          000478   25-05-09
  615   // --------------------------------------------------------------------------                          000479   25-05-09
  616   // This procedure set the sql variable to the procedure to                                             000480   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    13
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  617   // populate the subfile with data based in the customized                                              000481   25-05-09
  618   // sql variable                                                                                        000482   25-05-09
  619   // --------------------------------------------------------------------------                          000483   25-05-09
  620   Dcl-Proc SubfileStart;                                                                                 000484   25-05-09
  621     Dcl-Pi SubfileStart;                                                                                 000485   25-05-09
  622     end-pi;                                                                                              000486   25-05-09
  623                                                                                                          000487   25-05-09
  624     // Variable for store the sql query required                                                         000488   25-05-09
  625     Dcl-S sqlcustomized char(500);                                                                       000489   25-05-09
  626                                                                                                          000490   25-05-09
  627     sqlcustomized = 'SELECT TASK_ID , NAME , STARTDATE , ENDDATE , STATE '+                              000491   25-05-09
  628                     'FROM (SELECT A.*, RowNumber() Over() as RNum FROM '+                                000492   25-05-09
  629                     'CRUD01TBL AS A Where 1=1) as Tbl Where RNum '+                                      000493   25-05-09
  630                     'BetWeen '+%char(Initialpos)+' and '+%char(Finalpos) +                               000494   25-05-09
  631                     ' '+%trim(w_Wheresfl);                                                               000495   25-05-09
  632                                                                                                          000496   25-05-09
  633     FillSfl(sqlcustomized);                                                                              000497   25-05-09
  634                                                                                                          000498   25-05-09
  635   end-proc;                                                                                              000499   25-05-09
  636                                                                                                          000500   25-05-09
  637                                                                                                          000501   25-05-09
  638                                                                                                          000502   25-05-09
  639                                                                                                          000503   25-05-09
  640                                                                                                          000504   25-05-09
  641   // --------------------------------------------------------------------------                          000505   25-05-09
  642   // Initialize and prepare the subfile                                                                  000506   25-05-09
  643   // --------------------------------------------------------------------------                          000507   25-05-09
  644   Dcl-Proc Sflinitial;                                                                                   000508   25-05-09
  645     SflEnd = *off;                                                                                       000509   25-05-09
  646     SflClr = *on;                                                                                        000510   25-05-09
  647     write SFLTASKCTL;                                                                                    000511   25-05-09
  648     SflClr = *off;                                                                                       000512   25-05-09
  649     taskrrn = *zeros;                                                                                    000513   25-05-09
  650     SflDsp = *off;                                                                                       000514   25-05-09
  651     SflDspCtl = *off;                                                                                    000515   25-05-09
  652   end-proc;                                                                                              000516   25-05-09
  653                                                                                                          000517   25-05-09
  654                                                                                                          000518   25-05-09
  655                                                                                                          000519   25-05-09
  656                                                                                                          000520   25-05-09
  657                                                                                                          000521   25-05-09
  658                                                                                                          000522   25-05-09
  659                                                                                                          000523   25-05-09
  660   // --------------------------------------------------------------------------                          000524   25-05-09
  661   // Activate the subfile for being displayed on screen                                                  000525   25-05-09
  662   // --------------------------------------------------------------------------                          000526   25-05-09
  663   Dcl-Proc ActivateSubfile;                                                                              000527   25-05-09
  664     Sflinitial();                                                                                        000528   25-05-09
  665     SubfileStart();                                                                                      000529   25-05-09
  666                                                                                                          000530   25-05-09
  667     SflEnd = Gettotalrecords() < 10;                                                                     000531   25-05-09
  668                                                                                                          000532   25-05-09
  669     If (taskrrn > 0);                                                                                    000533   25-05-09
  670       SflDsp = *On;                                                                                      000534   25-05-09
  671     Else;                                                                                                000535   25-05-09
  672       write EMPTY;                                                                                       000536   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    14
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  673     EndIf;                                                                                               000537   25-05-09
  674                                                                                                          000538   25-05-09
  675     SflDspCtl = *On;                                                                                     000539   25-05-09
  676   end-proc;                                                                                              000540   25-05-09
  677                                                                                                          000541   25-05-09
  678                                                                                                          000542   25-05-09
  679                                                                                                          000543   25-05-09
  680                                                                                                          000544   25-05-09
  681                                                                                                          000545   25-05-09
  682                                                                                                          000546   25-05-09
  683                                                                                                          000547   25-05-09
  684                                                                                                          000548   25-05-09
  685   // --------------------------------------------------------------------------                          000549   25-05-09
  686   // Fill the subfile with a Cursor                                                                      000550   25-05-09
  687   // --------------------------------------------------------------------------                          000551   25-05-09
  688   Dcl-Proc FillSfl;                                                                                      000552   25-05-09
  689     Dcl-Pi FillSfl;                                                                                      000553   25-05-09
  690       Par_sqlcustomized char(500);                                                                       000554   25-05-09
  691     end-pi;                                                                                              000555   25-05-09
  692                                                                                                          000556   25-05-09
  693     Dcl-S Count zoned(2:0);                                                                              000557   25-05-09
  694                                                                                                          000558   25-05-09
  695     Dcl-S LastRRN zoned(10:0);                                                                           000559   25-05-09
  696                                                                                                          000560   25-05-09
  697     // Set previous values for indicates final of subfile is it is                                       000561   25-05-09
  698     // necessary                                                                                         000562   25-05-09
  699     clear Previnitialpos;                                                                                000563   25-05-09
  700     clear PrevFinalpos;                                                                                  000564   25-05-09
  701                                                                                                          000565   25-05-09
  702     Previnitialpos = Initialpos;                                                                         000566   25-05-09
  703     PrevFinalpos = Finalpos;                                                                             000567   25-05-09
  704                                                                                                          000568   25-05-09
  705     clear Ds_taskdata;                                                                                   000569   25-05-09
  706                                                                                                          000570   25-05-09
  707     exec sql                                                                                             000571   25-05-09
  708       PREPARE YOURQUERY FROM : Par_sqlcustomized;                                                        000572   25-05-09
  709                                                                                                          000573   25-05-09
  710     exec sql                                                                                             000574   25-05-09
  711       DECLARE TASK_CURSOR INSENSITIVE SCROLL CURSOR FOR YOURQUERY;                                       000575   25-05-09
  712                                                                                                          000576   25-05-09
  713     exec sql                                                                                             000577   25-05-09
  714       OPEN TASK_CURSOR;                                                                                  000578   25-05-09
  715                                                                                                          000579   25-05-09
  716     exec sql                                                                                             000580   25-05-09
  717       FETCH NEXT FROM TASK_CURSOR INTO : Ds_taskdata;                                                    000581   25-05-09
  718                                                                                                          000582   25-05-09
  719     dow (xSQLState <> NODATA_ON_SQL) and (Count < PERPAGE);                                              000583   25-05-09
  720       Count = Count+1;                                                                                   000584   25-05-09
  721       LastRRN = LastRRN+1;                                                                               000585   25-05-09
  722                                                                                                          000586   25-05-09
  723       If (xSQLState = SUCCESS_ON_SQL);                                                                   000587   25-05-09
  724         DatatoSfl();                                                                                     000588   25-05-09
  725       EndIf;                                                                                             000589   25-05-09
  726                                                                                                          000590   25-05-09
  727       exec sql                                                                                           000591   25-05-09
  728         FETCH NEXT FROM TASK_CURSOR INTO : Ds_taskdata;                                                  000592   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    15
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  729       If (xSQLState <> SUCCESS_ON_SQL);                                                                  000593   25-05-09
  730         If (taskrrn = 10);                                                                               000594   25-05-09
  731           Initialpos += Count+1;                                                                         000595   25-05-09
  732           Finalpos += LastRRN;                                                                           000596   25-05-09
  733         EndIf;                                                                                           000597   25-05-09
  734       EndIf;                                                                                             000598   25-05-09
  735     enddo;                                                                                               000599   25-05-09
  736                                                                                                          000600   25-05-09
  737     exec sql                                                                                             000601   25-05-09
  738       CLOSE TASK_CURSOR;                                                                                 000602   25-05-09
  739   end-proc;                                                                                              000603   25-05-09
  740                                                                                                          000604   25-05-09
  741                                                                                                          000605   25-05-09
  742                                                                                                          000606   25-05-09
  743                                                                                                          000607   25-05-09
  744                                                                                                          000608   25-05-09
  745                                                                                                          000609   25-05-09
  746                                                                                                          000610   25-05-09
  747   // --------------------------------------------------------------------------                          000611   25-05-09
  748   // This procedure assign the data fetched from cursor to subfile                                       000612   25-05-09
  749   // --------------------------------------------------------------------------                          000613   25-05-09
  750   Dcl-Proc DatatoSfl;                                                                                    000614   25-05-09
  751     taskrrn +=1;                                                                                         000615   25-05-09
  752     SFLTASKID = Ds_taskdata.Taskid;                                                                      000616   25-05-09
  753     SFLTASKNAM = Ds_taskdata.Nametask;                                                                   000617   25-05-09
  754     SFLSTRDATE = Ds_taskdata.Start_date;                                                                 000618   25-05-09
  755     SFLENDDATE = Ds_taskdata.End_date;                                                                   000619   25-05-09
  756     SFLSTATE = Ds_taskdata.Taskstate;                                                                    000620   25-05-09
  757     write SFLTASK;                                                                                       000621   25-05-09
  758     clear SFLTASK;                                                                                       000622   25-05-09
  759   end-proc;                                                                                              000623   25-05-09
  760                                                                                                          000624   25-05-09
  761                                                                                                          000625   25-05-09
  762                                                                                                          000626   25-05-09
  763                                                                                                          000627   25-05-09
  764                                                                                                          000628   25-05-09
  765                                                                                                          000629   25-05-09
  766                                                                                                          000630   25-05-09
  767                                                                                                          000631   25-05-09
  768   // --------------------------------------------------------------------------                          000632   25-05-09
  769   // get total records                                                                                   000633   25-05-09
  770   // --------------------------------------------------------------------------                          000634   25-05-09
  771   Dcl-Proc Gettotalrecords;                                                                              000635   25-05-09
  772     Dcl-Pi Gettotalrecords zoned(10);                                                                    000636   25-05-09
  773     end-pi;                                                                                              000637   25-05-09
  774                                                                                                          000638   25-05-09
  775     Dcl-S w_Total zoned(10:0);                                                                           000639   25-05-09
  776                                                                                                          000640   25-05-09
  777     Dcl-S sqlcustomized char(500);                                                                       000641   25-05-09
  778                                                                                                          000642   25-05-09
  779     sqlcustomized = 'SELECT COUNT(*) '+                                                                  000643   25-05-09
  780            'FROM (SELECT A.*, RowNumber() Over() as RNum FROM '+                                         000644   25-05-09
  781            'CRUD01TBL AS A Where 1=1) as Tbl Where RNum '+                                               000645   25-05-09
  782            'BetWeen '+%char(Previnitialpos)+' and '+%char(PrevFinalpos) +                                000646   25-05-09
  783            ' '+%trim(w_Wheresfl);                                                                        000647   25-05-09
  784                                                                                                          000648   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    16
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  785     exec sql                                                                                             000649   25-05-09
  786       PREPARE QRY FROM: sqlcustomized;                                                                   000650   25-05-09
  787                                                                                                          000651   25-05-09
  788     exec sql                                                                                             000652   25-05-09
  789       DECLARE QRYC CURSOR FOR QRY;                                                                       000653   25-05-09
  790                                                                                                          000654   25-05-09
  791     exec sql                                                                                             000655   25-05-09
  792       OPEN QRYC;                                                                                         000656   25-05-09
  793                                                                                                          000657   25-05-09
  794     exec sql                                                                                             000658   25-05-09
  795       FETCH QRYC INTO:w_Total;                                                                           000659   25-05-09
  796                                                                                                          000660   25-05-09
  797     exec sql                                                                                             000661   25-05-09
  798       CLOSE QRYC;                                                                                        000662   25-05-09
  799                                                                                                          000663   25-05-09
  800     Return w_Total;                                                                                      000664   25-05-09
  801   end-proc;                                                                                              000665   25-05-09
  802                                                                                                          000666   25-05-09
  803                                                                                                          000667   25-05-09
  804                                                                                                          000668   25-05-09
  805                                                                                                          000669   25-05-09
  806                                                                                                          000670   25-05-09
  807                                                                                                          000671   25-05-09
  808                                                                                                          000672   25-05-09
  809                                                                                                          000673   25-05-09
  810   // --------------------------------------------------------------------------                          000674   25-05-09
  811   // run the CRUD                                                                                        000675   25-05-09
  812   // --------------------------------------------------------------------------                          000676   25-05-09
  813   Dcl-Proc ExecuteCrudScreen;                                                                            000677   25-05-09
  814     Dcl-Pi ExecuteCrudScreen;                                                                            000678   25-05-09
  815       p_choice char(1);                                                                                  000679   25-05-09
  816     end-pi;                                                                                              000680   25-05-09
  817                                                                                                          000681   25-05-09
  818     If (p_choice = 'I'); // Insert Screen                                                                000682   25-05-09
  819       InsertScreen(p_choice);                                                                            000683   25-05-09
  820     EndIf;                                                                                               000684   25-05-09
  821                                                                                                          000685   25-05-09
  822     If (p_choice = 'M'); // Modify Screen                                                                000686   25-05-09
  823       ModifyScreen(p_choice);                                                                            000687   25-05-09
  824     EndIf;                                                                                               000688   25-05-09
  825                                                                                                          000689   25-05-09
  826     If (p_choice = 'D'); // Delete Screen                                                                000690   25-05-09
  827       DeleteScreen(p_choice);                                                                            000691   25-05-09
  828     EndIf;                                                                                               000692   25-05-09
  829                                                                                                          000693   25-05-09
  830     If (p_choice = 'V'); // View Screen                                                                  000694   25-05-09
  831       ViewScreen(p_choice);                                                                              000695   25-05-09
  832     EndIf;                                                                                               000696   25-05-09
  833   end-proc;                                                                                              000697   25-05-09
  834                                                                                                          000698   25-05-09
  835                                                                                                          000699   25-05-09
  836                                                                                                          000700   25-05-09
  837                                                                                                          000701   25-05-09
  838                                                                                                          000702   25-05-09
  839                                                                                                          000703   25-05-09
  840                                                                                                          000704   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    17
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  841   // --------------------------------------------------------------------------                          000705   25-05-09
  842   // write the screen                                                                                    000706   25-05-09
  843   // --------------------------------------------------------------------------                          000707   25-05-09
  844   Dcl-Proc InsertScreen;                                                                                 000708   25-05-09
  845     Dcl-Pi InsertScreen;                                                                                 000709   25-05-09
  846       p_choice char(1);                                                                                  000710   25-05-09
  847     end-pi;                                                                                              000711   25-05-09
  848                                                                                                          000712   25-05-09
  849     Dcl-S choice char(1);                                                                                000713   25-05-09
  850                                                                                                          000714   25-05-09
  851     WriteScreen(p_choice);                                                                               000715   25-05-09
  852                                                                                                          000716   25-05-09
  853     dow (not PFKEY03);                                                                                   000717   25-05-09
  854       ProtectFields_35 = *Off;                                                                           000718   25-05-09
  855       ProtectFields_36 = *Off;                                                                           000719   25-05-09
  856       exfmt CRUDTASK;                                                                                    000720   25-05-09
  857       Select;                                                                                            000721   25-05-09
  858         When (PFKEY03);                                                                                  000722   25-05-09
  859           clear CRUDTASK;                                                                                000723   25-05-09
  860           reset Initialpos;                                                                              000724   25-05-09
  861           reset Finalpos;                                                                                000725   25-05-09
  862           PFKEY03 = *Off;                                                                                000726   25-05-09
  863           choice = 'S';                                                                                  000727   25-05-09
  864           ShowScreen(choice);                                                                            000728   25-05-09
  865           leave;                                                                                         000729   25-05-09
  866         When (pfkey(10));                                                                                000730   25-05-09
  867           If (ScreenValidation(p_choice) = *Off);                                                        000731   25-05-09
  868                                                                                                          000732   25-05-09
  869             // Executes window confirmation                                                              000733   25-05-09
  870             choice = 'C';                                                                                000734   25-05-09
  871             ShowWdw(choice);                                                                             000735   25-05-09
  872             If (WDWCHOICE = 'Y');                                                                        000736   25-05-09
  873               LoaddatatoDs();                                                                            000737   25-05-09
  874                                                                                                          000738   25-05-09
  875               exec sql                                                                                   000739   25-05-09
  876               INSERT INTO CRUD01TBL                                                                      000740   25-05-09
  877                 VALUES (:Ds_datacrud);                                                                   000741   25-05-09
  878                                                                                                          000742   25-05-09
  879               If (xSQLState = SUCCESS_ON_SQL);                                                           000743   25-05-09
  880                 choice = 'M'; // Message of successful                                                   000744   25-05-09
  881                 ShowWdw(choice);                                                                         000745   25-05-09
  882                 clear CRUDTASK;                                                                          000746   25-05-09
  883                 reset Initialpos;                                                                        000747   25-05-09
  884                 reset Finalpos;                                                                          000748   25-05-09
  885                 choice = 'S';                                                                            000749   25-05-09
  886                 ShowScreen(choice);                                                                      000750   25-05-09
  887                 leave;                                                                                   000751   25-05-09
  888               Else;                                                                                      000752   25-05-09
  889                 choice = 'E'; // Error Message                                                           000753   25-05-09
  890                 ShowWdw(choice);                                                                         000754   25-05-09
  891               EndIf;                                                                                     000755   25-05-09
  892             Else ;                                                                                       000756   25-05-09
  893               clear CRUDTASK;                                                                            000757   25-05-09
  894             EndIf;                                                                                       000758   25-05-09
  895           EndIf;                                                                                         000759   25-05-09
  896                                                                                                          000760   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    18
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  897         Other;                                                                                           000761   25-05-09
  898           If (ScreenValidation(p_choice) = *On);                                                         000762   25-05-09
  899             iter;                                                                                        000763   25-05-09
  900           EndIf ;                                                                                        000764   25-05-09
  901       EndSl;                                                                                             000765   25-05-09
  902     enddo;                                                                                               000766   25-05-09
  903   end-proc;                                                                                              000767   25-05-09
  904                                                                                                          000768   25-05-09
  905                                                                                                          000769   25-05-09
  906                                                                                                          000770   25-05-09
  907   // --------------------------------------------------------------------------                          000771   25-05-09
  908   // modify screen                                                                                       000772   25-05-09
  909   // --------------------------------------------------------------------------                          000773   25-05-09
  910   Dcl-Proc ModifyScreen;                                                                                 000774   25-05-09
  911     Dcl-Pi ModifyScreen;                                                                                 000775   25-05-09
  912       p_choice char(1);                                                                                  000776   25-05-09
  913     end-pi;                                                                                              000777   25-05-09
  914                                                                                                          000778   25-05-09
  915     Dcl-S choice char(1);                                                                                000779   25-05-09
  916                                                                                                          000780   25-05-09
  917     LoaddatatoScreen();                                                                                  000781   25-05-09
  918     WriteScreen(p_choice);                                                                               000782   25-05-09
  919                                                                                                          000783   25-05-09
  920     dow (not PFKEY03);                                                                                   000784   25-05-09
  921       ProtectFields_35 = *On;                                                                            000785   25-05-09
  922       exfmt CRUDTASK;                                                                                    000786   25-05-09
  923       Select;                                                                                            000787   25-05-09
  924         When (PFKEY03);                                                                                  000788   25-05-09
  925           ProtectFields_35 = *Off;                                                                       000789   25-05-09
  926           clear CRUDTASK;                                                                                000790   25-05-09
  927           clear OPCTASK;                                                                                 000791   25-05-09
  928           PFKEY03 = *Off;                                                                                000792   25-05-09
  929           w_Crudfinalize = *On ;                                                                         000793   25-05-09
  930           reset Initialpos;                                                                              000794   25-05-09
  931           reset Finalpos;                                                                                000795   25-05-09
  932           choice = 'S';                                                                                  000796   25-05-09
  933           ShowScreen(choice);                                                                            000797   25-05-09
  934           leave;                                                                                         000798   25-05-09
  935         When (pfkey(10));                                                                                000799   25-05-09
  936           If (ScreenValidation(p_choice) = *Off);                                                        000800   25-05-09
  937                                                                                                          000801   25-05-09
  938             // Executes window confirmation                                                              000802   25-05-09
  939             choice = 'C';                                                                                000803   25-05-09
  940             ShowWdw(choice);                                                                             000804   25-05-09
  941             If (WDWCHOICE = 'Y');                                                                        000805   25-05-09
  942                                                                                                          000806   25-05-09
  943               exec sql                                                                                   000807   25-05-09
  944               UPDATE CRUD01TBL                                                                           000808   25-05-09
  945                 SET NAME = :NAMETASK,                                                                    000809   25-05-09
  946                     DESCR = :DESCRP,                                                                     000810   25-05-09
  947                     ENDDES = :SOLUTION,                                                                  000811   25-05-09
  948                     STARTDATE = :STARTDATE,                                                              000812   25-05-09
  949                     ENDDATE = :ENDDATE,                                                                  000813   25-05-09
  950                     STATE = :STATETASK,                                                                  000814   25-05-09
  951                     OWNER = :CurrentUser                                                                 000815   25-05-09
  952                 WHERE TASK_ID = : CRUDTASKID;                                                            000816   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    19
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  953                                                                                                          000817   25-05-09
  954               If (xSQLState = SUCCESS_ON_SQL);                                                           000818   25-05-09
  955                 choice = 'M'; // Message of successful                                                   000819   25-05-09
  956                 ShowWdw(choice);                                                                         000820   25-05-09
  957                 clear CRUDTASK;                                                                          000821   25-05-09
  958                 clear OPCTASK;                                                                           000822   25-05-09
  959                 reset Initialpos;                                                                        000823   25-05-09
  960                 reset Finalpos;                                                                          000824   25-05-09
  961                 choice = 'S';                                                                            000825   25-05-09
  962                 ShowScreen(choice);                                                                      000826   25-05-09
  963                 w_Crudfinalize = *On ;                                                                   000827   25-05-09
  964                 leave;                                                                                   000828   25-05-09
  965               Else;                                                                                      000829   25-05-09
  966                 choice = 'E'; // Error Message                                                           000830   25-05-09
  967                 ShowWdw(choice);                                                                         000831   25-05-09
  968               EndIf;                                                                                     000832   25-05-09
  969             Else ;                                                                                       000833   25-05-09
  970               clear CRUDTASK;                                                                            000834   25-05-09
  971             EndIf;                                                                                       000835   25-05-09
  972           EndIf;                                                                                         000836   25-05-09
  973                                                                                                          000837   25-05-09
  974         Other;                                                                                           000838   25-05-09
  975           If (ScreenValidation(p_choice) = *On);                                                         000839   25-05-09
  976             iter;                                                                                        000840   25-05-09
  977           EndIf ;                                                                                        000841   25-05-09
  978       EndSl;                                                                                             000842   25-05-09
  979     enddo;                                                                                               000843   25-05-09
  980   end-proc;                                                                                              000844   25-05-09
  981                                                                                                          000845   25-05-09
  982                                                                                                          000846   25-05-09
  983                                                                                                          000847   25-05-09
  984                                                                                                          000848   25-05-09
  985                                                                                                          000849   25-05-09
  986                                                                                                          000850   25-05-09
  987                                                                                                          000851   25-05-09
  988                                                                                                          000852   25-05-09
  989   // --------------------------------------------------------------------------                          000853   25-05-09
  990   // delete screen                                                                                       000854   25-05-09
  991   // --------------------------------------------------------------------------                          000855   25-05-09
  992   Dcl-Proc DeleteScreen;                                                                                 000856   25-05-09
  993     Dcl-Pi DeleteScreen;                                                                                 000857   25-05-09
  994       p_choice char(1);                                                                                  000858   25-05-09
  995     end-pi;                                                                                              000859   25-05-09
  996                                                                                                          000860   25-05-09
  997     Dcl-S choice char(1);                                                                                000861   25-05-09
  998                                                                                                          000862   25-05-09
  999     LoaddatatoScreen();                                                                                  000863   25-05-09
 1000     WriteScreen(p_choice);                                                                               000864   25-05-09
 1001                                                                                                          000865   25-05-09
 1002     dow (not PFKEY03);                                                                                   000866   25-05-09
 1003       ProtectFields_35 = *On;                                                                            000867   25-05-09
 1004       ProtectFields_36 = *On;                                                                            000868   25-05-09
 1005       exfmt CRUDTASK;                                                                                    000869   25-05-09
 1006       Select;                                                                                            000870   25-05-09
 1007         When (PFKEY03);                                                                                  000871   25-05-09
 1008           ProtectFields_35 = *Off;                                                                       000872   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    20
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
 1009           ProtectFields_36 = *Off;                                                                       000873   25-05-09
 1010           clear CRUDTASK;                                                                                000874   25-05-09
 1011           clear OPCTASK;                                                                                 000875   25-05-09
 1012           PFKEY03 = *Off;                                                                                000876   25-05-09
 1013           w_Crudfinalize = *On ;                                                                         000877   25-05-09
 1014           reset Initialpos;                                                                              000878   25-05-09
 1015           reset Finalpos;                                                                                000879   25-05-09
 1016           choice = 'S';                                                                                  000880   25-05-09
 1017           ShowScreen(choice);                                                                            000881   25-05-09
 1018           leave;                                                                                         000882   25-05-09
 1019         When (pfkey(10));                                                                                000883   25-05-09
 1020           If (ScreenValidation(p_choice) = *Off);                                                        000884   25-05-09
 1021                                                                                                          000885   25-05-09
 1022             // Executes window confirmation                                                              000886   25-05-09
 1023             choice = 'C';                                                                                000887   25-05-09
 1024             ShowWdw(choice);                                                                             000888   25-05-09
 1025             If (WDWCHOICE = 'Y');                                                                        000889   25-05-09
 1026                                                                                                          000890   25-05-09
 1027               exec sql                                                                                   000891   25-05-09
 1028               DELETE FROM CRUD01TBL WHERE TASK_ID = : CRUDTASKID;                                        000892   25-05-09
 1029                                                                                                          000893   25-05-09
 1030               If (xSQLState = SUCCESS_ON_SQL);                                                           000894   25-05-09
 1031                 ShowWdw(p_choice);                                                                       000895   25-05-09
 1032                 clear CRUDTASK;                                                                          000896   25-05-09
 1033                 clear OPCTASK;                                                                           000897   25-05-09
 1034                 reset Initialpos;                                                                        000898   25-05-09
 1035                 reset Finalpos;                                                                          000899   25-05-09
 1036                 choice = 'S';                                                                            000900   25-05-09
 1037                 ShowScreen(choice);                                                                      000901   25-05-09
 1038                 w_Crudfinalize = *On ;                                                                   000902   25-05-09
 1039                 leave;                                                                                   000903   25-05-09
 1040               Else;                                                                                      000904   25-05-09
 1041                 choice = 'E'; // Error Message                                                           000905   25-05-09
 1042                 ShowWdw(choice);                                                                         000906   25-05-09
 1043               EndIf;                                                                                     000907   25-05-09
 1044             Else ;                                                                                       000908   25-05-09
 1045               clear CRUDTASK;                                                                            000909   25-05-09
 1046             EndIf;                                                                                       000910   25-05-09
 1047           EndIf;                                                                                         000911   25-05-09
 1048                                                                                                          000912   25-05-09
 1049         Other;                                                                                           000913   25-05-09
 1050           If (ScreenValidation(p_choice) = *On);                                                         000914   25-05-09
 1051             iter;                                                                                        000915   25-05-09
 1052           EndIf ;                                                                                        000916   25-05-09
 1053       EndSl;                                                                                             000917   25-05-09
 1054     enddo;                                                                                               000918   25-05-09
 1055   end-proc;                                                                                              000919   25-05-09
 1056                                                                                                          000920   25-05-09
 1057                                                                                                          000921   25-05-09
 1058                                                                                                          000922   25-05-09
 1059                                                                                                          000923   25-05-09
 1060                                                                                                          000924   25-05-09
 1061                                                                                                          000925   25-05-09
 1062                                                                                                          000926   25-05-09
 1063   // --------------------------------------------------------------------------                          000927   25-05-09
 1064   // view the screen                                                                                     000928   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    21
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
 1065   // --------------------------------------------------------------------------                          000929   25-05-09
 1066   Dcl-Proc ViewScreen;                                                                                   000930   25-05-09
 1067     Dcl-Pi ViewScreen;                                                                                   000931   25-05-09
 1068       p_choice char(1);                                                                                  000932   25-05-09
 1069     end-pi;                                                                                              000933   25-05-09
 1070                                                                                                          000934   25-05-09
 1071     Dcl-S choice char(1);                                                                                000935   25-05-09
 1072                                                                                                          000936   25-05-09
 1073     LoaddatatoScreen();                                                                                  000937   25-05-09
 1074     WriteScreen(p_choice);                                                                               000938   25-05-09
 1075                                                                                                          000939   25-05-09
 1076     dow (not PFKEY03);                                                                                   000940   25-05-09
 1077       ProtectFields_35 = *On;                                                                            000941   25-05-09
 1078       ProtectFields_36 = *On;                                                                            000942   25-05-09
 1079       exfmt CRUDTASK;                                                                                    000943   25-05-09
 1080       If (PFKEY03);                                                                                      000944   25-05-09
 1081         ProtectFields_35 = *Off;                                                                         000945   25-05-09
 1082         ProtectFields_36 = *Off;                                                                         000946   25-05-09
 1083         clear CRUDTASK;                                                                                  000947   25-05-09
 1084         clear OPCTASK;                                                                                   000948   25-05-09
 1085         PFKEY03 = *Off;                                                                                  000949   25-05-09
 1086         w_Crudfinalize = *On ;                                                                           000950   25-05-09
 1087         reset Initialpos;                                                                                000951   25-05-09
 1088         reset Finalpos;                                                                                  000952   25-05-09
 1089         choice = 'S';                                                                                    000953   25-05-09
 1090         ShowScreen(choice);                                                                              000954   25-05-09
 1091         leave;                                                                                           000955   25-05-09
 1092       EndIf;                                                                                             000956   25-05-09
 1093     enddo;                                                                                               000957   25-05-09
 1094   end-proc;                                                                                              000958   25-05-09
 1095                                                                                                          000959   25-05-09
 1096                                                                                                          000960   25-05-09
 1097                                                                                                          000961   25-05-09
 1098                                                                                                          000962   25-05-09
 1099                                                                                                          000963   25-05-09
 1100                                                                                                          000964   25-05-09
 1101                                                                                                          000965   25-05-09
 1102                                                                                                          000966   25-05-09
 1103   // --------------------------------------------------------------------------                          000967   25-05-09
 1104   // load screen data                                                                                    000968   25-05-09
 1105   // --------------------------------------------------------------------------                          000969   25-05-09
 1106   Dcl-Proc LoaddatatoScreen;                                                                             000970   25-05-09
 1107     clear CRUDTASK;                                                                                      000971   25-05-09
 1108     CRUDTASKID = Ds_datacrud.Task_id;                                                                    000972   25-05-09
 1109     NAMETASK = Ds_datacrud.Name;                                                                         000973   25-05-09
 1110     DESCRP = Ds_datacrud.Descr;                                                                          000974   25-05-09
 1111     SOLUTION = Ds_datacrud.Enddes;                                                                       000975   25-05-09
 1112     STARTDATE = Ds_datacrud.Startdate;                                                                   000976   25-05-09
 1113     ENDDATE = Ds_datacrud.Enddate;                                                                       000977   25-05-09
 1114     STATETASK = Ds_datacrud.State;                                                                       000978   25-05-09
 1115   end-proc ;                                                                                             000979   25-05-09
 1116                                                                                                          000980   25-05-09
 1117                                                                                                          000981   25-05-09
 1118                                                                                                          000982   25-05-09
 1119                                                                                                          000983   25-05-09
 1120                                                                                                          000984   25-05-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    22
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
 1121                                                                                                          000985   25-05-09
 1122                                                                                                          000986   25-05-09
 1123                                                                                                          000987   25-05-09
 1124                                                                                                          000988   25-05-09
 1125   // --------------------------------------------------------------------------                          000989   25-05-09
 1126   // load data to data structure                                                                         000990   25-05-09
 1127   // --------------------------------------------------------------------------                          000991   25-05-09
 1128   Dcl-Proc LoaddatatoDs;                                                                                 000992   25-05-09
 1129     clear Ds_datacrud;                                                                                   000993   25-05-09
 1130     Ds_datacrud.Task_id = CRUDTASKID;                                                                    000994   25-05-09
 1131     Ds_datacrud.Name = %trim(NAMETASK);                                                                  000995   25-05-09
 1132     Ds_datacrud.Descr = %trim(DESCRP);                                                                   000996   25-05-09
 1133     Ds_datacrud.Enddes = %trim(SOLUTION);                                                                000997   25-05-09
 1134     Ds_datacrud.Startdate = STARTDATE;                                                                   000998   25-05-09
 1135     Ds_datacrud.Enddate = ENDDATE;                                                                       000999   25-05-09
 1136     Ds_datacrud.State = STATETASK;                                                                       001000   25-05-09
 1137     Ds_datacrud.Owner = CurrentUser;                                                                     001001   25-05-09
 1138   end-proc;                                                                                              001002   25-05-09
                                * * * * *  E N D  O F  S O U R C E  * * * * *
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    23
                                               CROSS REFERENCE
Data Names                    Define    Reference
A                                ****     TABLE
                                          440 444
ACCESSTYPE                       61       CHARACTER(2) IN INFDS
ACCESSTYPE                       108      CHARACTER(2) IN INFDS_DB
ACCESSTYPE                       109      CHARACTER(2) IN INFDS_DSPF
ACCESSTYPE                       110      CHARACTER(2) IN INFDS_PRTF
ACQUIRESTATUS                    70       CHARACTER(1) IN INFDS
ACQUIRESTATUS                    108      CHARACTER(1) IN INFDS_DB
ACQUIRESTATUS                    109      CHARACTER(1) IN INFDS_DSPF
ACQUIRESTATUS                    110      CHARACTER(1) IN INFDS_PRTF
ACTIVATESUBFILE                  663      RPG PROCEDURE
ACTUALCURSOR                     55       CHARACTER(2) IN INFDS
ACTUALCURSOR                     108      CHARACTER(2) IN INFDS_DB
ACTUALCURSOR                     109      CHARACTER(2) IN INFDS_DSPF
ACTUALCURSOR                     110      CHARACTER(2) IN INFDS_PRTF
ALLOWBLINK                       73       CHARACTER(1) IN INFDS
ALLOWBLINK                       108      CHARACTER(1) IN INFDS_DB
ALLOWBLINK                       109      CHARACTER(1) IN INFDS_DSPF
ALLOWBLINK                       110      CHARACTER(1) IN INFDS_PRTF
BLOCKINCREMENT                   66       SMALL INTEGER PRECISION(4,0) IN INFDS
BLOCKINCREMENT                   108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
BLOCKINCREMENT                   109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
BLOCKINCREMENT                   110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
CCSID                            26       SMALL INTEGER PRECISION(4,0) IN INFDS
CCSID                            108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
CCSID                            109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
CCSID                            110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
CENTER                           376      RPG PROCEDURE
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    24
                                               CROSS REFERENCE
CENTEREDTEXT                     385      CHARACTER(80) IN RPG PROCEDURE CENTER
CHOICE                           225      CHARACTER(1) IN RPG PROCEDURE MAINLINE
CHOICE                           410      CHARACTER(1) IN RPG PROCEDURE SHOWSUBFILE
CHOICE                           849      CHARACTER(1) IN RPG PROCEDURE INSERTSCREEN
CHOICE                           915      CHARACTER(1) IN RPG PROCEDURE MODIFYSCREEN
CHOICE                           997      CHARACTER(1) IN RPG PROCEDURE DELETESCREEN
CHOICE                           1071     CHARACTER(1) IN RPG PROCEDURE VIEWSCREEN
CLEAR                            145      CHARACTER(1) CCSID 65535 CONSTANT
COLORCAPABLE                     79       CHARACTER(1) IN INFDS
COLORCAPABLE                     108      CHARACTER(1) IN INFDS_DB
COLORCAPABLE                     109      CHARACTER(1) IN INFDS_DSPF
COLORCAPABLE                     110      CHARACTER(1) IN INFDS_PRTF
CONTROLLERINFO                   78       CHARACTER(1) IN INFDS
CONTROLLERINFO                   108      CHARACTER(1) IN INFDS_DB
CONTROLLERINFO                   109      CHARACTER(1) IN INFDS_DSPF
CONTROLLERINFO                   110      CHARACTER(1) IN INFDS_PRTF
COUNT                            693      NUMERIC(2,0) IN RPG PROCEDURE FILLSFL
CRUDTASKID                       8        DECIMAL(10,0)
                                          570 952 1028
CRUD01TBL                        ****     TABLE
                                          444 492 504 516 569 876 944 1028
CURRENTLINE                      43       SMALL INTEGER PRECISION(4,0) IN INFDS
CURRENTLINE                      108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
CURRENTLINE                      109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
CURRENTLINE                      110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
CURRENTOPERATIONS                92       CHARACTER(1) IN INFDS
CURRENTOPERATIONS                108      CHARACTER(1) IN INFDS_DB
CURRENTOPERATIONS                109      CHARACTER(1) IN INFDS_DSPF
CURRENTOPERATIONS                110      CHARACTER(1) IN INFDS_PRTF
CURRENTPAGE                      44       INTEGER PRECISION(9,0) IN INFDS
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    25
                                               CROSS REFERENCE
CURRENTPAGE                      108      INTEGER PRECISION(9,0) IN INFDS_DB
CURRENTPAGE                      109      INTEGER PRECISION(9,0) IN INFDS_DSPF
CURRENTPAGE                      110      INTEGER PRECISION(9,0) IN INFDS_PRTF
CURRENTUSER                      213      CHARACTER(10)
                                          951
DATAAVAILABLE                    72       CHARACTER(1) IN INFDS
DATAAVAILABLE                    108      CHARACTER(1) IN INFDS_DB
DATAAVAILABLE                    109      CHARACTER(1) IN INFDS_DSPF
DATAAVAILABLE                    110      CHARACTER(1) IN INFDS_PRTF
DATATOSFL                        750      RPG PROCEDURE
DATEGREATERTHANERROR_34          160      CHARACTER(1) IN DISPLAYINDICATORS
DELETESCREEN                     992      RPG PROCEDURE
DESCR                            189      VARCHAR(150) IN DS_DATACRUD
DESCR                            444      VARCHAR(150) CCSID 37 COLUMN (NOT NULL) IN CRUD01TBL
                                 ****     VARCHAR(150) COLUMN (NOT NULL) IN TBL
DESCR                            ****     COLUMN
                                          946
DESCRP                           8        CHARACTER(150)
                                          946
DEVCLASS                         93       CHARACTER(2) IN INFDS
DEVCLASS                         108      CHARACTER(2) IN INFDS_DB
DEVCLASS                         109      CHARACTER(2) IN INFDS_DSPF
DEVCLASS                         110      CHARACTER(2) IN INFDS_PRTF
DEVICECLASS                      67       CHARACTER(1) IN INFDS
DEVICECLASS                      108      CHARACTER(1) IN INFDS_DB
DEVICECLASS                      109      CHARACTER(1) IN INFDS_DSPF
DEVICECLASS                      110      CHARACTER(1) IN INFDS_PRTF
DEVICEDESC                       97       CHARACTER(10) IN INFDS
DEVICEDESC                       108      CHARACTER(10) IN INFDS_DB
DEVICEDESC                       109      CHARACTER(10) IN INFDS_DSPF
DEVICEDESC                       110      CHARACTER(10) IN INFDS_PRTF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    26
                                               CROSS REFERENCE
DEVICETYPE                       68       CHARACTER(6) IN INFDS
DEVICETYPE                       108      CHARACTER(6) IN INFDS_DB
DEVICETYPE                       109      CHARACTER(6) IN INFDS_DSPF
DEVICETYPE                       110      CHARACTER(6) IN INFDS_PRTF
DISPLAYINDICATORS                150      STRUCTURE
DISPLAYLOCATION                  75       CHARACTER(1) IN INFDS
DISPLAYLOCATION                  108      CHARACTER(1) IN INFDS_DB
DISPLAYLOCATION                  109      CHARACTER(1) IN INFDS_DSPF
DISPLAYLOCATION                  110      CHARACTER(1) IN INFDS_PRTF
DISPLAYTYPE                      76       CHARACTER(1) IN INFDS
DISPLAYTYPE                      108      CHARACTER(1) IN INFDS_DB
DISPLAYTYPE                      109      CHARACTER(1) IN INFDS_DSPF
DISPLAYTYPE                      110      CHARACTER(1) IN INFDS_PRTF
DS_DATACRUD                      189      STRUCTURE
                                          491 503 515 877
DS_SQLSTATE                      169      STRUCTURE
DS_TASKDATA                      180      STRUCTURE
                                          717 728
DUPKEY                           62       CHARACTER(1) IN INFDS
DUPKEY                           108      CHARACTER(1) IN INFDS_DB
DUPKEY                           109      CHARACTER(1) IN INFDS_DSPF
DUPKEY                           110      CHARACTER(1) IN INFDS_PRTF
END_DATE                         184      NUMERIC(8,0) IN DS_TASKDATA
ENDDATE                          189      NUMERIC(8,0) IN DS_DATACRUD
ENDDATE                          8        DECIMAL(8,0)
                                          949
ENDDATE                          444      NUMERIC(8,0) COLUMN (NOT NULL) IN CRUD01TBL
                                 ****     NUMERIC(8,0) COLUMN (NOT NULL) IN TBL
ENDDATE                          ****     COLUMN
                                          949
ENDDATEERROR_33                  159      CHARACTER(1) IN DISPLAYINDICATORS
ENDDES                           189      VARCHAR(150) IN DS_DATACRUD
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    27
                                               CROSS REFERENCE
ENDDES                           444      VARCHAR(150) CCSID 37 COLUMN IN CRUD01TBL
                                 ****     VARCHAR(150) COLUMN (NOT NULL) IN TBL
ENDDES                           ****     COLUMN
                                          947
ENTER                            115      CHARACTER(1) CCSID 65535 CONSTANT
EXECUTECRUDSCREEN                813      RPG PROCEDURE
FILE                             19       CHARACTER(10) IN INFDS
FILE                             108      CHARACTER(10) IN INFDS_DB
FILE                             109      CHARACTER(10) IN INFDS_DSPF
FILE                             110      CHARACTER(10) IN INFDS_PRTF
FILEEOF                          16       CHARACTER(1) IN INFDS
FILEEOF                          108      CHARACTER(1) IN INFDS_DB
FILEEOF                          109      CHARACTER(1) IN INFDS_DSPF
FILEEOF                          110      CHARACTER(1) IN INFDS_PRTF
FILEOPEN                         15       CHARACTER(1) IN INFDS
FILEOPEN                         108      CHARACTER(1) IN INFDS_DB
FILEOPEN                         109      CHARACTER(1) IN INFDS_DSPF
FILEOPEN                         110      CHARACTER(1) IN INFDS_PRTF
FILEPOSBITS                      101      CHARACTER(1) IN INFDS
FILEPOSBITS                      108      CHARACTER(1) IN INFDS_DB
FILEPOSBITS                      109      CHARACTER(1) IN INFDS_DSPF
FILEPOSBITS                      110      CHARACTER(1) IN INFDS_PRTF
FILETYPE                         20       SMALL INTEGER PRECISION(4,0) IN INFDS
FILETYPE                         108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
FILETYPE                         109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
FILETYPE                         110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
FILLSFL                          688      RPG PROCEDURE
FINALPOS                         196      NUMERIC(10,0)
                                          448
FIRSTRRNONSCREEN                 34       SMALL INTEGER PRECISION(4,0) IN INFDS
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    28
                                               CROSS REFERENCE
FIRSTRRNONSCREEN                 108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
FIRSTRRNONSCREEN                 109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
FIRSTRRNONSCREEN                 110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
FOOTTEXT                         8        CHARACTER(50)
FUNCKEY                          32       CHARACTER(1) IN INFDS
FUNCKEY                          108      CHARACTER(1) IN INFDS_DB
FUNCKEY                          109      CHARACTER(1) IN INFDS_DSPF
FUNCKEY                          110      CHARACTER(1) IN INFDS_PRTF
GETTOTALRECORDS                  771      RPG PROCEDURE
HELP                             116      CHARACTER(1) CCSID 65535 CONSTANT
INDERRORS                        163      CHARACTER(20) IN DISPLAYINDICATORS
INFDS                            14       STRUCTURE
INFDS_DB                         108      STRUCTURE
INFDS_DSPF                       109      STRUCTURE
INFDS_PRTF                       110      STRUCTURE
INITIALPOS                       195      NUMERIC(10,0)
                                          447
INITPOSITION                     384      NUMERIC(2,0) IN RPG PROCEDURE CENTER
INSERTSCREEN                     844      RPG PROCEDURE
INVITESTATUS                     71       CHARACTER(1) IN INFDS
INVITESTATUS                     108      CHARACTER(1) IN INFDS_DB
INVITESTATUS                     109      CHARACTER(1) IN INFDS_DSPF
INVITESTATUS                     110      CHARACTER(1) IN INFDS_PRTF
IORCDLEN                         95       INTEGER PRECISION(9,0) IN INFDS
IORCDLEN                         108      INTEGER PRECISION(9,0) IN INFDS_DB
IORCDLEN                         109      INTEGER PRECISION(9,0) IN INFDS_DSPF
IORCDLEN                         110      INTEGER PRECISION(9,0) IN INFDS_PRTF
KEYBOARDTYPE                     77       CHARACTER(1) IN INFDS
KEYBOARDTYPE                     108      CHARACTER(1) IN INFDS_DB
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    29
                                               CROSS REFERENCE
KEYBOARDTYPE                     109      CHARACTER(1) IN INFDS_DSPF
KEYBOARDTYPE                     110      CHARACTER(1) IN INFDS_PRTF
KEYLEN                           23       SMALL INTEGER PRECISION(4,0) IN INFDS
KEYLEN                           108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
KEYLEN                           109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
KEYLEN                           110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
KEYLENGTH                        104      SMALL INTEGER PRECISION(4,0) IN INFDS
KEYLENGTH                        108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
KEYLENGTH                        109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
KEYLENGTH                        110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
LASTRRN                          695      NUMERIC(10,0) IN RPG PROCEDURE FILLSFL
LENBLANKS                        383      NUMERIC(2,0) IN RPG PROCEDURE CENTER
LIB                              21       CHARACTER(10) IN INFDS
LIB                              108      CHARACTER(10) IN INFDS_DB
LIB                              109      CHARACTER(10) IN INFDS_DSPF
LIB                              110      CHARACTER(10) IN INFDS_PRTF
LISTINGLINE                      17       CHARACTER(8) IN INFDS
LISTINGLINE                      108      CHARACTER(8) IN INFDS_DB
LISTINGLINE                      109      CHARACTER(8) IN INFDS_DSPF
LISTINGLINE                      110      CHARACTER(8) IN INFDS_PRTF
LOADDATATODS                     1128     RPG PROCEDURE
LOADDATATOSCREEN                 1106     RPG PROCEDURE
MAINLINE                         223      RPG PROCEDURE
MAXRCDSINBLOCK                   65       SMALL INTEGER PRECISION(4,0) IN INFDS
MAXRCDSINBLOCK                   108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
MAXRCDSINBLOCK                   109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
MAXRCDSINBLOCK                   110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
MBR                              24       CHARACTER(10) IN INFDS
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    30
                                               CROSS REFERENCE
MBR                              108      CHARACTER(10) IN INFDS_DB
MBR                              109      CHARACTER(10) IN INFDS_DSPF
MBR                              110      CHARACTER(10) IN INFDS_PRTF
MEMBERNUMBER                     105      SMALL INTEGER PRECISION(4,0) IN INFDS
MEMBERNUMBER                     108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
MEMBERNUMBER                     109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
MEMBERNUMBER                     110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
MISCFLAGS1                       80       CHARACTER(1) IN INFDS
MISCFLAGS1                       108      CHARACTER(1) IN INFDS_DB
MISCFLAGS1                       109      CHARACTER(1) IN INFDS_DSPF
MISCFLAGS1                       110      CHARACTER(1) IN INFDS_PRTF
MISCFLAGS2                       83       CHARACTER(1) IN INFDS
MISCFLAGS2                       108      CHARACTER(1) IN INFDS_DB
MISCFLAGS2                       109      CHARACTER(1) IN INFDS_DSPF
MISCFLAGS2                       110      CHARACTER(1) IN INFDS_PRTF
MISCFLAGS3                       86       CHARACTER(1) IN INFDS
MISCFLAGS3                       108      CHARACTER(1) IN INFDS_DB
MISCFLAGS3                       109      CHARACTER(1) IN INFDS_DSPF
MISCFLAGS3                       110      CHARACTER(1) IN INFDS_PRTF
MODIFYSCREEN                     910      RPG PROCEDURE
MSGID                            46       CHARACTER(7) IN INFDS
MSGID                            108      CHARACTER(7) IN INFDS_DB
MSGID                            109      CHARACTER(7) IN INFDS_DSPF
MSGID                            110      CHARACTER(7) IN INFDS_PRTF
NAME                             189      VARCHAR(10) IN DS_DATACRUD
NAME                             444      VARCHAR(10) CCSID 37 COLUMN (NOT NULL) IN CRUD01TBL
                                 ****     VARCHAR(10) COLUMN (NOT NULL) IN TBL
NAME                             ****     COLUMN
                                          945
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    31
                                               CROSS REFERENCE
NAMETASK                         182      CHARACTER(20) IN DS_TASKDATA
NAMETASK                         8        CHARACTER(10)
                                          945
NBRLOCKEDRCDS                    100      SMALL INTEGER PRECISION(4,0) IN INFDS
NBRLOCKEDRCDS                    108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NBRLOCKEDRCDS                    109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NBRLOCKEDRCDS                    110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NBROFCOL                         59       SMALL INTEGER PRECISION(4,0) IN INFDS
NBROFCOL                         108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NBROFCOL                         109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NBROFCOL                         110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NBROFROWS                        58       SMALL INTEGER PRECISION(4,0) IN INFDS
NBROFROWS                        108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NBROFROWS                        109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NBROFROWS                        110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NBRRCDS                          60       INTEGER PRECISION(9,0) IN INFDS
NBRRCDS                          108      INTEGER PRECISION(9,0) IN INFDS_DB
NBRRCDS                          109      INTEGER PRECISION(9,0) IN INFDS_DSPF
NBRRCDS                          110      INTEGER PRECISION(9,0) IN INFDS_PRTF
NODATA_ON_SQL                    176      CHARACTER(2) CONSTANT
NUM_DEVS                         87       SMALL INTEGER PRECISION(4,0) IN INFDS
NUM_DEVS                         108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUM_DEVS                         109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUM_DEVS                         110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NUMBASEDMBRS                     82       SMALL INTEGER PRECISION(4,0) IN INFDS
NUMBASEDMBRS                     108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUMBASEDMBRS                     109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUMBASEDMBRS                     110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NUMBEROFCOLS                     57       SMALL INTEGER PRECISION(4,0) IN INFDS
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    32
                                               CROSS REFERENCE
NUMBEROFCOLS                     108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUMBEROFCOLS                     109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUMBEROFCOLS                     110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NUMBEROFROWS                     56       SMALL INTEGER PRECISION(4,0) IN INFDS
NUMBEROFROWS                     108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUMBEROFROWS                     109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUMBEROFROWS                     110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NUMKEYS                          103      SMALL INTEGER PRECISION(4,0) IN INFDS
NUMKEYS                          108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUMKEYS                          109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUMKEYS                          110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
ODPTYPE                          47       CHARACTER(2) IN INFDS
ODPTYPE                          108      CHARACTER(2) IN INFDS_DB
ODPTYPE                          109      CHARACTER(2) IN INFDS_DSPF
ODPTYPE                          110      CHARACTER(2) IN INFDS_PRTF
OEPCOUNT                         81       SMALL INTEGER PRECISION(4,0) IN INFDS
OEPCOUNT                         108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
OEPCOUNT                         109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
OEPCOUNT                         110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
ONLINEOFFLINE                    74       CHARACTER(1) IN INFDS
ONLINEOFFLINE                    108      CHARACTER(1) IN INFDS_DB
ONLINEOFFLINE                    109      CHARACTER(1) IN INFDS_DSPF
ONLINEOFFLINE                    110      CHARACTER(1) IN INFDS_PRTF
OPCTASK                          8        CHARACTER(1)
OPENID                           84       CHARACTER(2) IN INFDS
OPENID                           108      CHARACTER(2) IN INFDS_DB
OPENID                           109      CHARACTER(2) IN INFDS_DSPF
OPENID                           110      CHARACTER(2) IN INFDS_PRTF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    33
                                               CROSS REFERENCE
OTHERIOCOUNT                     91       INTEGER PRECISION(9,0) IN INFDS
OTHERIOCOUNT                     108      INTEGER PRECISION(9,0) IN INFDS_DB
OTHERIOCOUNT                     109      INTEGER PRECISION(9,0) IN INFDS_DSPF
OTHERIOCOUNT                     110      INTEGER PRECISION(9,0) IN INFDS_PRTF
OVERFLOW                         42       SMALL INTEGER PRECISION(4,0) IN INFDS
OVERFLOW                         108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
OVERFLOW                         109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
OVERFLOW                         110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
OWNER                            189      VARCHAR(10) IN DS_DATACRUD
OWNER                            444      VARCHAR(10) CCSID 37 COLUMN (NOT NULL) IN CRUD01TBL
                                 ****     VARCHAR(10) COLUMN (NOT NULL) IN TBL
OWNER                            ****     COLUMN
                                          951
P_CHOICE                         249      CHARACTER(1) IN RPG PROCEDURE WRITESCREEN
P_CHOICE                         304      CHARACTER(1) IN RPG PROCEDURE SHOWSCREEN
P_CHOICE                         333      CHARACTER(1) IN RPG PROCEDURE SHOWWDW
P_CHOICE                         406      CHARACTER(1) IN RPG PROCEDURE SHOWSUBFILE
P_CHOICE                         552      CHARACTER(1) IN RPG PROCEDURE SCREENVALIDATION
P_CHOICE                         815      CHARACTER(1) IN RPG PROCEDURE EXECUTECRUDSCREEN
P_CHOICE                         846      CHARACTER(1) IN RPG PROCEDURE INSERTSCREEN
P_CHOICE                         912      CHARACTER(1) IN RPG PROCEDURE MODIFYSCREEN
P_CHOICE                         994      CHARACTER(1) IN RPG PROCEDURE DELETESCREEN
P_CHOICE                         1068     CHARACTER(1) IN RPG PROCEDURE VIEWSCREEN
PAGEDOWN                         118      CHARACTER(1) CCSID 65535 CONSTANT
PAGESIZE                         41       SMALL INTEGER PRECISION(4,0) IN INFDS
PAGESIZE                         108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
PAGESIZE                         109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
PAGESIZE                         110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
PAGEUP                           117      CHARACTER(1) CCSID 65535 CONSTANT
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    34
                                               CROSS REFERENCE
PAR_LENGTH                       379      NUMERIC(2,0) IN RPG PROCEDURE CENTER
PAR_SQLCUSTOMIZED                690      CHARACTER(500) IN RPG PROCEDURE FILLSFL
                                          708
PAR_TEXT                         378      CHARACTER(80) IN RPG PROCEDURE CENTER
PERPAGE                          207      SMALL INTEGER PRECISION(4,0) CONSTANT
PFKEY01                          121      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY02                          122      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY03                          123      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY04                          124      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY05                          125      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY06                          126      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY07                          127      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY08                          128      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY09                          129      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY10                          130      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY11                          131      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY12                          132      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY13                          133      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY14                          134      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY15                          135      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY16                          136      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY17                          137      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY18                          138      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY19                          139      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY20                          140      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY21                          141      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY22                          142      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY23                          143      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY24                          144      CHARACTER(1) CCSID 65535 CONSTANT
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    35
                                               CROSS REFERENCE
PGMDEVICE                        96       CHARACTER(10) IN INFDS
PGMDEVICE                        108      CHARACTER(10) IN INFDS_DB
PGMDEVICE                        109      CHARACTER(10) IN INFDS_DSPF
PGMDEVICE                        110      CHARACTER(10) IN INFDS_PRTF
PGMDEVNAME                       94       CHARACTER(10) IN INFDS
PGMDEVNAME                       108      CHARACTER(10) IN INFDS_DB
PGMDEVNAME                       109      CHARACTER(10) IN INFDS_DSPF
PGMDEVNAME                       110      CHARACTER(10) IN INFDS_PRTF
PREVFINALPOS                     200      NUMERIC(10,0)
PREVINITIALPOS                   199      NUMERIC(10,0)
PRINT                            119      CHARACTER(1) CCSID 65535 CONSTANT
PRINTCURRENTLINE                 39       SMALL INTEGER PRECISION(4,0) IN INFDS
PRINTCURRENTLINE                 108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
PRINTCURRENTLINE                 109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
PRINTCURRENTLINE                 110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
PRINTOVERFLOW                    38       SMALL INTEGER PRECISION(4,0) IN INFDS
PRINTOVERFLOW                    108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
PRINTOVERFLOW                    109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
PRINTOVERFLOW                    110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
PRINTPAGESIZE                    37       SMALL INTEGER PRECISION(4,0) IN INFDS
PRINTPAGESIZE                    108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
PRINTPAGESIZE                    109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
PRINTPAGESIZE                    110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
PROTECTFIELDS_35                 161      CHARACTER(1) IN DISPLAYINDICATORS
PROTECTFIELDS_36                 162      CHARACTER(1) IN DISPLAYINDICATORS
PSQLSTATE                        167
PTRDISPLAYINDICATORS             149
QRY                              ****     STATEMENT
                                          786 789
QRYC                             789      CURSOR FOR QRY
                                          792 795 798
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    36
                                               CROSS REFERENCE
RCDDELETEDBITS                   102      CHARACTER(1) IN INFDS
RCDDELETEDBITS                   108      CHARACTER(1) IN INFDS_DB
RCDDELETEDBITS                   109      CHARACTER(1) IN INFDS_DSPF
RCDDELETEDBITS                   110      CHARACTER(1) IN INFDS_PRTF
RCDFMT                           28       CHARACTER(10) IN INFDS
RCDFMT                           108      CHARACTER(10) IN INFDS_DB
RCDFMT                           109      CHARACTER(10) IN INFDS_DSPF
RCDFMT                           110      CHARACTER(10) IN INFDS_PRTF
RCDFMTLEN                        85       SMALL INTEGER PRECISION(4,0) IN INFDS
RCDFMTLEN                        108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
RCDFMTLEN                        109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
RCDFMTLEN                        110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
RCDLEN                           22       SMALL INTEGER PRECISION(4,0) IN INFDS
RCDLEN                           108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
RCDLEN                           109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
RCDLEN                           110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
RCDSREADSINCEOPEN                25       INTEGER PRECISION(9,0) IN INFDS
RCDSREADSINCEOPEN                108      INTEGER PRECISION(9,0) IN INFDS_DB
RCDSREADSINCEOPEN                109      INTEGER PRECISION(9,0) IN INFDS_DSPF
RCDSREADSINCEOPEN                110      INTEGER PRECISION(9,0) IN INFDS_PRTF
READCOUNT                        89       INTEGER PRECISION(9,0) IN INFDS
READCOUNT                        108      INTEGER PRECISION(9,0) IN INFDS_DB
READCOUNT                        109      INTEGER PRECISION(9,0) IN INFDS_DSPF
READCOUNT                        110      INTEGER PRECISION(9,0) IN INFDS_PRTF
RECORDBACKSPAC                   120      CHARACTER(1) CCSID 65535 CONSTANT
REQUESTER                        69       CHARACTER(1) IN INFDS
REQUESTER                        108      CHARACTER(1) IN INFDS_DB
REQUESTER                        109      CHARACTER(1) IN INFDS_DSPF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    37
                                               CROSS REFERENCE
REQUESTER                        110      CHARACTER(1) IN INFDS_PRTF
RNUM                             ****     COLUMN
                                          443 447
                                 ****     BIG INTEGER PRECISION(0,0) COLUMN (NOT NULL) IN TBL
ROWCOLUMN                        33       SMALL INTEGER PRECISION(4,0) IN INFDS
ROWCOLUMN                        108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
ROWCOLUMN                        109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
ROWCOLUMN                        110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
RRN                              30       INTEGER PRECISION(9,0) IN INFDS
RRN                              108      INTEGER PRECISION(9,0) IN INFDS_DB
RRN                              109      INTEGER PRECISION(9,0) IN INFDS_DSPF
RRN                              110      INTEGER PRECISION(9,0) IN INFDS_PRTF
RRNLASTREAD                      27       INTEGER PRECISION(9,0) IN INFDS
RRNLASTREAD                      108      INTEGER PRECISION(9,0) IN INFDS_DB
RRNLASTREAD                      109      INTEGER PRECISION(9,0) IN INFDS_DSPF
RRNLASTREAD                      110      INTEGER PRECISION(9,0) IN INFDS_PRTF
SCREENVALIDATION                 550      RPG PROCEDURE
SFLCLR                           154      CHARACTER(1) IN DISPLAYINDICATORS
SFLDSP                           152      CHARACTER(1) IN DISPLAYINDICATORS
SFLDSPCTL                        153      CHARACTER(1) IN DISPLAYINDICATORS
SFLEND                           155      CHARACTER(1) IN DISPLAYINDICATORS
SFLENDDATE                       8        DECIMAL(8,0)
SFLINITIAL                       644      RPG PROCEDURE
SFLMINRRN                        53       SMALL INTEGER PRECISION(4,0) IN INFDS
SFLMINRRN                        108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
SFLMINRRN                        109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SFLMINRRN                        110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SFLNUMRCDS                       54       SMALL INTEGER PRECISION(4,0) IN INFDS
SFLNUMRCDS                       108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    38
                                               CROSS REFERENCE
SFLNUMRCDS                       109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SFLNUMRCDS                       110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SFLRCDNBR                        29       SMALL INTEGER PRECISION(4,0) IN INFDS
SFLRCDNBR                        108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
SFLRCDNBR                        109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SFLRCDNBR                        110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SFLRRN                           52       SMALL INTEGER PRECISION(4,0) IN INFDS
SFLRRN                           108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
SFLRRN                           109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SFLRRN                           110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SFLSTATE                         8        DECIMAL(2,0)
SFLSTRDATE                       8        DECIMAL(8,0)
SFLTASKID                        8        DECIMAL(10,0)
                                          493 505 517
SFLTASKNAM                       8        CHARACTER(10)
SHOWSCREEN                       302      RPG PROCEDURE
SHOWSUBFILE                      404      RPG PROCEDURE
SHOWWDW                          331      RPG PROCEDURE
SOLUTION                         8        CHARACTER(150)
                                          947
SPLF                             48       CHARACTER(10) IN INFDS
SPLF                             108      CHARACTER(10) IN INFDS_DB
SPLF                             109      CHARACTER(10) IN INFDS_DSPF
SPLF                             110      CHARACTER(10) IN INFDS_PRTF
SPLFLIB                          49       CHARACTER(10) IN INFDS
SPLFLIB                          108      CHARACTER(10) IN INFDS_DB
SPLFLIB                          109      CHARACTER(10) IN INFDS_DSPF
SPLFLIB                          110      CHARACTER(10) IN INFDS_PRTF
SPLFNUMBER                       50       SMALL INTEGER PRECISION(4,0) IN INFDS
SPLFNUMBER                       108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    39
                                               CROSS REFERENCE
SPLFNUMBER                       109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SPLFNUMBER                       110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SQLCUSTOMIZED                    625      CHARACTER(500) IN RPG PROCEDURE SUBFILESTART
SQLCUSTOMIZED                    777      CHARACTER(500) IN RPG PROCEDURE GETTOTALRECORDS
                                          786
SRCFILE                          63       CHARACTER(1) IN INFDS
SRCFILE                          108      CHARACTER(1) IN INFDS_DB
SRCFILE                          109      CHARACTER(1) IN INFDS_DSPF
SRCFILE                          110      CHARACTER(1) IN INFDS_PRTF
START_DATE                       183      NUMERIC(8,0) IN DS_TASKDATA
STARTDATE                        189      NUMERIC(8,0) IN DS_DATACRUD
STARTDATE                        8        DECIMAL(8,0)
                                          948
STARTDATE                        444      NUMERIC(8,0) COLUMN (NOT NULL) IN CRUD01TBL
                                 ****     NUMERIC(8,0) COLUMN (NOT NULL) IN TBL
STARTDATE                        ****     COLUMN
                                          948
STARTDATEERROR_32                158      CHARACTER(1) IN DISPLAYINDICATORS
STATE                            189      NUMERIC(1,0) IN DS_DATACRUD
STATE                            444      NUMERIC(1,0) COLUMN (NOT NULL) IN CRUD01TBL
                                 ****     NUMERIC(1,0) COLUMN (NOT NULL) IN TBL
STATE                            ****     COLUMN
                                          950
STATETASK                        8        DECIMAL(1,0)
                                          950
SUBFILESTART                     620      RPG PROCEDURE
SUCCESS_ON_SQL                   174      CHARACTER(2) CONSTANT
TASK_CURSOR                      711      CURSOR FOR YOURQUERY
                                          714 717 728 738
TASK_ID                          189      NUMERIC(10,0) IN DS_DATACRUD
TASK_ID                          444      NUMERIC(10,0) COLUMN (NOT NULL) IN CRUD01TBL
                                 ****     NUMERIC(10,0) COLUMN (NOT NULL) IN TBL
TASK_ID                          ****     COLUMN
                                          493 505 517 570 952 1028
TASKID                           181      NUMERIC(10,0) IN DS_TASKDATA
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    40
                                               CROSS REFERENCE
TASKIDEXISTERROR_31              157      CHARACTER(1) IN DISPLAYINDICATORS
TASKRRN                          192      NUMERIC(3,0)
TASKSTATE                        185      NUMERIC(1,0) IN DS_TASKDATA
                                 ****
TITLE1                           8        CHARACTER(50)
TITLE2                           8        CHARACTER(50)
TITLE3                           8        CHARACTER(50)
TOTALSFLROWS                     35       SMALL INTEGER PRECISION(4,0) IN INFDS
TOTALSFLROWS                     108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
TOTALSFLROWS                     109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
TOTALSFLROWS                     110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
TURNOFFERRORS                    604      RPG PROCEDURE
USER                             98       CHARACTER(10) IN INFDS
USER                             108      CHARACTER(10) IN INFDS_DB
USER                             109      CHARACTER(10) IN INFDS_DSPF
USER                             110      CHARACTER(10) IN INFDS_PRTF
VIEWSCREEN                       1066     RPG PROCEDURE
VOLUMELAVELOFFSET                64       SMALL INTEGER PRECISION(4,0) IN INFDS
VOLUMELAVELOFFSET                108      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
VOLUMELAVELOFFSET                109      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
VOLUMELAVELOFFSET                110      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
W_CRUDFINALIZE                   210      CHARACTER(1)
W_EXIST                          409      CHARACTER(1) IN RPG PROCEDURE SHOWSUBFILE
                                          439
W_EXISTS                         556      CHARACTER(1) IN RPG PROCEDURE SCREENVALIDATION
                                          568
W_TOTAL                          775      NUMERIC(10,0) IN RPG PROCEDURE GETTOTALRECORDS
                                          795
W_VALIDISNOTOK                   555      CHARACTER(1) IN RPG PROCEDURE SCREENVALIDATION
W_WHERESFL                       203      CHARACTER(500)
WARNING_ON_SQL                   175      CHARACTER(2) CONSTANT
WDWCHOICE                        8        CHARACTER(1)
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   25-05-09 08:21:10          Page    41
                                               CROSS REFERENCE
WDWMSG1                          8        CHARACTER(40)
WDWMSG2                          8        CHARACTER(40)
WDWTEXT1                         8        CHARACTER(40)
WDWTEXT2                         8        CHARACTER(40)
WRITECOUNT                       88       INTEGER PRECISION(9,0) IN INFDS
WRITECOUNT                       108      INTEGER PRECISION(9,0) IN INFDS_DB
WRITECOUNT                       109      INTEGER PRECISION(9,0) IN INFDS_DSPF
WRITECOUNT                       110      INTEGER PRECISION(9,0) IN INFDS_PRTF
WRITEREADCOUNT                   90       INTEGER PRECISION(9,0) IN INFDS
WRITEREADCOUNT                   108      INTEGER PRECISION(9,0) IN INFDS_DB
WRITEREADCOUNT                   109      INTEGER PRECISION(9,0) IN INFDS_DSPF
WRITEREADCOUNT                   110      INTEGER PRECISION(9,0) IN INFDS_PRTF
WRITESCREEN                      247      RPG PROCEDURE
XSQLSTATE                        170      CHARACTER(2) IN DS_SQLSTATE
YOURQUERY                        ****     STATEMENT
                                          708 711
No errors found in source
 1138 Source records processed
                               * * * * *  E N D  O F  L I S T I N G  * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      1
  Command  . . . . . . . . . . . . :   CRTRPGMOD
    Issued by  . . . . . . . . . . :     NICKLITTEN
  Module . . . . . . . . . . . . . :   CRUD01RPG
    Library  . . . . . . . . . . . :     NLITTEN1
  Text 'description' . . . . . . . :   Change Read Update Delete Example
  Source stream file   . . . . . . :   /QSYS.LIB/QTEMP.LIB/QSQLTEMP1.FILE/CRUD01RPG.MBR
    CCSID  . . . . . . . . . . . . :     37
  Target CCSID . . . . . . . . . . :   *JOB (37)
  Text 'description' . . . . . . . :
  Last Change  . . . . . . . . . . :   25-05-09  08:21:10
  Generation severity level  . . . :   10
  Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                       *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                       *DEBUGIO   *UNREF     *EVENTF
  Debugging views  . . . . . . . . :   *ALL
  Debug encryption key . . . . . . :   *NONE
  Output . . . . . . . . . . . . . :   *PRINT
  Optimization level . . . . . . . :   *NONE
  Source listing indentation . . . :   *NONE
  Type conversion options  . . . . :   *NONE
  Sort sequence  . . . . . . . . . :   *JOB
  Language identifier  . . . . . . :   *JOB
  Replace module . . . . . . . . . :   *YES
  Authority  . . . . . . . . . . . :   *LIBCRTAUT
  Truncate numeric . . . . . . . . :   *YES
  Fix numeric  . . . . . . . . . . :   *NONE
  Target release . . . . . . . . . :   V7R4M0
  Allow null values  . . . . . . . :   *NO
  Storage model . . .  . . . . . . :   *INHERIT
  Binding directory  . . . . . . . :   *NONE
  Define condition names . . . . . :   *NONE
  Enable performance collection  . :   *PEP
  Profiling data . . . . . . . . . :   *NOCOL
  Licensed Internal Code options . :
  Generate program interface . . . :   *NO
  Include directory  . . . . . . . :   includes
  Preprocessor options . . . . . . :   *NONE
  Require prototype for export . . :   *NO
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      2
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
                          S o u r c e   L i s t i n g
     1 **free                                                                                                               000001
     2                                                                                                                      000002
     3 // --------------------------------------------------------------------------                                        000003
     4 // *** WORK IN PROGRESS _ NOT FINISHED YET ***                                                                       000004
     5 // --------------------------------------------------------------------------                                        000005
     6 ctl-opt main(mainline) copyright('| CRUD01RPG 2025.04.11');                                                          000006
     7                                                                                                                      000007
     8 dcl-f CRUD01PNL workstn sfile(SFLTASK:taskrrn) usropn infds(infds);                                                  000008
        *--------------------------------------------------------------------------------------------*
        *                               RPG name         External name                               *
        * File name. . . . . . . . . :  CRUD01PNL        NLITTEN1/CRUD01PNL                          *
        * Record format(s) . . . . . :  HEADER           HEADER                                      *
        *                               FOOTER           FOOTER                                      *
        *                               SFLTASK          SFLTASK                                     *
        *                               SFLTASKCTL       SFLTASKCTL                                  *
        *                               CRUDTASK         CRUDTASK                                    *
        *                               EMPTY            EMPTY                                       *
        *                               WDWCONFIRM       WDWCONFIRM                                  *
        *                               WDWMESSAGE       WDWMESSAGE                                  *
        *--------------------------------------------------------------------------------------------*
     9                                                                                                                      000009
    10 // /include 'information_data_structures.rpgleinc'                                                                   000010
    11 **END-FREE                                                                                                           000011
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    12 **FREE                                                                                                               000012
    13                                                                                                                      000013
    14 Dcl-Ds infds qualified;                                                                                              000014
    15   FileOpen ind pos(9); // File Open Indicator?                                                                       000015
    16   FileEOF ind pos(10); // File at End of File?                                                                       000016
    17   ListingLine char(8) pos(30);                                                                                       000017
    18   // --SpecialStatus zoned(5) pos(38);                                                                               000018
    19   File char(10) pos(83);                                                                                             000019
    20   fileType int(5) pos(147);                                                                                          000020
    21   Lib char(10) pos(93);                                                                                              000021
    22   RcdLen int(5) pos(125);                                                                                            000022
    23   keyLen int(5) pos(127); // Max key len                                                                             000023
    24   Mbr char(10) pos(129);                                                                                             000024
    25   RcdsReadSinceOpen int(10) pos(156); // number of records retrieved since open                                      000025
    26   Ccsid int(5) pos(218);                                                                                             000026
    27   RRNlastRead int(10) pos(247); // relative record number of last record processed                                   000027
    28   Rcdfmt char(10) pos(261);                                                                                          000028
    29   SflRcdNbr int(5) pos(378);                                                                                         000029
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      3
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    30   RRN int(10) pos(397);                                                                                              000030
    31   // DSPF BITs                                                                                                       000031
    32   funcKey char(1) pos(369); // DS@AID for nice "funckey = PageDown" type syntax                                      000032
    33   RowColumn int(5) pos(370); // DS@POS - cursor row & column                                                         000033
    34   firstRrnOnScreen int(5) pos(378); // DS@TOP SFL RRN Top of scrn                                                    000034
    35   totalSflRows int(5) pos(380); // DS@TOT records in subfile                                                         000035
    36   // PRTF BITs                                                                                                       000036
    37   printPageSize int(5) pos(152); // PR@SIZ page size                                                                 000037
    38   printOverflow int(5) pos(188); // PR@FLW printer file overflow                                                     000038
    39   printCurrentLine int(5) pos(367); // PR@CLN current line number                                                    000039
    40   // *PRTF Stuff:                                                                                                    000040
    41   PageSize int(5) pos(152); // PR@SIZ page size                                                                      000041
    42   Overflow int(5) pos(188); // PR@FLW printer file overflow                                                          000042
    43   CurrentLine int(5) pos(367); // PR@CLN current line number                                                         000043
    44   CurrentPage int(10) pos(369);                                                                                      000044
    45   // Error MSGID -- available after POST                                                                             000045
    46   MsgID char(7) pos(46);                                                                                             000046
    47   ODPtype char(2) pos(81); // ODP Type                                                                               000047
    48   splf char(10) pos(103);                                                                                            000048
    49   splfLib char(10) pos(113);                                                                                         000049
    50   splfNumber int(5) pos(123);                                                                                        000050
    51   // *DSPF Stuff:                                                                                                    000051
    52   SflRRN int(5) pos(376);                                                                                            000052
    53   SflMinRRN int(5) pos(378);                                                                                         000053
    54   SflNumRcds int(5) pos(380);                                                                                        000054
    55   ActualCursor char(2) pos(382);                                                                                     000055
    56   NumberOfRows int(5) pos(282);                                                                                      000056
    57   NumberOfCols int(5) pos(284);                                                                                      000057
    58   nbrOfRows int(5) pos(152);                                                                                         000058
    59   nbrOfCol int(5) pos(154);                                                                                          000059
    60   nbrRcds int(10) pos(156);                                                                                          000060
    61   accessType char(2) pos(160);                                                                                       000061
    62   DupKey char(1) pos(162);                                                                                           000062
    63   srcFile char(1) pos(163);                                                                                          000063
    64   VolumeLavelOffset int(5) pos(184);                                                                                 000064
    65   MaxRcdsInBlock int(5) pos(186);                                                                                    000065
    66   BlockIncrement int(5) pos(190);                                                                                    000066
    67   deviceClass char(1) pos(271);                                                                                      000067
    68   deviceType char(6) pos(272);                                                                                       000068
    69   Requester char(1) pos(278);                                                                                        000069
    70   AcquireStatus char(1) pos(279);                                                                                    000070
    71   InviteStatus char(1) pos(280);                                                                                     000071
    72   DataAvailable char(1) pos(281);                                                                                    000072
    73   AllowBlink char(1) pos(286);                                                                                       000073
    74   OnlineOffline char(1) pos(287);                                                                                    000074
    75   DisplayLocation char(1) pos(288);                                                                                  000075
    76   DisplayType char(1) pos(289);                                                                                      000076
    77   KeyboardType char(1) pos(290);                                                                                     000077
    78   ControllerInfo char(1) pos(342);                                                                                   000078
    79   ColorCapable char(1) pos(343);                                                                                     000079
    80   MiscFlags1 char(1) pos(196);                                                                                       000080
    81   OepCount int(5) pos(207);                                                                                          000081
    82   NumBasedMbrs int(5) pos(211);                                                                                      000082
    83   MiscFlags2 char(1) pos(213);                                                                                       000083
    84   OpenID char(2) pos(214);                                                                                           000084
    85   RcdFmtLen int(5) pos(216);                                                                                         000085
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      4
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    86   MiscFlags3 char(1) pos(220);                                                                                       000086
    87   NUM_DEVS int(5) pos(227);                                                                                          000087
    88   writeCount int(10) pos(243);                                                                                       000088
    89   readCount int(10) pos(247);                                                                                        000089
    90   writeReadCount int(10) pos(251);                                                                                   000090
    91   otherIOCount int(10) pos(255);                                                                                     000091
    92   currentOperations char(1) pos(260);                                                                                000092
    93   DevClass char(2) pos(271);                                                                                         000093
    94   PgmDevName char(10) pos(273);                                                                                      000094
    95   IOrcdLen int(10) pos(283);                                                                                         000095
    96   PgmDevice char(10) pos(241);                                                                                       000096
    97   DeviceDesc char(10) pos(251);                                                                                      000097
    98   user char(10) pos(261);                                                                                            000098
    99   // Disk :                                                                                                          000099
   100   NbrLockedRcds int(5) pos(377);                                                                                     000100
   101   FilePosBits char(1) pos(385);                                                                                      000101
   102   RcdDeletedBits char(1) pos(384);                                                                                   000102
   103   Numkeys int(5) pos(387);                                                                                           000103
   104   Keylength int(5) pos(393);                                                                                         000104
   105   MemberNumber int(5) pos(395);                                                                                      000105
   106 end-ds;                                                                                                              000106
   107                                                                                                                      000107
   108 Dcl-Ds infds_DB likeds(infds);                                                                                       000108
   109 Dcl-Ds infds_DSPF likeds(infds);                                                                                     000109
   110 Dcl-Ds infds_PRTF likeds(infds);                                                                                     000110
   111                                                                                                                      000111
   112 // Hexadecimal representation of function Keys                                                                       000112
   113 // If you use an INFDS against your display file you can check functions by                                          000113
   114 // using : IF infs.funcKey = PFKEY03;                                                                                000114
   115 Dcl-C ENTER CONST(X'F1');                                                                                            000115
   116 Dcl-C HELP CONST(X'F3');                                                                                             000116
   117 Dcl-C PAGEUP CONST(X'F4');                                                                                           000117
   118 Dcl-C PAGEDOWN CONST(X'F5');                                                                                         000118
   119 Dcl-C PRINT CONST(X'F6');                                                                                            000119
   120 Dcl-C RECORDBACKSPAC CONST(X'F8');                                                                                   000120
   121 Dcl-C PFKEY01 CONST(X'31');                                                                                          000121
   122 Dcl-C PFKEY02 CONST(X'32');                                                                                          000122
   123 Dcl-C PFKEY03 CONST(X'33');                                                                                          000123
   124 Dcl-C PFKEY04 CONST(X'34');                                                                                          000124
   125 Dcl-C PFKEY05 CONST(X'35');                                                                                          000125
   126 Dcl-C PFKEY06 CONST(X'36');                                                                                          000126
   127 Dcl-C PFKEY07 CONST(X'37');                                                                                          000127
   128 Dcl-C PFKEY08 CONST(X'38');                                                                                          000128
   129 Dcl-C PFKEY09 CONST(X'39');                                                                                          000129
   130 Dcl-C PFKEY10 CONST(X'3A');                                                                                          000130
   131 Dcl-C PFKEY11 CONST(X'3B');                                                                                          000131
   132 Dcl-C PFKEY12 CONST(X'3C');                                                                                          000132
   133 Dcl-C PFKEY13 CONST(X'B1');                                                                                          000133
   134 Dcl-C PFKEY14 CONST(X'B2');                                                                                          000134
   135 Dcl-C PFKEY15 CONST(X'B3');                                                                                          000135
   136 Dcl-C PFKEY16 CONST(X'B4');                                                                                          000136
   137 Dcl-C PFKEY17 CONST(X'B5');                                                                                          000137
   138 Dcl-C PFKEY18 CONST(X'B6');                                                                                          000138
   139 Dcl-C PFKEY19 CONST(X'B7');                                                                                          000139
   140 Dcl-C PFKEY20 CONST(X'B8');                                                                                          000140
   141 Dcl-C PFKEY21 CONST(X'B9');                                                                                          000141
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      5
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   142 Dcl-C PFKEY22 CONST(X'BA');                                                                                          000142
   143 Dcl-C PFKEY23 CONST(X'BB');                                                                                          000143
   144 Dcl-C PFKEY24 CONST(X'BC');                                                                                          000144
   145 Dcl-C CLEAR CONST(X'BD');                                                                                            000145
   146                                                                                                                      000146
   147                                                                                                                      000147
   148 // Validation indicators                                                                                             000148
   149 Dcl-S ptrDisplayIndicators Pointer Inz(%Addr(*In));                                                                  000149
   150 Dcl-Ds DisplayIndicators Based(ptrDisplayIndicators);                                                                000150
   151   // Subfile indicators                                                                                              000151
   152   SflDsp          Ind Pos(99);                                                                                       000152
   153   SflDspCtl       Ind Pos(98);                                                                                       000153
   154   SflClr          Ind Pos(97);                                                                                       000154
   155   SflEnd          Ind Pos(96);                                                                                       000155
   156   // Validation Errors                                                                                               000156
   157   Taskidexisterror_31 Ind Pos(31);                                                                                   000157
   158   Startdateerror_32  Ind Pos(32);                                                                                    000158
   159   Enddateerror_33 Ind Pos(33);                                                                                       000159
   160   Dategreaterthanerror_34 Ind Pos(34);                                                                               000160
   161   ProtectFields_35 Ind Pos(35);                                                                                      000161
   162   ProtectFields_36 Ind Pos(36);                                                                                      000162
   163   IndErrors char(20) Pos(31);                                                                                        000163
   164 end-ds;                                                                                                              000164
   165                                                                                                                      000165
   166 // Variable Pointer for SQL Errors                                                                                   000166
   167 Dcl-S pSqlstate Pointer Inz(%Addr(SQLState));                                                                        000167
   168                                                                                                                      000168
   169 Dcl-Ds Ds_SqlState based(pSqlstate);                                                                                 000169
   170   xSqlstate char(2);                                                                                                 000170
   171 end-ds;                                                                                                              000171
   172                                                                                                                      000172
   173 // Constant error on SQL                                                                                             000173
   174 Dcl-C SUCCESS_ON_SQL '00';                                                                                           000174
   175 Dcl-C WARNING_ON_SQL '01';                                                                                           000175
   176 Dcl-C NODATA_ON_SQL  '02';                                                                                           000176
   177                                                                                                                      000177
   178 // Data structure based in the query neccesary for fill the subfile of                                               000178
   179 // the file CRUD01TBL                                                                                                000179
   180 Dcl-Ds Ds_taskdata qualified;                                                                                        000180
   181   Taskid     zoned(10);                                                                                              000181
   182   Nametask    char(20);                                                                                              000182
   183   Start_date zoned(8);                                                                                               000183
   184   End_date   zoned(8);                                                                                               000184
   185   Taskstate  zoned(1);                                                                                               000185
   186 end-ds;                                                                                                              000186
   187                                                                                                                      000187
   188 // Data structure for general use in CRUD operations                                                                 000188
   189 Dcl-Ds Ds_datacrud extname('CRUD01TBL') qualified end-ds;                                                            000189
        *--------------------------------------------------------------------------------------------*                     1
        * Data structure . . . . . . :  DS_DATACRUD                                                  *                     1
        * External format  . . . . . :  CRUD01TBL : NLITTEN1/CRUD01TBL                               *                     1
        *--------------------------------------------------------------------------------------------*                     1
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      6
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   190=D TASK_ID                       10S 0                                      TASK ID                                  1000001
   191=D NAME                          10A   VARYING                              NAME OF THE TASK                         1000002
   192=D DESCR                        150A   VARYING                              DESCRIPTION OF TASK                      1000003
   193=D ENDDES                       150A   VARYING                              END DESCRIPTION OF TASK                  1000004
   194=D STARTDATE                      8S 0                                      DATE OF TASK CREATION                    1000005
   195=D ENDDATE                        8S 0                                      DATE OF TASK FINALIZATION                1000006
   196=D STATE                          1S 0                                      STATE TASK 0-UNFINISHED 1-FINISHED       1000007
   197=D OWNER                         10A   VARYING                              CREATOR OF THE TASK                      1000008
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   198                                                                                                                      000190
   199 // Relative record number for SFLTASK subfile task                                                                   000191
   200 Dcl-S taskrrn zoned(3:0);                                                                                            000192
   201                                                                                                                      000193
   202 // Variables for subfile scroll position                                                                             000194
   203 Dcl-S Initialpos zoned(10:0) inz(0);                                                                                 000195
   204 Dcl-S Finalpos zoned(10:0) inz(10);                                                                                  000196
   205                                                                                                                      000197
   206 // Previous initial and finalpos for indicates final                                                                 000198
   207 Dcl-S Previnitialpos zoned(10:0);                                                                                    000199
   208 Dcl-S PrevFinalpos zoned(10:0) ;                                                                                     000200
   209                                                                                                                      000201
   210 // Variable for apply filter to subfile query                                                                        000202
   211 Dcl-S w_Wheresfl char(500) inz(*blanks);                                                                             000203
   212                                                                                                                      000204
   213 // Quantity of records per page in subfile change the inz value depend                                               000205
   214 // of your subfile capacity                                                                                          000206
   215 Dcl-C PERPAGE 10;                                                                                                    000207
   216                                                                                                                      000208
   217 // Variable for indicates that crud operations are finalized                                                         000209
   218 Dcl-S w_Crudfinalize Ind;                                                                                            000210
   219                                                                                                                      000211
   220 // Variable with current user                                                                                        000212
   221 Dcl-S CurrentUser char(10) inz(*user);                                                                               000213
   222                                                                                                                      000214
   223                                                                                                                      000215
   224                                                                                                                      000216
   225                                                                                                                      000217
   226                                                                                                                      000218
   227                                                                                                                      000219
   228 // --------------------------------------------------------------------------                                        000220
   229 // This is the mainline process that is executed when the program is called                                          000221
   230 // --------------------------------------------------------------------------                                        000222
   231        /SET CCSID(*CHAR:*JOBRUNMIX)                                                                                  000223
   232        // SQL COMMUNICATION AREA                                                //SQL                                000224
   233        DCL-DS SQLCA;                                                            //SQL                                000225
   234          SQLCAID CHAR(8) INZ(X'0000000000000000');                              //SQL                                000226
   235           SQLAID CHAR(8) OVERLAY(SQLCAID);                                      //SQL                                000227
   236          SQLCABC INT(10);                                                       //SQL                                000228
   237           SQLABC BINDEC(9) OVERLAY(SQLCABC);                                    //SQL                                000229
   238          SQLCODE INT(10);                                                       //SQL                                000230
   239           SQLCOD BINDEC(9) OVERLAY(SQLCODE);                                    //SQL                                000231
   240          SQLERRML INT(5);                                                       //SQL                                000232
   241           SQLERL BINDEC(4) OVERLAY(SQLERRML);                                   //SQL                                000233
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      7
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   242          SQLERRMC CHAR(70);                                                     //SQL                                000234
   243           SQLERM CHAR(70) OVERLAY(SQLERRMC);                                    //SQL                                000235
   244          SQLERRP CHAR(8);                                                       //SQL                                000236
   245           SQLERP CHAR(8) OVERLAY(SQLERRP);                                      //SQL                                000237
   246          SQLERR CHAR(24);                                                       //SQL                                000238
   247           SQLER1 BINDEC(9) OVERLAY(SQLERR:*NEXT);                               //SQL                                000239
   248           SQLER2 BINDEC(9) OVERLAY(SQLERR:*NEXT);                               //SQL                                000240
   249           SQLER3 BINDEC(9) OVERLAY(SQLERR:*NEXT);                               //SQL                                000241
   250           SQLER4 BINDEC(9) OVERLAY(SQLERR:*NEXT);                               //SQL                                000242
   251           SQLER5 BINDEC(9) OVERLAY(SQLERR:*NEXT);                               //SQL                                000243
   252           SQLER6 BINDEC(9) OVERLAY(SQLERR:*NEXT);                               //SQL                                000244
   253           SQLERRD INT(10) DIM(6) OVERLAY(SQLERR);                               //SQL                                000245
   254          SQLWRN CHAR(11);                                                       //SQL                                000246
   255           SQLWN0 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000247
   256           SQLWN1 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000248
   257           SQLWN2 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000249
   258           SQLWN3 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000250
   259           SQLWN4 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000251
   260           SQLWN5 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000252
   261           SQLWN6 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000253
   262           SQLWN7 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000254
   263           SQLWN8 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000255
   264           SQLWN9 CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000256
   265           SQLWNA CHAR(1) OVERLAY(SQLWRN:*NEXT);                                 //SQL                                000257
   266           SQLWARN CHAR(1) DIM(11) OVERLAY(SQLWRN);                              //SQL                                000258
   267          SQLSTATE CHAR(5);                                                      //SQL                                000259
   268           SQLSTT CHAR(5) OVERLAY(SQLSTATE);                                     //SQL                                000260
   269        END-DS SQLCA;                                                            //SQL                                000261
   270        DCL-PR SQLROUTE_CALL EXTPGM(SQLROUTE);                                   //SQL                                000262
   271          CA LIKEDS(SQLCA);                                                      //SQL                                000263
   272          *N BINDEC(4) OPTIONS(*NOPASS);                                         //SQL                                000264
   273          *N CHAR(1) OPTIONS(*NOPASS);                                           //SQL                                000265
   274        END-PR SQLROUTE_CALL;                                                    //SQL                                000266
   275        DCL-PR SQLOPEN_CALL EXTPGM(SQLOPEN);                                     //SQL                                000267
   276          CA LIKEDS(SQLCA);                                                      //SQL                                000268
   277          *N BINDEC(4);                                                          //SQL                                000269
   278        END-PR SQLOPEN_CALL;                                                     //SQL                                000270
   279        DCL-PR SQLCLSE_CALL EXTPGM(SQLCLSE);                                     //SQL                                000271
   280          CA LIKEDS(SQLCA);                                                      //SQL                                000272
   281          *N BINDEC(4);                                                          //SQL                                000273
   282        END-PR SQLCLSE_CALL;                                                     //SQL                                000274
   283        DCL-PR SQLCMIT_CALL EXTPGM(SQLCMIT);                                     //SQL                                000275
   284          CA LIKEDS(SQLCA);                                                      //SQL                                000276
   285          *N BINDEC(4);                                                          //SQL                                000277
   286        END-PR SQLCMIT_CALL;                                                     //SQL                                000278
   287        /RESTORE CCSID(*CHAR)                                                                                         000279
   288        DCL-C SQLROUTE CONST('QSYS/QSQROUTE');                                   //SQL                                000280
   289        DCL-C SQLOPEN CONST('QSYS/QSQROUTE');                                    //SQL                                000281
   290        DCL-C SQLCLSE CONST('QSYS/QSQLCLSE');                                    //SQL                                000282
   291        DCL-C SQLCMIT CONST('QSYS/QSQLCMIT');                                    //SQL                                000283
   292        DCL-C SQFRD CONST(2);                                                    //SQL                                000284
   293        DCL-C SQFCRT CONST(8);                                                   //SQL                                000285
   294        DCL-C SQFOVR CONST(16);                                                  //SQL                                000286
   295        DCL-C SQFAPP CONST(32);                                                  //SQL                                000287
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      8
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   296=IHEADER                                                                                                             2000001
        *--------------------------------------------------------------------------------------------*                     2
        * RPG record format  . . . . :  HEADER                                                       *                     2
        * External format  . . . . . :  HEADER : NLITTEN1/CRUD01PNL                                  *                     2
        *--------------------------------------------------------------------------------------------*                     2
   297=IFOOTER                                                                                                             3000001
        *--------------------------------------------------------------------------------------------*                     3
        * RPG record format  . . . . :  FOOTER                                                       *                     3
        * External format  . . . . . :  FOOTER : NLITTEN1/CRUD01PNL                                  *                     3
        *--------------------------------------------------------------------------------------------*                     3
   298=ISFLTASK                                                                                                            4000001
        *--------------------------------------------------------------------------------------------*                     4
        * RPG record format  . . . . :  SFLTASK                                                      *                     4
        * External format  . . . . . :  SFLTASK : NLITTEN1/CRUD01PNL                                 *                     4
        *--------------------------------------------------------------------------------------------*                     4
   299=I                             A    1    1  OPCTASK                                                                  4000002
   300=I                             S    2   11 0SFLTASKID                                                                4000003
   301=I                             A   12   21  SFLTASKNAM                                                               4000004
   302=I                             S   22   29 0SFLSTRDATE                                                               4000005
   303=I                             S   30   37 0SFLENDDATE                                                               4000006
   304=I                             S   38   39 0SFLSTATE                                                                 4000007
   305=ISFLTASKCTL                                                                                                         5000001
        *--------------------------------------------------------------------------------------------*                     5
        * RPG record format  . . . . :  SFLTASKCTL                                                   *                     5
        * External format  . . . . . :  SFLTASKCTL : NLITTEN1/CRUD01PNL                              *                     5
        *--------------------------------------------------------------------------------------------*                     5
   306=ICRUDTASK                                                                                                           6000001
        *--------------------------------------------------------------------------------------------*                     6
        * RPG record format  . . . . :  CRUDTASK                                                     *                     6
        * External format  . . . . . :  CRUDTASK : NLITTEN1/CRUD01PNL                                *                     6
        *--------------------------------------------------------------------------------------------*                     6
   307=I                             S    1   10 0CRUDTASKID                                                               6000002
   308=I                             A   11   20  NAMETASK                                                                 6000003
   309=I                             A   21  170  DESCRP                                                                   6000004
   310=I                             A  171  320  SOLUTION                                                                 6000005
   311=I                             S  321  328 0STARTDATE                                                                6000006
   312=I                             S  329  336 0ENDDATE                                                                  6000007
   313=I                             S  337  337 0STATETASK                                                                6000008
   314=IEMPTY                                                                                                              7000001
        *--------------------------------------------------------------------------------------------*                     7
        * RPG record format  . . . . :  EMPTY                                                        *                     7
        * External format  . . . . . :  EMPTY : NLITTEN1/CRUD01PNL                                   *                     7
        *--------------------------------------------------------------------------------------------*                     7
   315=IWDWCONFIRM                                                                                                         8000001
        *--------------------------------------------------------------------------------------------*                     8
        * RPG record format  . . . . :  WDWCONFIRM                                                   *                     8
        * External format  . . . . . :  WDWCONFIRM : NLITTEN1/CRUD01PNL                              *                     8
        *--------------------------------------------------------------------------------------------*                     8
   316=I                             A    1    1  WDWCHOICE                                                                8000002
   317=IWDWMESSAGE                                                                                                         9000001
        *--------------------------------------------------------------------------------------------*                     9
        * RPG record format  . . . . :  WDWMESSAGE                                                   *                     9
        * External format  . . . . . :  WDWMESSAGE : NLITTEN1/CRUD01PNL                              *                     9
        *--------------------------------------------------------------------------------------------*                     9
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page      9
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   318=OHEADER                                                                                                            10000001
        *--------------------------------------------------------------------------------------------*                    10
        * RPG record format  . . . . :  HEADER                                                       *                    10
        * External format  . . . . . :  HEADER : NLITTEN1/CRUD01PNL                                  *                    10
        *--------------------------------------------------------------------------------------------*                    10
   319=O                       TITLE1              50A CHAR       50                                                      10000002
   320=O                       TITLE2             100A CHAR       50                                                      10000003
   321=O                       TITLE3             150A CHAR       50                                                      10000004
   322=OFOOTER                                                                                                            11000001
        *--------------------------------------------------------------------------------------------*                    11
        * RPG record format  . . . . :  FOOTER                                                       *                    11
        * External format  . . . . . :  FOOTER : NLITTEN1/CRUD01PNL                                  *                    11
        *--------------------------------------------------------------------------------------------*                    11
   323=O                       FOOTTEXT            50A CHAR       50                                                      11000002
   324=OSFLTASK                                                                                                           12000001
        *--------------------------------------------------------------------------------------------*                    12
        * RPG record format  . . . . :  SFLTASK                                                      *                    12
        * External format  . . . . . :  SFLTASK : NLITTEN1/CRUD01PNL                                 *                    12
        *--------------------------------------------------------------------------------------------*                    12
   325=O                       OPCTASK              1A CHAR        1                                                      12000002
   326=O                       SFLTASKID           11S ZONE     10,0                                                      12000003
   327=O                       SFLTASKNAM          21A CHAR       10                                                      12000004
   328=O                       SFLSTRDATE          29S ZONE      8,0                                                      12000005
   329=O                       SFLENDDATE          37S ZONE      8,0                                                      12000006
   330=O                       SFLSTATE            39S ZONE      2,0                                                      12000007
   331=OSFLTASKCTL                                                                                                        13000001
        *--------------------------------------------------------------------------------------------*                    13
        * RPG record format  . . . . :  SFLTASKCTL                                                   *                    13
        * External format  . . . . . :  SFLTASKCTL : NLITTEN1/CRUD01PNL                              *                    13
        *--------------------------------------------------------------------------------------------*                    13
   332=OCRUDTASK                                                                                                          14000001
        *--------------------------------------------------------------------------------------------*                    14
        * RPG record format  . . . . :  CRUDTASK                                                     *                    14
        * External format  . . . . . :  CRUDTASK : NLITTEN1/CRUD01PNL                                *                    14
        *--------------------------------------------------------------------------------------------*                    14
   333=O                       CRUDTASKID          10S ZONE     10,0                                                      14000002
   334=O                       NAMETASK            20A CHAR       10                                                      14000003
   335=O                       DESCRP             170A CHAR      150                                                      14000004
   336=O                       SOLUTION           320A CHAR      150                                                      14000005
   337=O                       STARTDATE          328S ZONE      8,0                                                      14000006
   338=O                       ENDDATE            336S ZONE      8,0                                                      14000007
   339=O                       STATETASK          337S ZONE      1,0                                                      14000008
   340=OEMPTY                                                                                                             15000001
        *--------------------------------------------------------------------------------------------*                    15
        * RPG record format  . . . . :  EMPTY                                                        *                    15
        * External format  . . . . . :  EMPTY : NLITTEN1/CRUD01PNL                                   *                    15
        *--------------------------------------------------------------------------------------------*                    15
   341=OWDWCONFIRM                                                                                                        16000001
        *--------------------------------------------------------------------------------------------*                    16
        * RPG record format  . . . . :  WDWCONFIRM                                                   *                    16
        * External format  . . . . . :  WDWCONFIRM : NLITTEN1/CRUD01PNL                              *                    16
        *--------------------------------------------------------------------------------------------*                    16
   342=O                       WDWTEXT1            40A CHAR       40                                                      16000002
   343=O                       WDWTEXT2            80A CHAR       40                                                      16000003
   344=O                       WDWCHOICE           81A CHAR        1                                                      16000004
   345=OWDWMESSAGE                                                                                                        17000001
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     10
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
        *--------------------------------------------------------------------------------------------*                    17
        * RPG record format  . . . . :  WDWMESSAGE                                                   *                    17
        * External format  . . . . . :  WDWMESSAGE : NLITTEN1/CRUD01PNL                              *                    17
        *--------------------------------------------------------------------------------------------*                    17
   346=O                       WDWMSG1             40A CHAR       40                                                      17000002
   347=O                       WDWMSG2             80A CHAR       40                                                      17000003
   348 Dcl-Proc mainline;                                                                                                   000288
   349                                                                                                                      000289
   350   Dcl-S choice char(1) inz(*blanks);                                                                                 000290
   351                                                                                                                      000291
   352   open CRUD01PNL;                                                                                                    000292
   353                                                                                                                      000293
   354   // The value 'S' is for Subfile Menu                                                                               000294
   355   choice = 'S';                                                                                                      000295
   356                                                                                                                      000296
   357   ShowScreen(choice);                                                                                                000297
   358                                                                                                                      000298
   359   // Termination of program                                                                                          000299
   360   close CRUD01PNL;                                                                                                   000300
   361   *Inlr = *On;                                                                                                       000301
   362 end-proc;                                                                                                            000302
   363                                                                                                                      000303
   364                                                                                                                      000304
   365                                                                                                                      000305
   366                                                                                                                      000306
   367                                                                                                                      000307
   368                                                                                                                      000308
   369 // --------------------------------------------------------------------------                                        000309
   370 // This procedure receives a parameter for the titles that are written                                               000310
   371 // --------------------------------------------------------------------------                                        000311
   372 Dcl-Proc WriteScreen;                                                                                                000312
   373   Dcl-Pi WriteScreen;                                                                                                000313
   374     p_choice char(1);                                                                                                000314
   375   end-pi;                                                                                                            000315
   376                                                                                                                      000316
   377   // Secondary titles                                                                                                000317
   378   TITLE2 = Center('Created by Some Bloke':%len(TITLE2));                                                             000318
   379   TITLE3 = Center('Back in 2018':%len(TITLE3));                                                                      000319
   380                                                                                                                      000320
   381   // Principal title                                                                                                 000321
   382   Select;                                                                                            B01             000322
   383                                                                                                                      000323
   384       // CRUD Options                                                                                                000324
   385     When (p_choice = 'I');                                                                           X01             000325
   386       TITLE1 = Center('TASKS ADMINISTRATOR INSERT':%len(TITLE1));                                     01             000326
   387     When (p_choice = 'M');                                                                           X01             000327
   388       TITLE1 = Center('TASKS ADMINISTRATOR MODIFY':%len(TITLE1));                                     01             000328
   389     When (p_choice = 'D');                                                                           X01             000329
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     11
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   390       TITLE1 = Center('TASKS ADMINISTRATOR DELETE':%len(TITLE1));                                     01             000330
   391     When (p_choice = 'V');                                                                           X01             000331
   392       TITLE1 = Center('TASKS ADMINISTRATOR VIEW':%len(TITLE1));                                       01             000332
   393                                                                                                                      000333
   394       // Subfile                                                                                                     000334
   395     When (p_choice = 'S');                                                                           X01             000335
   396       TITLE1 = Center('TASKS ADMINISTRATOR MAIN MENU':%len(TITLE1));                                  01             000336
   397   EndSl;                                                                                             E01             000337
   398                                                                                                                      000338
   399   // Use an IF/ELSEIF as a different way of doing SELECT groups                                                      000339
   400   // here is an example:                                                                                             000340
   401   If (p_choice = 'S');                                                                               B01             000341
   402     FOOTTEXT = 'F3=Exit  F5=Refresh  F6=Create';                                                      01             000342
   403   elseif (p_choice = 'I' or p_choice= 'M' or p_choice= 'D');                                         X01             000343
   404     FOOTTEXT = 'F3=Exit      F10=Confirm';                                                            01             000344
   405   elseif (p_choice = 'V');                                                                           X01             000345
   406     FOOTTEXT = 'F3=Exit  ';                                                                           01             000346
   407   EndIf;                                                                                             E01             000347
   408                                                                                                                      000348
   409   write HEADER;                                                                                                      000349
   410   write FOOTER;                                                                                                      000350
   411 end-proc;                                                                                                            000351
   412                                                                                                                      000352
   413                                                                                                                      000353
   414                                                                                                                      000354
   415                                                                                                                      000355
   416                                                                                                                      000356
   417                                                                                                                      000357
   418                                                                                                                      000358
   419                                                                                                                      000359
   420                                                                                                                      000360
   421                                                                                                                      000361
   422                                                                                                                      000362
   423                                                                                                                      000363
   424 // --------------------------------------------------------------------------                                        000364
   425 // This procedure executes and show the screen choiced by parameter                                                  000365
   426 // --------------------------------------------------------------------------                                        000366
   427 Dcl-Proc ShowScreen;                                                                                                 000367
   428   Dcl-Pi ShowScreen ;                                                                                                000368
   429     p_choice char(1);                                                                                                000369
   430   end-pi;                                                                                                            000370
   431                                                                                                                      000371
   432   Select;                                                                                            B01             000372
   433     When (p_choice = 'I');                                                                           X01             000373
   434       InsertScreen(p_choice);                                                                         01             000374
   435     When (p_choice = 'S');                                                                           X01             000375
   436       ShowSubfile(p_choice);                                                                          01             000376
   437     When (p_choice = 'M');                                                                           X01             000377
   438       ModifyScreen(p_choice);                                                                         01             000378
   439     When (p_choice = 'D');                                                                           X01             000379
   440       DeleteScreen(p_choice);                                                                         01             000380
   441     When (p_choice = 'V');                                                                           X01             000381
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     12
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   442       ViewScreen(p_choice);                                                                           01             000382
   443   EndSl;                                                                                             E01             000383
   444                                                                                                                      000384
   445 end-proc;                                                                                                            000385
   446                                                                                                                      000386
   447                                                                                                                      000387
   448                                                                                                                      000388
   449                                                                                                                      000389
   450                                                                                                                      000390
   451                                                                                                                      000391
   452                                                                                                                      000392
   453 // --------------------------------------------------------------------------                                        000393
   454 // Show Window to user for confirm the current action                                                                000394
   455 // --------------------------------------------------------------------------                                        000395
   456 Dcl-Proc ShowWdw;                                                                                                    000396
   457   Dcl-Pi ShowWdw;                                                                                                    000397
   458     p_choice char(1);                                                                                                000398
   459   end-pi;                                                                                                            000399
   460                                                                                                                      000400
   461   // 'C' for confirm save record in database                                                                         000401
   462   If (p_choice = 'C');                                                                               B01             000402
   463     WDWTEXT1 = 'Are you sure to execute this action?';                                                01             000403
   464     WDWTEXT2 = 'Please type Y/N ';                                                                    01             000404
   465     write WDWCONFIRM;                                                                                 01             000405
   466     exfmt WDWCONFIRM;                                                                                 01             000406
   467   EndIf;                                                                                             E01             000407
   468                                                                                                                      000408
   469   // 'M' for message information                                                                                     000409
   470   If (p_choice = 'M');                                                                               B01             000410
   471     WDWMSG1 = 'Your record has been saved';                                                           01             000411
   472     exfmt WDWMESSAGE;                                                                                 01             000412
   473   EndIf;                                                                                             E01             000413
   474                                                                                                                      000414
   475   If (p_choice = 'D');                                                                               B01             000415
   476     WDWMSG1 = 'Your record has been deleted';                                                         01             000416
   477     exfmt WDWMESSAGE;                                                                                 01             000417
   478   EndIf;                                                                                             E01             000418
   479                                                                                                                      000419
   480   // 'E' for error message                                                                                           000420
   481   If (p_choice = 'E');                                                                               B01             000421
   482     WDWMSG1 = 'Error executing this action ';                                                         01             000422
   483     exfmt WDWMESSAGE;                                                                                 01             000423
   484   EndIf;                                                                                             E01             000424
   485                                                                                                                      000425
   486 end-proc;                                                                                                            000426
   487                                                                                                                      000427
   488                                                                                                                      000428
   489                                                                                                                      000429
   490                                                                                                                      000430
   491                                                                                                                      000431
   492                                                                                                                      000432
   493                                                                                                                      000433
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     13
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   494                                                                                                                      000434
   495                                                                                                                      000435
   496                                                                                                                      000436
   497                                                                                                                      000437
   498 // --------------------------------------------------------------------------                                        000438
   499 // This procedure Center the titles of the screen                                                                    000439
   500 // --------------------------------------------------------------------------                                        000440
   501 Dcl-Proc Center;                                                                                                     000441
   502   Dcl-Pi Center char(80);                                                                                            000442
   503     Par_Text char(80) value;                                                                                         000443
   504     Par_Length zoned(2:0) value;                                                                                     000444
   505   end-pi;                                                                                                            000445
   506                                                                                                                      000446
   507   // Local variables                                                                                                 000447
   508   Dcl-S LenBlanks zoned(2:0);                                                                                        000448
   509   Dcl-S InitPosition zoned(2:0);                                                                                     000449
   510   Dcl-S Centeredtext char(80);                                                                                       000450
   511                                                                                                                      000451
   512   LenBlanks= Par_Length - %Len(%Trim(Par_Text));                                                                     000452
   513   InitPosition = LenBlanks /2;                                                                                       000453
   514   %Subst(Centeredtext:InitPosition)= %Trim(Par_Text);                                                                000454
   515   Return Centeredtext;                                                                                               000455
   516                                                                                                                      000456
   517 end-proc;                                                                                                            000457
   518                                                                                                                      000458
   519                                                                                                                      000459
   520                                                                                                                      000460
   521                                                                                                                      000461
   522                                                                                                                      000462
   523                                                                                                                      000463
   524                                                                                                                      000464
   525                                                                                                                      000465
   526 // --------------------------------------------------------------------------                                        000466
   527 // Show the subfile in the screen                                                                                    000467
   528 // --------------------------------------------------------------------------                                        000468
   529 Dcl-Proc ShowSubfile;                                                                                                000469
   530   Dcl-Pi ShowSubfile;                                                                                                000470
   531     p_choice char(1);                                                                                                000471
   532   end-pi;                                                                                                            000472
   533                                                                                                                      000473
   534   Dcl-S w_exist char(1);                                                                                             000474
   535   Dcl-S choice char(1);                                                                                              000475
   536                                                                                                                      000476
   537 **END-FREE                                                                                                           000477
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   538 D                 DS                  STATIC                               SELECT                                    000478
   539 D  SQL_00000              1      2B 0 INZ(128)                             length of header                          000479
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     14
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   540 D  SQL_00001              3      4B 0 INZ(3)                               statement number                          000480
   541 D  SQL_00002              5      8U 0 INZ(0)                               invocation mark                           000481
   542 D  SQL_00003              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000482
   543 D  SQL_00004             10    128A   CCSID(*JOBRUNMIX)                    end of header                             000483
   544 D  SQL_00005            129    138S 0                                      INITIALPOS                                000484
   545 D  SQL_00006            139    148S 0                                      FINALPOS                                  000485
   546 D  SQL_00007            149    149A   CCSID(*JOBRUNMIX)                    W_EXIST                                   000486
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   547 **FREE                                                                                                               000487
   548 **END-FREE                                                                                                           000488
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   549 D                 DS                  STATIC                               SELECT                                    000489
   550 D  SQL_00008              1      2B 0 INZ(128)                             length of header                          000490
   551 D  SQL_00009              3      4B 0 INZ(4)                               statement number                          000491
   552 D  SQL_00010              5      8U 0 INZ(0)                               invocation mark                           000492
   553 D  SQL_00011              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000493
   554 D  SQL_00012             10    128A   CCSID(*JOBRUNMIX)                    end of header                             000494
   555 D  SQL_00013            129    134P 0 PACKEVEN                             SFLTASKID                                 000495
   556 D  SQL_00014            135    144S 0                                      DS_DATACRUD.TASK_ID                       000496
   557 D  SQL_00015            145    156A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.NAME                          000497
   558 D  SQL_00016            157    308A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.DESCR                         000498
   559 D  SQL_00017            309    460A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.ENDDES                        000499
   560 D  SQL_00018            461    468S 0                                      DS_DATACRUD.STARTDAT                      000500
   561 D  SQL_00019            469    476S 0                                      DS_DATACRUD.ENDDATE                       000501
   562 D  SQL_00020            477    477S 0                                      DS_DATACRUD.STATE                         000502
   563 D  SQL_00021            478    489A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.OWNER                         000503
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   564 **FREE                                                                                                               000504
   565 **END-FREE                                                                                                           000505
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   566 D                 DS                  STATIC                               SELECT                                    000506
   567 D  SQL_00022              1      2B 0 INZ(128)                             length of header                          000507
   568 D  SQL_00023              3      4B 0 INZ(5)                               statement number                          000508
   569 D  SQL_00024              5      8U 0 INZ(0)                               invocation mark                           000509
   570 D  SQL_00025              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000510
   571 D  SQL_00026             10    128A   CCSID(*JOBRUNMIX)                    end of header                             000511
   572 D  SQL_00027            129    134P 0 PACKEVEN                             SFLTASKID                                 000512
   573 D  SQL_00028            135    144S 0                                      DS_DATACRUD.TASK_ID                       000513
   574 D  SQL_00029            145    156A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.NAME                          000514
   575 D  SQL_00030            157    308A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.DESCR                         000515
   576 D  SQL_00031            309    460A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.ENDDES                        000516
   577 D  SQL_00032            461    468S 0                                      DS_DATACRUD.STARTDAT                      000517
   578 D  SQL_00033            469    476S 0                                      DS_DATACRUD.ENDDATE                       000518
   579 D  SQL_00034            477    477S 0                                      DS_DATACRUD.STATE                         000519
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     15
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   580 D  SQL_00035            478    489A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.OWNER                         000520
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   581 **FREE                                                                                                               000521
   582 **END-FREE                                                                                                           000522
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   583 D                 DS                  STATIC                               SELECT                                    000523
   584 D  SQL_00036              1      2B 0 INZ(128)                             length of header                          000524
   585 D  SQL_00037              3      4B 0 INZ(6)                               statement number                          000525
   586 D  SQL_00038              5      8U 0 INZ(0)                               invocation mark                           000526
   587 D  SQL_00039              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000527
   588 D  SQL_00040             10    128A   CCSID(*JOBRUNMIX)                    end of header                             000528
   589 D  SQL_00041            129    134P 0 PACKEVEN                             SFLTASKID                                 000529
   590 D  SQL_00042            135    144S 0                                      DS_DATACRUD.TASK_ID                       000530
   591 D  SQL_00043            145    156A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.NAME                          000531
   592 D  SQL_00044            157    308A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.DESCR                         000532
   593 D  SQL_00045            309    460A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.ENDDES                        000533
   594 D  SQL_00046            461    468S 0                                      DS_DATACRUD.STARTDAT                      000534
   595 D  SQL_00047            469    476S 0                                      DS_DATACRUD.ENDDATE                       000535
   596 D  SQL_00048            477    477S 0                                      DS_DATACRUD.STATE                         000536
   597 D  SQL_00049            478    489A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.OWNER                         000537
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   598 **FREE                                                                                                               000538
   599   dow (not PFKEY03);                                                                                 B01             000539
   600     WriteScreen(p_choice);                                                                            01             000540
   601     ActivateSubfile();                                                                                01             000541
   602     exfmt SFLTASKCTL;                                                                                 01             000542
   603                                                                                                                      000543
   604     Select ;                                                                                         B02             000544
   605       When (PFKEY03);                                                                                X02             000545
   606         PFKEY03 = *Off;                                                                               02             000546
   607         reset Initialpos;                                                                             02             000547
   608         reset Finalpos;                                                                               02             000548
   609         leave;                                                                                        02             000549
   610       When (infds.funcKey = PAGEUP);                                                                 X02             000550
   611         If (Initialpos = 0 and Finalpos = 10);                                                       B03             000551
   612           iter;                                                                                       03             000552
   613         elseif (Initialpos > 1 and Finalpos > 10);                                                   X03             000553
   614           Initialpos -= 11;                                                                           03             000554
   615           Finalpos -= 10;                                                                             03             000555
   616           ShowScreen(p_choice);                                                                       03             000556
   617           leave;                                                                                      03             000557
   618         EndIf;                                                                                       E03             000558
   619                                                                                                                      000559
   620       When (infds.funcKey = PAGEDOWN);                                                               X02             000560
   621                                                                                                                      000561
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     16
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   622         If (Initialpos > 0 and Finalpos > 10);                                                       B03             000562
   623                                                                                                                      000563
   624 //*          exec sql                                                                                                000564
   625 //*          SELECT '1'                                                                                              000565
   626 //*            INTO : w_exist                                                                                        000566
   627 //*            FROM (SELECT A.*,                                                                                     000567
   628 //*                         RowNumber()                                                                              000568
   629 //*                    Over()                                                                                        000569
   630 //*                    as RNum                                                                                       000570
   631 //*                    FROM CRUD01TBL AS A                                                                           000571
   632 //*                    Where 1 = 1)                                                                                  000572
   633 //*            as Tbl                                                                                                000573
   634 //*            Where RNum BetWeen : Initialpos AND                                                                   000574
   635 //*                  :Finalpos                                                                                       000575
   636 //*            FETCH FIRST ROW ONLY;                                                                                 000576
   637           SQL_00005 = INITIALPOS;                                               //SQL                 03             000577
   638           SQL_00006 = FINALPOS;                                                 //SQL                 03             000578
   639           SQLER6 = -4;                                                          //SQL 3               03             000579
   640           SQLROUTE_CALL(                                                        //SQL                 03             000580
   641                SQLCA                                                            //SQL                 03             000581
   642              : SQL_00000                                                        //SQL                 03             000582
   643           );                                                                    //SQL                 03             000583
   644           IF SQL_00003 = '1';                                                   //SQL                B04             000584
   645           EVAL W_EXIST = SQL_00007;                                             //SQL                 04             000585
   646           ENDIF;                                                                //SQL                E04             000586
   647                                                                                                                      000587
   648           If (w_exist <> '1');                                                                       B04             000588
   649             Initialpos -= 11;                                                                         04             000589
   650             Finalpos -= 10;                                                                           04             000590
   651           EndIf;                                                                                     E04             000591
   652                                                                                                                      000592
   653           ShowScreen(p_choice);                                                                       03             000593
   654           leave;                                                                                      03             000594
   655                                                                                                                      000595
   656         Else;                                                                                        X03             000596
   657           ShowScreen(p_choice);                                                                       03             000597
   658           leave;                                                                                      03             000598
   659         EndIf;                                                                                       E03             000599
   660                                                                                                                      000600
   661       When (pfkey(05));                                                                              X02             000601
   662                                                                                                                      000602
   663         reset Initialpos;                                                                             02             000603
   664         reset Finalpos;                                                                               02             000604
   665                                                                                                                      000605
   666         ShowScreen(p_choice);                                                                         02             000606
   667         leave;                                                                                        02             000607
   668       When (pfkey(06));                                                                              X02             000608
   669         choice = 'I';                                                                                 02             000609
   670         ShowScreen(choice);                                                                           02             000610
   671         leave;                                                                                        02             000611
   672       Other;                                                                                         X02             000612
   673         reset w_Wheresfl;                                                                             02             000613
   674                                                                                                                      000614
   675         // if there are selected records in subfile then executes                                                    000615
   676         If (taskrrn > *zeros);                                                                       B03             000616
   677           for taskrrn = 1 to PERPAGE;                                                                B04             000617
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     17
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   678             chain taskrrn SFLTASK;                                                                    04             000618
   679             If (%found());                                                                           B05             000619
   680                                                                                                                      000620
   681               Select;                                                                                B06             000621
   682                 When (OPCTASK = '2');                                                                X06             000622
   683                                                                                                                      000623
   684                   clear Ds_datacrud;                                                                  06             000624
   685                                                                                                                      000625
   686                   // Loads the data into data structure                                                              000626
   687 //*                  exec sql                                                                                        000627
   688 //*                SELECT * INTO:Ds_datacrud                                                                         000628
   689 //*                  FROM CRUD01TBL                                                                                  000629
   690 //*                  WHERE TASK_ID = : SFLTASKID;                                                                    000630
   691           SQL_00013 = SFLTASKID;                                                //SQL                 06             000631
   692           SQLER6 = -4;                                                          //SQL 4               06             000632
   693           SQLROUTE_CALL(                                                        //SQL                 06             000633
   694                SQLCA                                                            //SQL                 06             000634
   695              : SQL_00008                                                        //SQL                 06             000635
   696           );                                                                    //SQL                 06             000636
   697           IF SQL_00011 = '1';                                                   //SQL                B07             000637
   698           EVAL DS_DATACRUD.TASK_ID = SQL_00014;                                 //SQL                 07             000638
   699           EVAL DS_DATACRUD.NAME = SQL_00015;                                    //SQL                 07             000639
   700           EVAL DS_DATACRUD.DESCR = SQL_00016;                                   //SQL                 07             000640
   701           EVAL DS_DATACRUD.ENDDES = SQL_00017;                                  //SQL                 07             000641
   702           EVAL DS_DATACRUD.STARTDATE = SQL_00018;                               //SQL                 07             000642
   703           EVAL DS_DATACRUD.ENDDATE = SQL_00019;                                 //SQL                 07             000643
   704           EVAL DS_DATACRUD.STATE = SQL_00020;                                   //SQL                 07             000644
   705           EVAL DS_DATACRUD.OWNER = SQL_00021;                                   //SQL                 07             000645
   706           ENDIF;                                                                //SQL                E07             000646
   707                                                                                                                      000647
   708                   choice = 'M';                                                                       06             000648
   709                   ShowScreen(choice);                                                                 06             000649
   710                   leave;                                                                              06             000650
   711                 When (OPCTASK = '4');                                                                X06             000651
   712                   clear Ds_datacrud;                                                                  06             000652
   713                                                                                                                      000653
   714                   // Loads the data into data structure                                                              000654
   715 //*                  exec sql                                                                                        000655
   716 //*                SELECT * INTO:Ds_datacrud                                                                         000656
   717 //*                  FROM CRUD01TBL                                                                                  000657
   718 //*                  WHERE TASK_ID = : SFLTASKID;                                                                    000658
   719           SQL_00027 = SFLTASKID;                                                //SQL                 06             000659
   720           SQLER6 = -4;                                                          //SQL 5               06             000660
   721           SQLROUTE_CALL(                                                        //SQL                 06             000661
   722                SQLCA                                                            //SQL                 06             000662
   723              : SQL_00022                                                        //SQL                 06             000663
   724           );                                                                    //SQL                 06             000664
   725           IF SQL_00025 = '1';                                                   //SQL                B07             000665
   726           EVAL DS_DATACRUD.TASK_ID = SQL_00028;                                 //SQL                 07             000666
   727           EVAL DS_DATACRUD.NAME = SQL_00029;                                    //SQL                 07             000667
   728           EVAL DS_DATACRUD.DESCR = SQL_00030;                                   //SQL                 07             000668
   729           EVAL DS_DATACRUD.ENDDES = SQL_00031;                                  //SQL                 07             000669
   730           EVAL DS_DATACRUD.STARTDATE = SQL_00032;                               //SQL                 07             000670
   731           EVAL DS_DATACRUD.ENDDATE = SQL_00033;                                 //SQL                 07             000671
   732           EVAL DS_DATACRUD.STATE = SQL_00034;                                   //SQL                 07             000672
   733           EVAL DS_DATACRUD.OWNER = SQL_00035;                                   //SQL                 07             000673
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     18
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   734           ENDIF;                                                                //SQL                E07             000674
   735                                                                                                                      000675
   736                   choice = 'D';                                                                       06             000676
   737                   ShowScreen(choice);                                                                 06             000677
   738                   leave;                                                                              06             000678
   739                 When (OPCTASK = '5');                                                                X06             000679
   740                   clear Ds_datacrud;                                                                  06             000680
   741                                                                                                                      000681
   742                   // Loads the data into data structure                                                              000682
   743 //*                  exec sql                                                                                        000683
   744 //*                SELECT * INTO:Ds_datacrud                                                                         000684
   745 //*                  FROM CRUD01TBL                                                                                  000685
   746 //*                  WHERE TASK_ID = : SFLTASKID;                                                                    000686
   747           SQL_00041 = SFLTASKID;                                                //SQL                 06             000687
   748           SQLER6 = -4;                                                          //SQL 6               06             000688
   749           SQLROUTE_CALL(                                                        //SQL                 06             000689
   750                SQLCA                                                            //SQL                 06             000690
   751              : SQL_00036                                                        //SQL                 06             000691
   752           );                                                                    //SQL                 06             000692
   753           IF SQL_00039 = '1';                                                   //SQL                B07             000693
   754           EVAL DS_DATACRUD.TASK_ID = SQL_00042;                                 //SQL                 07             000694
   755           EVAL DS_DATACRUD.NAME = SQL_00043;                                    //SQL                 07             000695
   756           EVAL DS_DATACRUD.DESCR = SQL_00044;                                   //SQL                 07             000696
   757           EVAL DS_DATACRUD.ENDDES = SQL_00045;                                  //SQL                 07             000697
   758           EVAL DS_DATACRUD.STARTDATE = SQL_00046;                               //SQL                 07             000698
   759           EVAL DS_DATACRUD.ENDDATE = SQL_00047;                                 //SQL                 07             000699
   760           EVAL DS_DATACRUD.STATE = SQL_00048;                                   //SQL                 07             000700
   761           EVAL DS_DATACRUD.OWNER = SQL_00049;                                   //SQL                 07             000701
   762           ENDIF;                                                                //SQL                E07             000702
   763                                                                                                                      000703
   764                   choice = 'V';                                                                       06             000704
   765                   ShowScreen(choice);                                                                 06             000705
   766                   leave;                                                                              06             000706
   767               EndSl;                                                                                 E06             000707
   768               // Clean the field                                                                                     000708
   769               OPCTASK = *Blanks;                                                                      05             000709
   770               Update SFLTASK;                                                                         05             000710
   771             Else;                                                                                    X05             000711
   772               leave;                                                                                  05             000712
   773             EndIf;                                                                                   E05             000713
   774           endfor;                                                                                    E04             000714
   775         EndIf;                                                                                       E03             000715
   776     EndSl;                                                                                           E02             000716
   777     If (w_Crudfinalize = *On);                                                                       B02             000717
   778       w_Crudfinalize = *Off;                                                                          02             000718
   779       leave;                                                                                          02             000719
   780     EndIf;                                                                                           E02             000720
   781                                                                                                                      000721
   782   enddo;                                                                                             E01             000722
   783                                                                                                                      000723
   784 end-proc ;                                                                                                           000724
   785                                                                                                                      000725
   786                                                                                                                      000726
   787                                                                                                                      000727
   788                                                                                                                      000728
   789                                                                                                                      000729
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     19
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   790                                                                                                                      000730
   791                                                                                                                      000731
   792 // --------------------------------------------------------------------------                                        000732
   793 // handle all screen validation                                                                                      000733
   794 // --------------------------------------------------------------------------                                        000734
   795 Dcl-Proc ScreenValidation ;                                                                                          000735
   796   Dcl-Pi ScreenValidation Ind;                                                                                       000736
   797     p_choice char(1);                                                                                                000737
   798   end-pi;                                                                                                            000738
   799                                                                                                                      000739
   800   Dcl-S w_ValidisnotOK Ind;                                                                                          000740
   801   Dcl-S w_Exists char(1);                                                                                            000741
   802                                                                                                                      000742
   803   // Set zeros in general variable based in  DisplayIndicators                                                       000743
   804 **END-FREE                                                                                                           000744
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   805 D                 DS                  STATIC                               SELECT                                    000745
   806 D  SQL_00050              1      2B 0 INZ(128)                             length of header                          000746
   807 D  SQL_00051              3      4B 0 INZ(7)                               statement number                          000747
   808 D  SQL_00052              5      8U 0 INZ(0)                               invocation mark                           000748
   809 D  SQL_00053              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000749
   810 D  SQL_00054             10    128A   CCSID(*JOBRUNMIX)                    end of header                             000750
   811 D  SQL_00055            129    134P 0 PACKEVEN                             CRUDTASKID                                000751
   812 D  SQL_00056            135    135A   CCSID(*JOBRUNMIX)                    W_EXISTS                                  000752
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   813 **FREE                                                                                                               000753
   814   IndErrors = *zeros;                                                                                                000754
   815                                                                                                                      000755
   816   If (p_choice = 'I'); // Validations for Insert                                                     B01             000756
   817                                                                                                                      000757
   818     TurnoffErrors();                                                                                  01             000758
   819                                                                                                                      000759
   820     // Search Task id entered into database                                                                          000760
   821 //*    exec sql                                                                                                      000761
   822 //*      SELECT '1'                                                                                                  000762
   823 //*        INTO : w_Exists                                                                                           000763
   824 //*        FROM CRUD01TBL                                                                                            000764
   825 //*        WHERE TASK_ID = :CRUDTASKID;                                                                              000765
   826           SQL_00055 = CRUDTASKID;                                               //SQL                 01             000766
   827           SQLER6 = -4;                                                          //SQL 7               01             000767
   828           SQLROUTE_CALL(                                                        //SQL                 01             000768
   829                SQLCA                                                            //SQL                 01             000769
   830              : SQL_00050                                                        //SQL                 01             000770
   831           );                                                                    //SQL                 01             000771
   832           IF SQL_00053 = '1';                                                   //SQL                B02             000772
   833           EVAL W_EXISTS = SQL_00056;                                            //SQL                 02             000773
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     20
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   834           ENDIF;                                                                //SQL                E02             000774
   835                                                                                                                      000775
   836     Taskidexisterror_31 = (w_Exists = '1');                                                           01             000776
   837                                                                                                                      000777
   838     // Validation of dates                                                                                           000778
   839     test(De) *iso STARTDATE; //Validates if date is in YYYYMMDD                                       01             000779
   840                                                                                                                      000780
   841     Startdateerror_32 = %error;                                                                       01             000781
   842                                                                                                                      000782
   843     test(De) *iso ENDDATE;                                                                            01             000783
   844                                                                                                                      000784
   845     Enddateerror_33 = %error;                                                                         01             000785
   846                                                                                                                      000786
   847     If (STARTDATE <> *zeros and ENDDATE <> *zeros                                                    B02             000787
   848         and Startdateerror_32 = *Off and Enddateerror_33 = *Off);                                    B02             000788
   849       If (STARTDATE > ENDDATE);                                                                      B03             000789
   850         Dategreaterthanerror_34 = *On;                                                                03             000790
   851       EndIf;                                                                                         E03             000791
   852     EndIf;                                                                                           E02             000792
   853   EndIf;                                                                                             E01             000793
   854                                                                                                                      000794
   855   w_ValidisnotOK = IndErrors <> *Zeros;                                                                              000795
   856                                                                                                                      000796
   857   Return w_ValidisnotOK;                                                                                             000797
   858 end-proc;                                                                                                            000798
   859                                                                                                                      000799
   860                                                                                                                      000800
   861                                                                                                                      000801
   862                                                                                                                      000802
   863                                                                                                                      000803
   864                                                                                                                      000804
   865 // --------------------------------------------------------------------------                                        000805
   866 // reset errors                                                                                                      000806
   867 // --------------------------------------------------------------------------                                        000807
   868 Dcl-Proc TurnoffErrors;                                                                                              000808
   869   Taskidexisterror_31 = *Off;                                                                                        000809
   870   Startdateerror_32 = *Off;                                                                                          000810
   871   Enddateerror_33 = *Off;                                                                                            000811
   872   Dategreaterthanerror_34 = *Off;                                                                                    000812
   873 end-proc ;                                                                                                           000813
   874                                                                                                                      000814
   875                                                                                                                      000815
   876                                                                                                                      000816
   877                                                                                                                      000817
   878                                                                                                                      000818
   879 // --------------------------------------------------------------------------                                        000819
   880 // This procedure set the sql variable to the procedure to                                                           000820
   881 // populate the subfile with data based in the customized                                                            000821
   882 // sql variable                                                                                                      000822
   883 // --------------------------------------------------------------------------                                        000823
   884 Dcl-Proc SubfileStart;                                                                                               000824
   885   Dcl-Pi SubfileStart;                                                                                               000825
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     21
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   886   end-pi;                                                                                                            000826
   887                                                                                                                      000827
   888   // Variable for store the sql query required                                                                       000828
   889   Dcl-S sqlcustomized char(500);                                                                                     000829
   890                                                                                                                      000830
   891   sqlcustomized = 'SELECT TASK_ID , NAME , STARTDATE , ENDDATE , STATE '+                                            000831
   892                   'FROM (SELECT A.*, RowNumber() Over() as RNum FROM '+                                              000832
   893                   'CRUD01TBL AS A Where 1=1) as Tbl Where RNum '+                                                    000833
   894                   'BetWeen '+%char(Initialpos)+' and '+%char(Finalpos) +                                             000834
   895                   ' '+%trim(w_Wheresfl);                                                                             000835
   896                                                                                                                      000836
   897   FillSfl(sqlcustomized);                                                                                            000837
   898                                                                                                                      000838
   899 end-proc;                                                                                                            000839
   900                                                                                                                      000840
   901                                                                                                                      000841
   902                                                                                                                      000842
   903                                                                                                                      000843
   904                                                                                                                      000844
   905 // --------------------------------------------------------------------------                                        000845
   906 // Initialize and prepare the subfile                                                                                000846
   907 // --------------------------------------------------------------------------                                        000847
   908 Dcl-Proc Sflinitial;                                                                                                 000848
   909   SflEnd = *off;                                                                                                     000849
   910   SflClr = *on;                                                                                                      000850
   911   write SFLTASKCTL;                                                                                                  000851
   912   SflClr = *off;                                                                                                     000852
   913   taskrrn = *zeros;                                                                                                  000853
   914   SflDsp = *off;                                                                                                     000854
   915   SflDspCtl = *off;                                                                                                  000855
   916 end-proc;                                                                                                            000856
   917                                                                                                                      000857
   918                                                                                                                      000858
   919                                                                                                                      000859
   920                                                                                                                      000860
   921                                                                                                                      000861
   922                                                                                                                      000862
   923                                                                                                                      000863
   924 // --------------------------------------------------------------------------                                        000864
   925 // Activate the subfile for being displayed on screen                                                                000865
   926 // --------------------------------------------------------------------------                                        000866
   927 Dcl-Proc ActivateSubfile;                                                                                            000867
   928   Sflinitial();                                                                                                      000868
   929   SubfileStart();                                                                                                    000869
   930                                                                                                                      000870
   931   SflEnd = Gettotalrecords() < 10;                                                                                   000871
   932                                                                                                                      000872
   933   If (taskrrn > 0);                                                                                  B01             000873
   934     SflDsp = *On;                                                                                     01             000874
   935   Else;                                                                                              X01             000875
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     22
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   936     write EMPTY;                                                                                      01             000876
   937   EndIf;                                                                                             E01             000877
   938                                                                                                                      000878
   939   SflDspCtl = *On;                                                                                                   000879
   940 end-proc;                                                                                                            000880
   941                                                                                                                      000881
   942                                                                                                                      000882
   943                                                                                                                      000883
   944                                                                                                                      000884
   945                                                                                                                      000885
   946                                                                                                                      000886
   947                                                                                                                      000887
   948                                                                                                                      000888
   949 // --------------------------------------------------------------------------                                        000889
   950 // Fill the subfile with a Cursor                                                                                    000890
   951 // --------------------------------------------------------------------------                                        000891
   952 Dcl-Proc FillSfl;                                                                                                    000892
   953   Dcl-Pi FillSfl;                                                                                                    000893
   954     Par_sqlcustomized char(500);                                                                                     000894
   955   end-pi;                                                                                                            000895
   956                                                                                                                      000896
   957   Dcl-S Count zoned(2:0);                                                                                            000897
   958                                                                                                                      000898
   959   Dcl-S LastRRN zoned(10:0);                                                                                         000899
   960                                                                                                                      000900
   961   // Set previous values for indicates final of subfile is it is                                                     000901
   962   // necessary                                                                                                       000902
   963        DCL-PR SQCALL000008 EXTPGM(SQLROUTE);                                    //SQL                                000903
   964          CA LIKEDS(SQLCA);                                                      //SQL                                000904
   965          P0001 LIKE(PAR_SQLCUSTOMIZED);                                         //SQL                                000905
   966        END-PR SQCALL000008;                                                     //SQL                                000906
   967 **END-FREE                                                                                                           000907
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   968 D                 DS                  STATIC                               OPEN                                      000908
   969 D  SQL_00057              1      2B 0 INZ(128)                             length of header                          000909
   970 D  SQL_00058              3      4B 0 INZ(9)                               statement number                          000910
   971 D  SQL_00059              5      8U 0 INZ(0)                               invocation mark                           000911
   972 D  SQL_00060              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000912
   973 D  SQL_00061             10    127A   CCSID(*JOBRUNMIX)                    end of header                             000913
   974 D  SQL_00062            128    128A   CCSID(*JOBRUNMIX)                    end of header                             000914
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   975 **FREE                                                                                                               000915
   976 **END-FREE                                                                                                           000916
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   977 D                 DS                  STATIC                               FETCH                                     000917
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     23
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   978 D  SQL_00063              1      2B 0 INZ(128)                             length of header                          000918
   979 D  SQL_00064              3      4B 0 INZ(10)                              statement number                          000919
   980 D  SQL_00065              5      8U 0 INZ(0)                               invocation mark                           000920
   981 D  SQL_00066              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000921
   982 D  SQL_00067             10    127A   CCSID(*JOBRUNMIX)                    end of header                             000922
   983 D  SQL_00068            129    138S 0                                      DS_TASKDATA.TASKID                        000923
   984 D  SQL_00069            139    158A   CCSID(*JOBRUNMIX)                    DS_TASKDATA.NAMETASK                      000924
   985 D  SQL_00070            159    166S 0                                      DS_TASKDATA.START_DA                      000925
   986 D  SQL_00071            167    174S 0                                      DS_TASKDATA.END_DATE                      000926
   987 D  SQL_00072            175    175S 0                                      DS_TASKDATA.TASKSTAT                      000927
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   988 **FREE                                                                                                               000928
   989 **END-FREE                                                                                                           000929
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   990 D                 DS                  STATIC                               FETCH                                     000930
   991 D  SQL_00073              1      2B 0 INZ(128)                             length of header                          000931
   992 D  SQL_00074              3      4B 0 INZ(11)                              statement number                          000932
   993 D  SQL_00075              5      8U 0 INZ(0)                               invocation mark                           000933
   994 D  SQL_00076              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000934
   995 D  SQL_00077             10    127A   CCSID(*JOBRUNMIX)                    end of header                             000935
   996 D  SQL_00078            129    138S 0                                      DS_TASKDATA.TASKID                        000936
   997 D  SQL_00079            139    158A   CCSID(*JOBRUNMIX)                    DS_TASKDATA.NAMETASK                      000937
   998 D  SQL_00080            159    166S 0                                      DS_TASKDATA.START_DA                      000938
   999 D  SQL_00081            167    174S 0                                      DS_TASKDATA.END_DATE                      000939
  1000 D  SQL_00082            175    175S 0                                      DS_TASKDATA.TASKSTAT                      000940
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1001 **FREE                                                                                                               000941
  1002 **END-FREE                                                                                                           000942
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  1003 D                 DS                  STATIC                               CLOSE                                     000943
  1004 D  SQL_00083              1      2B 0 INZ(128)                             length of header                          000944
  1005 D  SQL_00084              3      4B 0 INZ(12)                              statement number                          000945
  1006 D  SQL_00085              5      8U 0 INZ(0)                               invocation mark                           000946
  1007 D  SQL_00086              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              000947
  1008 D  SQL_00087             10    127A   CCSID(*JOBRUNMIX)                    end of header                             000948
  1009 D  SQL_00088            128    128A   CCSID(*JOBRUNMIX)                    end of header                             000949
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1010 **FREE                                                                                                               000950
  1011   clear Previnitialpos;                                                                                              000951
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     24
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1012   clear PrevFinalpos;                                                                                                000952
  1013                                                                                                                      000953
  1014   Previnitialpos = Initialpos;                                                                                       000954
  1015   PrevFinalpos = Finalpos;                                                                                           000955
  1016                                                                                                                      000956
  1017   clear Ds_taskdata;                                                                                                 000957
  1018                                                                                                                      000958
  1019 //*  exec sql                                                                                                        000959
  1020 //*    PREPARE YOURQUERY FROM : Par_sqlcustomized;                                                                   000960
  1021           SQLER6 = 8;                                                           //SQL                                000961
  1022           SQCALL000008(                                                         //SQL                                000962
  1023                SQLCA                                                            //SQL                                000963
  1024              : PAR_SQLCUSTOMIZED                                                //SQL                                000964
  1025           );                                                                    //SQL                                000965
  1026                                                                                                                      000966
  1027 //*  exec sql                                                                                                        000967
  1028 //*    DECLARE TASK_CURSOR INSENSITIVE SCROLL CURSOR FOR YOURQUERY;                                                  000968
  1029                                                                                                                      000969
  1030 //*  exec sql                                                                                                        000970
  1031 //*    OPEN TASK_CURSOR;                                                                                             000971
  1032           SQLER6 = -4;                                                          //SQL                                000972
  1033           IF SQL_00059 = 0                                                      //SQL                B01             000973
  1034           OR SQL_00060 <> *LOVAL;                                               //SQL                B01             000974
  1035           SQLROUTE_CALL(                                                        //SQL                 01             000975
  1036                SQLCA                                                            //SQL                 01             000976
  1037              : SQL_00057                                                        //SQL                 01             000977
  1038           );                                                                    //SQL                 01             000978
  1039           ELSE;                                                                 //SQL                X01             000979
  1040           SQLOPEN_CALL(                                                         //SQL                 01             000980
  1041                SQLCA                                                            //SQL                 01             000981
  1042              : SQL_00057                                                        //SQL                 01             000982
  1043           );                                                                    //SQL                 01             000983
  1044           ENDIF;                                                                //SQL                E01             000984
  1045                                                                                                                      000985
  1046 //*  exec sql                                                                                                        000986
  1047 //*    FETCH NEXT FROM TASK_CURSOR INTO : Ds_taskdata;                                                               000987
  1048           SQLER6 = -4;                                                          //SQL 10                             000988
  1049           SQLROUTE_CALL(                                                        //SQL                                000989
  1050                SQLCA                                                            //SQL                                000990
  1051              : SQL_00063                                                        //SQL                                000991
  1052           );                                                                    //SQL                                000992
  1053           IF SQL_00066 = '1';                                                   //SQL                B01             000993
  1054           EVAL DS_TASKDATA.TASKID = SQL_00068;                                  //SQL                 01             000994
  1055           EVAL DS_TASKDATA.NAMETASK = SQL_00069;                                //SQL                 01             000995
  1056           EVAL DS_TASKDATA.START_DATE = SQL_00070;                              //SQL                 01             000996
  1057           EVAL DS_TASKDATA.END_DATE = SQL_00071;                                //SQL                 01             000997
  1058           EVAL DS_TASKDATA.TASKSTATE = SQL_00072;                               //SQL                 01             000998
  1059           ENDIF;                                                                //SQL                E01             000999
  1060                                                                                                                      001000
  1061   dow (xSQLState <> NODATA_ON_SQL) and (Count < PERPAGE);                                            B01             001001
  1062     Count = Count+1;                                                                                  01             001002
  1063     LastRRN = LastRRN+1;                                                                              01             001003
  1064                                                                                                                      001004
  1065     If (xSQLState = SUCCESS_ON_SQL);                                                                 B02             001005
  1066       DatatoSfl();                                                                                    02             001006
  1067     EndIf;                                                                                           E02             001007
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     25
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1068                                                                                                                      001008
  1069 //*    exec sql                                                                                                      001009
  1070 //*      FETCH NEXT FROM TASK_CURSOR INTO : Ds_taskdata;                                                             001010
  1071           SQLER6 = -4;                                                          //SQL 11              01             001011
  1072           SQLROUTE_CALL(                                                        //SQL                 01             001012
  1073                SQLCA                                                            //SQL                 01             001013
  1074              : SQL_00073                                                        //SQL                 01             001014
  1075           );                                                                    //SQL                 01             001015
  1076           IF SQL_00076 = '1';                                                   //SQL                B02             001016
  1077           EVAL DS_TASKDATA.TASKID = SQL_00078;                                  //SQL                 02             001017
  1078           EVAL DS_TASKDATA.NAMETASK = SQL_00079;                                //SQL                 02             001018
  1079           EVAL DS_TASKDATA.START_DATE = SQL_00080;                              //SQL                 02             001019
  1080           EVAL DS_TASKDATA.END_DATE = SQL_00081;                                //SQL                 02             001020
  1081           EVAL DS_TASKDATA.TASKSTATE = SQL_00082;                               //SQL                 02             001021
  1082           ENDIF;                                                                //SQL                E02             001022
  1083     If (xSQLState <> SUCCESS_ON_SQL);                                                                B02             001023
  1084       If (taskrrn = 10);                                                                             B03             001024
  1085         Initialpos += Count+1;                                                                        03             001025
  1086         Finalpos += LastRRN;                                                                          03             001026
  1087       EndIf;                                                                                         E03             001027
  1088     EndIf;                                                                                           E02             001028
  1089   enddo;                                                                                             E01             001029
  1090                                                                                                                      001030
  1091 //*  exec sql                                                                                                        001031
  1092 //*    CLOSE TASK_CURSOR;                                                                                            001032
  1093           SQLER6 = 12;                                                          //SQL                                001033
  1094           IF SQL_00085 = 0;                                                     //SQL                B01             001034
  1095           SQLROUTE_CALL(                                                        //SQL                 01             001035
  1096                SQLCA                                                            //SQL                 01             001036
  1097              : SQL_00083                                                        //SQL                 01             001037
  1098           );                                                                    //SQL                 01             001038
  1099           ELSE;                                                                 //SQL                X01             001039
  1100           SQLCLSE_CALL(                                                         //SQL                 01             001040
  1101                SQLCA                                                            //SQL                 01             001041
  1102              : SQL_00083                                                        //SQL                 01             001042
  1103           );                                                                    //SQL                 01             001043
  1104           ENDIF;                                                                //SQL                E01             001044
  1105 end-proc;                                                                                                            001045
  1106                                                                                                                      001046
  1107                                                                                                                      001047
  1108                                                                                                                      001048
  1109                                                                                                                      001049
  1110                                                                                                                      001050
  1111                                                                                                                      001051
  1112                                                                                                                      001052
  1113 // --------------------------------------------------------------------------                                        001053
  1114 // This procedure assign the data fetched from cursor to subfile                                                     001054
  1115 // --------------------------------------------------------------------------                                        001055
  1116 Dcl-Proc DatatoSfl;                                                                                                  001056
  1117   taskrrn +=1;                                                                                                       001057
  1118   SFLTASKID = Ds_taskdata.Taskid;                                                                                    001058
  1119   SFLTASKNAM = Ds_taskdata.Nametask;                                                                                 001059
  1120   SFLSTRDATE = Ds_taskdata.Start_date;                                                                               001060
  1121   SFLENDDATE = Ds_taskdata.End_date;                                                                                 001061
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     26
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1122   SFLSTATE = Ds_taskdata.Taskstate;                                                                                  001062
  1123   write SFLTASK;                                                                                                     001063
  1124   clear SFLTASK;                                                                                                     001064
  1125 end-proc;                                                                                                            001065
  1126                                                                                                                      001066
  1127                                                                                                                      001067
  1128                                                                                                                      001068
  1129                                                                                                                      001069
  1130                                                                                                                      001070
  1131                                                                                                                      001071
  1132                                                                                                                      001072
  1133                                                                                                                      001073
  1134 // --------------------------------------------------------------------------                                        001074
  1135 // get total records                                                                                                 001075
  1136 // --------------------------------------------------------------------------                                        001076
  1137 Dcl-Proc Gettotalrecords;                                                                                            001077
  1138   Dcl-Pi Gettotalrecords zoned(10);                                                                                  001078
  1139   end-pi;                                                                                                            001079
  1140                                                                                                                      001080
  1141   Dcl-S w_Total zoned(10:0);                                                                                         001081
  1142                                                                                                                      001082
  1143   Dcl-S sqlcustomized char(500);                                                                                     001083
  1144                                                                                                                      001084
  1145        DCL-PR SQCALL000013 EXTPGM(SQLROUTE);                                    //SQL                                001085
  1146          CA LIKEDS(SQLCA);                                                      //SQL                                001086
  1147          P0001 LIKE(SQLCUSTOMIZED);                                             //SQL                                001087
  1148        END-PR SQCALL000013;                                                     //SQL                                001088
  1149 **END-FREE                                                                                                           001089
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  1150 D                 DS                  STATIC                               OPEN                                      001090
  1151 D  SQL_00089              1      2B 0 INZ(128)                             length of header                          001091
  1152 D  SQL_00090              3      4B 0 INZ(14)                              statement number                          001092
  1153 D  SQL_00091              5      8U 0 INZ(0)                               invocation mark                           001093
  1154 D  SQL_00092              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              001094
  1155 D  SQL_00093             10    127A   CCSID(*JOBRUNMIX)                    end of header                             001095
  1156 D  SQL_00094            128    128A   CCSID(*JOBRUNMIX)                    end of header                             001096
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1157 **FREE                                                                                                               001097
  1158 **END-FREE                                                                                                           001098
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  1159 D                 DS                  STATIC                               FETCH                                     001099
  1160 D  SQL_00095              1      2B 0 INZ(128)                             length of header                          001100
  1161 D  SQL_00096              3      4B 0 INZ(15)                              statement number                          001101
  1162 D  SQL_00097              5      8U 0 INZ(0)                               invocation mark                           001102
  1163 D  SQL_00098              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              001103
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     27
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  1164 D  SQL_00099             10    127A   CCSID(*JOBRUNMIX)                    end of header                             001104
  1165 D  SQL_00100            129    138S 0                                      W_TOTAL                                   001105
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1166 **FREE                                                                                                               001106
  1167 **END-FREE                                                                                                           001107
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  1168 D                 DS                  STATIC                               CLOSE                                     001108
  1169 D  SQL_00101              1      2B 0 INZ(128)                             length of header                          001109
  1170 D  SQL_00102              3      4B 0 INZ(16)                              statement number                          001110
  1171 D  SQL_00103              5      8U 0 INZ(0)                               invocation mark                           001111
  1172 D  SQL_00104              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              001112
  1173 D  SQL_00105             10    127A   CCSID(*JOBRUNMIX)                    end of header                             001113
  1174 D  SQL_00106            128    128A   CCSID(*JOBRUNMIX)                    end of header                             001114
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1175 **FREE                                                                                                               001115
  1176   sqlcustomized = 'SELECT COUNT(*) '+                                                                                001116
  1177          'FROM (SELECT A.*, RowNumber() Over() as RNum FROM '+                                                       001117
  1178          'CRUD01TBL AS A Where 1=1) as Tbl Where RNum '+                                                             001118
  1179          'BetWeen '+%char(Previnitialpos)+' and '+%char(PrevFinalpos) +                                              001119
  1180          ' '+%trim(w_Wheresfl);                                                                                      001120
  1181                                                                                                                      001121
  1182 //*  exec sql                                                                                                        001122
  1183 //*    PREPARE QRY FROM: sqlcustomized;                                                                              001123
  1184           SQLER6 = 13;                                                          //SQL                                001124
  1185           SQCALL000013(                                                         //SQL                                001125
  1186                SQLCA                                                            //SQL                                001126
  1187              : SQLCUSTOMIZED                                                    //SQL                                001127
  1188           );                                                                    //SQL                                001128
  1189                                                                                                                      001129
  1190 //*  exec sql                                                                                                        001130
  1191 //*    DECLARE QRYC CURSOR FOR QRY;                                                                                  001131
  1192                                                                                                                      001132
  1193 //*  exec sql                                                                                                        001133
  1194 //*    OPEN QRYC;                                                                                                    001134
  1195           SQLER6 = -4;                                                          //SQL                                001135
  1196           IF SQL_00091 = 0                                                      //SQL                B01             001136
  1197           OR SQL_00092 <> *LOVAL;                                               //SQL                B01             001137
  1198           SQLROUTE_CALL(                                                        //SQL                 01             001138
  1199                SQLCA                                                            //SQL                 01             001139
  1200              : SQL_00089                                                        //SQL                 01             001140
  1201           );                                                                    //SQL                 01             001141
  1202           ELSE;                                                                 //SQL                X01             001142
  1203           SQLOPEN_CALL(                                                         //SQL                 01             001143
  1204                SQLCA                                                            //SQL                 01             001144
  1205              : SQL_00089                                                        //SQL                 01             001145
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     28
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1206           );                                                                    //SQL                 01             001146
  1207           ENDIF;                                                                //SQL                E01             001147
  1208                                                                                                                      001148
  1209 //*  exec sql                                                                                                        001149
  1210 //*    FETCH QRYC INTO:w_Total;                                                                                      001150
  1211           SQLER6 = -4;                                                          //SQL 15                             001151
  1212           SQLROUTE_CALL(                                                        //SQL                                001152
  1213                SQLCA                                                            //SQL                                001153
  1214              : SQL_00095                                                        //SQL                                001154
  1215           );                                                                    //SQL                                001155
  1216           IF SQL_00098 = '1';                                                   //SQL                B01             001156
  1217           EVAL W_TOTAL = SQL_00100;                                             //SQL                 01             001157
  1218           ENDIF;                                                                //SQL                E01             001158
  1219                                                                                                                      001159
  1220 //*  exec sql                                                                                                        001160
  1221 //*    CLOSE QRYC;                                                                                                   001161
  1222           SQLER6 = 16;                                                          //SQL                                001162
  1223           IF SQL_00103 = 0;                                                     //SQL                B01             001163
  1224           SQLROUTE_CALL(                                                        //SQL                 01             001164
  1225                SQLCA                                                            //SQL                 01             001165
  1226              : SQL_00101                                                        //SQL                 01             001166
  1227           );                                                                    //SQL                 01             001167
  1228           ELSE;                                                                 //SQL                X01             001168
  1229           SQLCLSE_CALL(                                                         //SQL                 01             001169
  1230                SQLCA                                                            //SQL                 01             001170
  1231              : SQL_00101                                                        //SQL                 01             001171
  1232           );                                                                    //SQL                 01             001172
  1233           ENDIF;                                                                //SQL                E01             001173
  1234                                                                                                                      001174
  1235   Return w_Total;                                                                                                    001175
  1236 end-proc;                                                                                                            001176
  1237                                                                                                                      001177
  1238                                                                                                                      001178
  1239                                                                                                                      001179
  1240                                                                                                                      001180
  1241                                                                                                                      001181
  1242                                                                                                                      001182
  1243                                                                                                                      001183
  1244                                                                                                                      001184
  1245 // --------------------------------------------------------------------------                                        001185
  1246 // run the CRUD                                                                                                      001186
  1247 // --------------------------------------------------------------------------                                        001187
  1248 Dcl-Proc ExecuteCrudScreen;                                                                                          001188
  1249   Dcl-Pi ExecuteCrudScreen;                                                                                          001189
  1250     p_choice char(1);                                                                                                001190
  1251   end-pi;                                                                                                            001191
  1252                                                                                                                      001192
  1253   If (p_choice = 'I'); // Insert Screen                                                              B01             001193
  1254     InsertScreen(p_choice);                                                                           01             001194
  1255   EndIf;                                                                                             E01             001195
  1256                                                                                                                      001196
  1257   If (p_choice = 'M'); // Modify Screen                                                              B01             001197
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     29
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1258     ModifyScreen(p_choice);                                                                           01             001198
  1259   EndIf;                                                                                             E01             001199
  1260                                                                                                                      001200
  1261   If (p_choice = 'D'); // Delete Screen                                                              B01             001201
  1262     DeleteScreen(p_choice);                                                                           01             001202
  1263   EndIf;                                                                                             E01             001203
  1264                                                                                                                      001204
  1265   If (p_choice = 'V'); // View Screen                                                                B01             001205
  1266     ViewScreen(p_choice);                                                                             01             001206
  1267   EndIf;                                                                                             E01             001207
  1268 end-proc;                                                                                                            001208
  1269                                                                                                                      001209
  1270                                                                                                                      001210
  1271                                                                                                                      001211
  1272                                                                                                                      001212
  1273                                                                                                                      001213
  1274                                                                                                                      001214
  1275                                                                                                                      001215
  1276 // --------------------------------------------------------------------------                                        001216
  1277 // write the screen                                                                                                  001217
  1278 // --------------------------------------------------------------------------                                        001218
  1279 Dcl-Proc InsertScreen;                                                                                               001219
  1280   Dcl-Pi InsertScreen;                                                                                               001220
  1281     p_choice char(1);                                                                                                001221
  1282   end-pi;                                                                                                            001222
  1283                                                                                                                      001223
  1284   Dcl-S choice char(1);                                                                                              001224
  1285                                                                                                                      001225
  1286 **END-FREE                                                                                                           001226
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  1287 D                 DS                  STATIC                               INSERT                                    001227
  1288 D  SQL_00107              1      2B 0 INZ(128)                             length of header                          001228
  1289 D  SQL_00108              3      4B 0 INZ(17)                              statement number                          001229
  1290 D  SQL_00109              5      8U 0 INZ(0)                               invocation mark                           001230
  1291 D  SQL_00110              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              001231
  1292 D  SQL_00111             10    127A   CCSID(*JOBRUNMIX)                    end of header                             001232
  1293 D  SQL_00112            129    138S 0                                      DS_DATACRUD.TASK_ID                       001233
  1294 D  SQL_00113            139    150A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.NAME                          001234
  1295 D  SQL_00114            151    302A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.DESCR                         001235
  1296 D  SQL_00115            303    454A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.ENDDES                        001236
  1297 D  SQL_00116            455    462S 0                                      DS_DATACRUD.STARTDAT                      001237
  1298 D  SQL_00117            463    470S 0                                      DS_DATACRUD.ENDDATE                       001238
  1299 D  SQL_00118            471    471S 0                                      DS_DATACRUD.STATE                         001239
  1300 D  SQL_00119            472    483A   VARYING CCSID(*JOBRUNMIX)            DS_DATACRUD.OWNER                         001240
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1301 **FREE                                                                                                               001241
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     30
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1302   WriteScreen(p_choice);                                                                                             001242
  1303                                                                                                                      001243
  1304   dow (not PFKEY03);                                                                                 B01             001244
  1305     ProtectFields_35 = *Off;                                                                          01             001245
  1306     ProtectFields_36 = *Off;                                                                          01             001246
  1307     exfmt CRUDTASK;                                                                                   01             001247
  1308     Select;                                                                                          B02             001248
  1309       When (PFKEY03);                                                                                X02             001249
  1310         clear CRUDTASK;                                                                               02             001250
  1311         reset Initialpos;                                                                             02             001251
  1312         reset Finalpos;                                                                               02             001252
  1313         PFKEY03 = *Off;                                                                               02             001253
  1314         choice = 'S';                                                                                 02             001254
  1315         ShowScreen(choice);                                                                           02             001255
  1316         leave;                                                                                        02             001256
  1317       When (pfkey(10));                                                                              X02             001257
  1318         If (ScreenValidation(p_choice) = *Off);                                                      B03             001258
  1319                                                                                                                      001259
  1320           // Executes window confirmation                                                                            001260
  1321           choice = 'C';                                                                               03             001261
  1322           ShowWdw(choice);                                                                            03             001262
  1323           If (WDWCHOICE = 'Y');                                                                      B04             001263
  1324             LoaddatatoDs();                                                                           04             001264
  1325                                                                                                                      001265
  1326 //*            exec sql                                                                                              001266
  1327 //*            INSERT INTO CRUD01TBL                                                                                 001267
  1328 //*              VALUES (:Ds_datacrud);                                                                              001268
  1329           SQL_00112 = DS_DATACRUD.TASK_ID;                                      //SQL                 04             001269
  1330           SQL_00113 = DS_DATACRUD.NAME;                                         //SQL                 04             001270
  1331           SQL_00114 = DS_DATACRUD.DESCR;                                        //SQL                 04             001271
  1332           SQL_00115 = DS_DATACRUD.ENDDES;                                       //SQL                 04             001272
  1333           SQL_00116 = DS_DATACRUD.STARTDATE;                                    //SQL                 04             001273
  1334           SQL_00117 = DS_DATACRUD.ENDDATE;                                      //SQL                 04             001274
  1335           SQL_00118 = DS_DATACRUD.STATE;                                        //SQL                 04             001275
  1336           SQL_00119 = DS_DATACRUD.OWNER;                                        //SQL                 04             001276
  1337           SQLER6 = -4;                                                          //SQL 17              04             001277
  1338           SQLROUTE_CALL(                                                        //SQL                 04             001278
  1339                SQLCA                                                            //SQL                 04             001279
  1340              : SQL_00107                                                        //SQL                 04             001280
  1341           );                                                                    //SQL                 04             001281
  1342                                                                                                                      001282
  1343             If (xSQLState = SUCCESS_ON_SQL);                                                         B05             001283
  1344               choice = 'M'; // Message of successful                                                  05             001284
  1345               ShowWdw(choice);                                                                        05             001285
  1346               clear CRUDTASK;                                                                         05             001286
  1347               reset Initialpos;                                                                       05             001287
  1348               reset Finalpos;                                                                         05             001288
  1349               choice = 'S';                                                                           05             001289
  1350               ShowScreen(choice);                                                                     05             001290
  1351               leave;                                                                                  05             001291
  1352             Else;                                                                                    X05             001292
  1353               choice = 'E'; // Error Message                                                          05             001293
  1354               ShowWdw(choice);                                                                        05             001294
  1355             EndIf;                                                                                   E05             001295
  1356           Else ;                                                                                     X04             001296
  1357             clear CRUDTASK;                                                                           04             001297
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     31
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1358           EndIf;                                                                                     E04             001298
  1359         EndIf;                                                                                       E03             001299
  1360                                                                                                                      001300
  1361       Other;                                                                                         X02             001301
  1362         If (ScreenValidation(p_choice) = *On);                                                       B03             001302
  1363           iter;                                                                                       03             001303
  1364         EndIf ;                                                                                      E03             001304
  1365     EndSl;                                                                                           E02             001305
  1366   enddo;                                                                                             E01             001306
  1367 end-proc;                                                                                                            001307
  1368                                                                                                                      001308
  1369                                                                                                                      001309
  1370                                                                                                                      001310
  1371 // --------------------------------------------------------------------------                                        001311
  1372 // modify screen                                                                                                     001312
  1373 // --------------------------------------------------------------------------                                        001313
  1374 Dcl-Proc ModifyScreen;                                                                                               001314
  1375   Dcl-Pi ModifyScreen;                                                                                               001315
  1376     p_choice char(1);                                                                                                001316
  1377   end-pi;                                                                                                            001317
  1378                                                                                                                      001318
  1379   Dcl-S choice char(1);                                                                                              001319
  1380                                                                                                                      001320
  1381 **END-FREE                                                                                                           001321
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  1382 D                 DS                  STATIC                               UPDATE                                    001322
  1383 D  SQL_00120              1      2B 0 INZ(128)                             length of header                          001323
  1384 D  SQL_00121              3      4B 0 INZ(18)                              statement number                          001324
  1385 D  SQL_00122              5      8U 0 INZ(0)                               invocation mark                           001325
  1386 D  SQL_00123              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              001326
  1387 D  SQL_00124             10    127A   CCSID(*JOBRUNMIX)                    end of header                             001327
  1388 D  SQL_00125            129    138A   CCSID(*JOBRUNMIX)                    NAMETASK                                  001328
  1389 D  SQL_00126            139    288A   CCSID(*JOBRUNMIX)                    DESCRP                                    001329
  1390 D  SQL_00127            289    438A   CCSID(*JOBRUNMIX)                    SOLUTION                                  001330
  1391 D  SQL_00128            439    443P 0 PACKEVEN                             STARTDATE                                 001331
  1392 D  SQL_00129            444    448P 0 PACKEVEN                             ENDDATE                                   001332
  1393 D  SQL_00130            449    449P 0                                      STATETASK                                 001333
  1394 D  SQL_00131            450    459A   CCSID(*JOBRUNMIX)                    CURRENTUSER                               001334
  1395 D  SQL_00132            460    465P 0 PACKEVEN                             CRUDTASKID                                001335
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1396 **FREE                                                                                                               001336
  1397   LoaddatatoScreen();                                                                                                001337
  1398   WriteScreen(p_choice);                                                                                             001338
  1399                                                                                                                      001339
  1400   dow (not PFKEY03);                                                                                 B01             001340
  1401     ProtectFields_35 = *On;                                                                           01             001341
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     32
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1402     exfmt CRUDTASK;                                                                                   01             001342
  1403     Select;                                                                                          B02             001343
  1404       When (PFKEY03);                                                                                X02             001344
  1405         ProtectFields_35 = *Off;                                                                      02             001345
  1406         clear CRUDTASK;                                                                               02             001346
  1407         clear OPCTASK;                                                                                02             001347
  1408         PFKEY03 = *Off;                                                                               02             001348
  1409         w_Crudfinalize = *On ;                                                                        02             001349
  1410         reset Initialpos;                                                                             02             001350
  1411         reset Finalpos;                                                                               02             001351
  1412         choice = 'S';                                                                                 02             001352
  1413         ShowScreen(choice);                                                                           02             001353
  1414         leave;                                                                                        02             001354
  1415       When (pfkey(10));                                                                              X02             001355
  1416         If (ScreenValidation(p_choice) = *Off);                                                      B03             001356
  1417                                                                                                                      001357
  1418           // Executes window confirmation                                                                            001358
  1419           choice = 'C';                                                                               03             001359
  1420           ShowWdw(choice);                                                                            03             001360
  1421           If (WDWCHOICE = 'Y');                                                                      B04             001361
  1422                                                                                                                      001362
  1423 //*            exec sql                                                                                              001363
  1424 //*            UPDATE CRUD01TBL                                                                                      001364
  1425 //*              SET NAME = :NAMETASK,                                                                               001365
  1426 //*                  DESCR = :DESCRP,                                                                                001366
  1427 //*                  ENDDES = :SOLUTION,                                                                             001367
  1428 //*                  STARTDATE = :STARTDATE,                                                                         001368
  1429 //*                  ENDDATE = :ENDDATE,                                                                             001369
  1430 //*                  STATE = :STATETASK,                                                                             001370
  1431 //*                  OWNER = :CurrentUser                                                                            001371
  1432 //*              WHERE TASK_ID = : CRUDTASKID;                                                                       001372
  1433           SQL_00125 = NAMETASK;                                                 //SQL                 04             001373
  1434           SQL_00126 = DESCRP;                                                   //SQL                 04             001374
  1435           SQL_00127 = SOLUTION;                                                 //SQL                 04             001375
  1436           SQL_00128 = STARTDATE;                                                //SQL                 04             001376
  1437           SQL_00129 = ENDDATE;                                                  //SQL                 04             001377
  1438           SQL_00130 = STATETASK;                                                //SQL                 04             001378
  1439           SQL_00131 = CURRENTUSER;                                              //SQL                 04             001379
  1440           SQL_00132 = CRUDTASKID;                                               //SQL                 04             001380
  1441           SQLER6 = -4;                                                          //SQL 18              04             001381
  1442           SQLROUTE_CALL(                                                        //SQL                 04             001382
  1443                SQLCA                                                            //SQL                 04             001383
  1444              : SQL_00120                                                        //SQL                 04             001384
  1445           );                                                                    //SQL                 04             001385
  1446                                                                                                                      001386
  1447             If (xSQLState = SUCCESS_ON_SQL);                                                         B05             001387
  1448               choice = 'M'; // Message of successful                                                  05             001388
  1449               ShowWdw(choice);                                                                        05             001389
  1450               clear CRUDTASK;                                                                         05             001390
  1451               clear OPCTASK;                                                                          05             001391
  1452               reset Initialpos;                                                                       05             001392
  1453               reset Finalpos;                                                                         05             001393
  1454               choice = 'S';                                                                           05             001394
  1455               ShowScreen(choice);                                                                     05             001395
  1456               w_Crudfinalize = *On ;                                                                  05             001396
  1457               leave;                                                                                  05             001397
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     33
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1458             Else;                                                                                    X05             001398
  1459               choice = 'E'; // Error Message                                                          05             001399
  1460               ShowWdw(choice);                                                                        05             001400
  1461             EndIf;                                                                                   E05             001401
  1462           Else ;                                                                                     X04             001402
  1463             clear CRUDTASK;                                                                           04             001403
  1464           EndIf;                                                                                     E04             001404
  1465         EndIf;                                                                                       E03             001405
  1466                                                                                                                      001406
  1467       Other;                                                                                         X02             001407
  1468         If (ScreenValidation(p_choice) = *On);                                                       B03             001408
  1469           iter;                                                                                       03             001409
  1470         EndIf ;                                                                                      E03             001410
  1471     EndSl;                                                                                           E02             001411
  1472   enddo;                                                                                             E01             001412
  1473 end-proc;                                                                                                            001413
  1474                                                                                                                      001414
  1475                                                                                                                      001415
  1476                                                                                                                      001416
  1477                                                                                                                      001417
  1478                                                                                                                      001418
  1479                                                                                                                      001419
  1480                                                                                                                      001420
  1481                                                                                                                      001421
  1482 // --------------------------------------------------------------------------                                        001422
  1483 // delete screen                                                                                                     001423
  1484 // --------------------------------------------------------------------------                                        001424
  1485 Dcl-Proc DeleteScreen;                                                                                               001425
  1486   Dcl-Pi DeleteScreen;                                                                                               001426
  1487     p_choice char(1);                                                                                                001427
  1488   end-pi;                                                                                                            001428
  1489                                                                                                                      001429
  1490   Dcl-S choice char(1);                                                                                              001430
  1491                                                                                                                      001431
  1492 **END-FREE                                                                                                           001432
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  1493 D                 DS                  STATIC                               DELETE                                    001433
  1494 D  SQL_00133              1      2B 0 INZ(128)                             length of header                          001434
  1495 D  SQL_00134              3      4B 0 INZ(19)                              statement number                          001435
  1496 D  SQL_00135              5      8U 0 INZ(0)                               invocation mark                           001436
  1497 D  SQL_00136              9      9A   INZ('0') CCSID(*JOBRUNMIX)           data is okay                              001437
  1498 D  SQL_00137             10    127A   CCSID(*JOBRUNMIX)                    end of header                             001438
  1499 D  SQL_00138            129    134P 0 PACKEVEN                             CRUDTASKID                                001439
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1500 **FREE                                                                                                               001440
  1501   LoaddatatoScreen();                                                                                                001441
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     34
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1502   WriteScreen(p_choice);                                                                                             001442
  1503                                                                                                                      001443
  1504   dow (not PFKEY03);                                                                                 B01             001444
  1505     ProtectFields_35 = *On;                                                                           01             001445
  1506     ProtectFields_36 = *On;                                                                           01             001446
  1507     exfmt CRUDTASK;                                                                                   01             001447
  1508     Select;                                                                                          B02             001448
  1509       When (PFKEY03);                                                                                X02             001449
  1510         ProtectFields_35 = *Off;                                                                      02             001450
  1511         ProtectFields_36 = *Off;                                                                      02             001451
  1512         clear CRUDTASK;                                                                               02             001452
  1513         clear OPCTASK;                                                                                02             001453
  1514         PFKEY03 = *Off;                                                                               02             001454
  1515         w_Crudfinalize = *On ;                                                                        02             001455
  1516         reset Initialpos;                                                                             02             001456
  1517         reset Finalpos;                                                                               02             001457
  1518         choice = 'S';                                                                                 02             001458
  1519         ShowScreen(choice);                                                                           02             001459
  1520         leave;                                                                                        02             001460
  1521       When (pfkey(10));                                                                              X02             001461
  1522         If (ScreenValidation(p_choice) = *Off);                                                      B03             001462
  1523                                                                                                                      001463
  1524           // Executes window confirmation                                                                            001464
  1525           choice = 'C';                                                                               03             001465
  1526           ShowWdw(choice);                                                                            03             001466
  1527           If (WDWCHOICE = 'Y');                                                                      B04             001467
  1528                                                                                                                      001468
  1529 //*            exec sql                                                                                              001469
  1530 //*            DELETE FROM CRUD01TBL WHERE TASK_ID = : CRUDTASKID;                                                   001470
  1531           SQL_00138 = CRUDTASKID;                                               //SQL                 04             001471
  1532           SQLER6 = -4;                                                          //SQL 19              04             001472
  1533           SQLROUTE_CALL(                                                        //SQL                 04             001473
  1534                SQLCA                                                            //SQL                 04             001474
  1535              : SQL_00133                                                        //SQL                 04             001475
  1536           );                                                                    //SQL                 04             001476
  1537                                                                                                                      001477
  1538             If (xSQLState = SUCCESS_ON_SQL);                                                         B05             001478
  1539               ShowWdw(p_choice);                                                                      05             001479
  1540               clear CRUDTASK;                                                                         05             001480
  1541               clear OPCTASK;                                                                          05             001481
  1542               reset Initialpos;                                                                       05             001482
  1543               reset Finalpos;                                                                         05             001483
  1544               choice = 'S';                                                                           05             001484
  1545               ShowScreen(choice);                                                                     05             001485
  1546               w_Crudfinalize = *On ;                                                                  05             001486
  1547               leave;                                                                                  05             001487
  1548             Else;                                                                                    X05             001488
  1549               choice = 'E'; // Error Message                                                          05             001489
  1550               ShowWdw(choice);                                                                        05             001490
  1551             EndIf;                                                                                   E05             001491
  1552           Else ;                                                                                     X04             001492
  1553             clear CRUDTASK;                                                                           04             001493
  1554           EndIf;                                                                                     E04             001494
  1555         EndIf;                                                                                       E03             001495
  1556                                                                                                                      001496
  1557       Other;                                                                                         X02             001497
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     35
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1558         If (ScreenValidation(p_choice) = *On);                                                       B03             001498
  1559           iter;                                                                                       03             001499
  1560         EndIf ;                                                                                      E03             001500
  1561     EndSl;                                                                                           E02             001501
  1562   enddo;                                                                                             E01             001502
  1563 end-proc;                                                                                                            001503
  1564                                                                                                                      001504
  1565                                                                                                                      001505
  1566                                                                                                                      001506
  1567                                                                                                                      001507
  1568                                                                                                                      001508
  1569                                                                                                                      001509
  1570                                                                                                                      001510
  1571 // --------------------------------------------------------------------------                                        001511
  1572 // view the screen                                                                                                   001512
  1573 // --------------------------------------------------------------------------                                        001513
  1574 Dcl-Proc ViewScreen;                                                                                                 001514
  1575   Dcl-Pi ViewScreen;                                                                                                 001515
  1576     p_choice char(1);                                                                                                001516
  1577   end-pi;                                                                                                            001517
  1578                                                                                                                      001518
  1579   Dcl-S choice char(1);                                                                                              001519
  1580                                                                                                                      001520
  1581   LoaddatatoScreen();                                                                                                001521
  1582   WriteScreen(p_choice);                                                                                             001522
  1583                                                                                                                      001523
  1584   dow (not PFKEY03);                                                                                 B01             001524
  1585     ProtectFields_35 = *On;                                                                           01             001525
  1586     ProtectFields_36 = *On;                                                                           01             001526
  1587     exfmt CRUDTASK;                                                                                   01             001527
  1588     If (PFKEY03);                                                                                    B02             001528
  1589       ProtectFields_35 = *Off;                                                                        02             001529
  1590       ProtectFields_36 = *Off;                                                                        02             001530
  1591       clear CRUDTASK;                                                                                 02             001531
  1592       clear OPCTASK;                                                                                  02             001532
  1593       PFKEY03 = *Off;                                                                                 02             001533
  1594       w_Crudfinalize = *On ;                                                                          02             001534
  1595       reset Initialpos;                                                                               02             001535
  1596       reset Finalpos;                                                                                 02             001536
  1597       choice = 'S';                                                                                   02             001537
  1598       ShowScreen(choice);                                                                             02             001538
  1599       leave;                                                                                          02             001539
  1600     EndIf;                                                                                           E02             001540
  1601   enddo;                                                                                             E01             001541
  1602 end-proc;                                                                                                            001542
  1603                                                                                                                      001543
  1604                                                                                                                      001544
  1605                                                                                                                      001545
  1606                                                                                                                      001546
  1607                                                                                                                      001547
  1608                                                                                                                      001548
  1609                                                                                                                      001549
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     36
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1610                                                                                                                      001550
  1611 // --------------------------------------------------------------------------                                        001551
  1612 // load screen data                                                                                                  001552
  1613 // --------------------------------------------------------------------------                                        001553
  1614 Dcl-Proc LoaddatatoScreen;                                                                                           001554
  1615   clear CRUDTASK;                                                                                                    001555
  1616   CRUDTASKID = Ds_datacrud.Task_id;                                                                                  001556
  1617   NAMETASK = Ds_datacrud.Name;                                                                                       001557
  1618   DESCRP = Ds_datacrud.Descr;                                                                                        001558
  1619   SOLUTION = Ds_datacrud.Enddes;                                                                                     001559
  1620   STARTDATE = Ds_datacrud.Startdate;                                                                                 001560
  1621   ENDDATE = Ds_datacrud.Enddate;                                                                                     001561
  1622   STATETASK = Ds_datacrud.State;                                                                                     001562
  1623 end-proc ;                                                                                                           001563
  1624                                                                                                                      001564
  1625                                                                                                                      001565
  1626                                                                                                                      001566
  1627                                                                                                                      001567
  1628                                                                                                                      001568
  1629                                                                                                                      001569
  1630                                                                                                                      001570
  1631                                                                                                                      001571
  1632                                                                                                                      001572
  1633 // --------------------------------------------------------------------------                                        001573
  1634 // load data to data structure                                                                                       001574
  1635 // --------------------------------------------------------------------------                                        001575
  1636 Dcl-Proc LoaddatatoDs;                                                                                               001576
  1637   clear Ds_datacrud;                                                                                                 001577
  1638   Ds_datacrud.Task_id = CRUDTASKID;                                                                                  001578
  1639   Ds_datacrud.Name = %trim(NAMETASK);                                                                                001579
  1640   Ds_datacrud.Descr = %trim(DESCRP);                                                                                 001580
  1641   Ds_datacrud.Enddes = %trim(SOLUTION);                                                                              001581
  1642   Ds_datacrud.Startdate = STARTDATE;                                                                                 001582
  1643   Ds_datacrud.Enddate = ENDDATE;                                                                                     001583
  1644   Ds_datacrud.State = STATETASK;                                                                                     001584
  1645   Ds_datacrud.Owner = CurrentUser;                                                                                   001585
  1646 end-proc;                                                                                                            001586
       * * * * *   E N D   O F   S O U R C E   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     37
          A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
 Msg id  Sv Number Seq     Message text
*RNF7089 00      8 000008  RPG provides Separate-Indicator area for file CRUD01PNL.
*RNF7030 30    661 000601  The name or indicator PFKEY is not defined.
*RNF7421 30    599 000539  Operands are not compatible with the type of operator.
*RNF7423 30    605 000545  A relational expression or indicator is expected for
                           logical operations.
*RNF7418 30    606 000546  The result field used in the EVAL operation cannot be
                           modified.
*RNF7503 30    661 000601  Expression contains an operand that is not defined.
*RNF7503 30    668 000608  Expression contains an operand that is not defined.
*RNF7421 30   1304 001244  Operands are not compatible with the type of operator.
*RNF7423 30   1309 001249  A relational expression or indicator is expected for
                           logical operations.
*RNF7418 30   1313 001253  The result field used in the EVAL operation cannot be
                           modified.
*RNF7503 30   1317 001257  Expression contains an operand that is not defined.
*RNF7421 30   1400 001340  Operands are not compatible with the type of operator.
*RNF7423 30   1404 001344  A relational expression or indicator is expected for
                           logical operations.
*RNF7418 30   1408 001348  The result field used in the EVAL operation cannot be
                           modified.
*RNF7503 30   1415 001355  Expression contains an operand that is not defined.
*RNF7421 30   1504 001444  Operands are not compatible with the type of operator.
*RNF7423 30   1509 001449  A relational expression or indicator is expected for
                           logical operations.
*RNF7418 30   1514 001454  The result field used in the EVAL operation cannot be
                           modified.
*RNF7503 30   1521 001461  Expression contains an operand that is not defined.
*RNF7421 30   1584 001524  Operands are not compatible with the type of operator.
*RNF7423 30   1588 001528  A relational expression or indicator is expected for
                           logical operations.
*RNF7418 30   1593 001533  The result field used in the EVAL operation cannot be
                           modified.
 * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                 O u t p u t   B u f f e r   P o s i t i o n s
Line   Start End   Field or Constant
Number Pos   Pos
   319     1    50 TITLE1
   320    51   100 TITLE2
   321   101   150 TITLE3
   319     1    50 TITLE1
   320    51   100 TITLE2
   321   101   150 TITLE3
   323     1    50 FOOTTEXT
   323     1    50 FOOTTEXT
   325     1     1 OPCTASK
   326     2    11 SFLTASKID
   327    12    21 SFLTASKNAM
   328    22    29 SFLSTRDATE
   329    30    37 SFLENDDATE
   330    38    39 SFLSTATE
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     38
   325     1     1 OPCTASK
   326     2    11 SFLTASKID
   327    12    21 SFLTASKNAM
   328    22    29 SFLSTRDATE
   329    30    37 SFLENDDATE
   330    38    39 SFLSTATE
   333     1    10 CRUDTASKID
   334    11    20 NAMETASK
   335    21   170 DESCRP
   336   171   320 SOLUTION
   337   321   328 STARTDATE
   338   329   336 ENDDATE
   339   337   337 STATETASK
   333     1    10 CRUDTASKID
   334    11    20 NAMETASK
   335    21   170 DESCRP
   336   171   320 SOLUTION
   337   321   328 STARTDATE
   338   329   336 ENDDATE
   339   337   337 STATETASK
   342     1    40 WDWTEXT1
   343    41    80 WDWTEXT2
   344    81    81 WDWCHOICE
   342     1    40 WDWTEXT1
   343    41    80 WDWTEXT2
   344    81    81 WDWCHOICE
   346     1    40 WDWMSG1
   347    41    80 WDWMSG2
   346     1    40 WDWMSG1
   347    41    80 WDWMSG2
 * * * * *   E N D   O F   O U T P U T   B U F F E R   P O S I T I O N   *  * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     39
                          C r o s s   R e f e r e n c e
      File and Record References:
         File              Device             References (D=Defined)
           Record
         CRUD01PNL         WORKSTN                 8D    352     360
           HEADER                                  8D    296     318     409
           FOOTER                                  8D    297     322     410
           SFLTASK                                 8D    298     324     678
                                                 770    1123    1124M
           SFLTASKCTL                              8D    305     331     602
                                                 911
           CRUDTASK                                8D    306     332    1307
                                                1310M   1346M   1357M   1402
                                                1406M   1450M   1463M   1507
                                                1512M   1540M   1553M   1587
                                                1591M   1615M
           EMPTY                                   8D    314     340     936
           WDWCONFIRM                              8D    315     341     465
                                                 466
           WDWMESSAGE                              8D    317     345     472
                                                 477     483
      Global Field References:
         Field             Attributes         References (D=Defined M=Modified)
         *IN(99)           N(1)                  149
         *INLR             N(1)                  361M
         ACTIVATESUBFILE   PROTOTYPE             601M    927
         CENTER            A(80)                 378     379     386     388
                           PROTOTYPE             390     392     396     501
                                                 502
*RNF7031 CLEAR             CONST                 145D
         CRUDTASKID        P(10,0)               307M    333     826    1440
                                                1531    1616M   1638
         CURRENTUSER       A(10)                 221D   1439    1645
         DATATOSFL         PROTOTYPE            1066M   1116
         DATEGREATERTHANERROR_34...
                           N(1)                  160D    850M    872M
         DELETESCREEN      PROTOTYPE             440M   1262M   1485    1486
         DESCRP            A(150)                309M    335    1434    1618M
                                                1640
*RNF7031 DISPLAYINDICATORS DS(99)                150D
                           BASED(PTRDISPLA+)
         DS_DATACRUD       DS(355)               189D    684M    698M    699M
                                                 700M    701M    702M    703M
                                                 704M    705M    712M    726M
                                                 727M    728M    729M    730M
                                                 731M    732M    733M    740M
                                                 754M    755M    756M    757M
                                                 758M    759M    760M    761M
                                                1329    1330    1331    1332
                                                1333    1334    1335    1336
                                                1616    1617    1618    1619
                                                1620    1621    1622    1637M
                                                1638M   1639M   1640M   1641M
                                                1642M   1643M   1644M   1645M
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     40
           DESCR           A(150)                192D    700     728     756
                           VARYING(2)           1331    1618    1640
           ENDDATE         S(8,0)                195D    703     731     759
                                                1334    1621    1643
           ENDDES          A(150)                193D    701     729     757
                           VARYING(2)           1332    1619    1641
                           ALWNULL
           NAME            A(10)                 191D    699     727     755
                           VARYING(2)           1330    1617    1639
           OWNER           A(10)                 197D    705     733     761
                           VARYING(2)           1336    1645
           STARTDATE       S(8,0)                194D    702     730     758
                                                1333    1620    1642
           STATE           S(1,0)                196D    704     732     760
                                                1335    1622    1644
           TASK_ID         S(10,0)               190D    698     726     754
                                                1329    1616    1638
*RNF7031 DS_SQLSTATE       DS(2)                 169D
                           BASED(PSQLSTATE)
         DS_TASKDATA       DS(47)                180D   1017M   1054M   1055M
                                                1056M   1057M   1058M   1077M
                                                1078M   1079M   1080M   1081M
                                                1118    1119    1120    1121
                                                1122
           END_DATE        S(8,0)                184D   1057    1080    1121
           NAMETASK        A(20)                 182D   1055    1078    1119
           START_DATE      S(8,0)                183D   1056    1079    1120
           TASKID          S(10,0)               181D   1054    1077    1118
           TASKSTATE       S(1,0)                185D   1058    1081    1122
         ENDDATE           P(8,0)                312M    338     843     847
                                                 849    1437    1621M   1643
         ENDDATEERROR_33   N(1)                  159D    845M    848     871M
*RNF7031 ENTER             CONST                 115D
         EXECUTECRUDSCREEN PROTOTYPE            1248    1249
         FILLSFL           PROTOTYPE             897M    952     953
         FINALPOS          S(10,0)               204D    608M    611     613
                                                 615M    622     638     650M
                                                 664M    894    1015    1086M
                                                1312M   1348M   1411M   1453M
                                                1517M   1543M   1596M
         FOOTTEXT          A(50)                 323     402M    404M    406M
         GETTOTALRECORDS   S(10,0)               931    1137    1138
                           PROTOTYPE
*RNF7031 HELP              CONST                 116D
         INDERRORS         A(20)                 163D    814M    855
         INFDS             DS(400)                 8      14D    108     109
                                                 110     610     620
*RNF7031   ACCESSTYPE      A(2)                   61D
*RNF7031   ACQUIRESTATUS   A(1)                   70D
*RNF7031   ACTUALCURSOR    A(2)                   55D
*RNF7031   ALLOWBLINK      A(1)                   73D
*RNF7031   BLOCKINCREMENT  I(5,0)                 66D
*RNF7031   CCSID           I(5,0)                 26D
*RNF7031   COLORCAPABLE    A(1)                   79D
*RNF7031   CONTROLLERINFO  A(1)                   78D
*RNF7031   CURRENTLINE     I(5,0)                 43D
*RNF7031   CURRENTOPERATIONS...
                           A(1)                   92D
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     41
*RNF7031   CURRENTPAGE     I(10,0)                44D
*RNF7031   DATAAVAILABLE   A(1)                   72D
*RNF7031   DEVCLASS        A(2)                   93D
*RNF7031   DEVICECLASS     A(1)                   67D
*RNF7031   DEVICEDESC      A(10)                  97D
*RNF7031   DEVICETYPE      A(6)                   68D
*RNF7031   DISPLAYLOCATION A(1)                   75D
*RNF7031   DISPLAYTYPE     A(1)                   76D
*RNF7031   DUPKEY          A(1)                   62D
*RNF7031   FILE            A(10)                  19D
*RNF7031   FILEEOF         N(1)                   16D
*RNF7031   FILEOPEN        N(1)                   15D
*RNF7031   FILEPOSBITS     A(1)                  101D
*RNF7031   FILETYPE        I(5,0)                 20D
*RNF7031   FIRSTRRNONSCREEN...
                           I(5,0)                 34D
           FUNCKEY         A(1)                   32D    610     620
*RNF7031   INVITESTATUS    A(1)                   71D
*RNF7031   IORCDLEN        I(10,0)                95D
*RNF7031   KEYBOARDTYPE    A(1)                   77D
*RNF7031   KEYLEN          I(5,0)                 23D
*RNF7031   KEYLENGTH       I(5,0)                104D
*RNF7031   LIB             A(10)                  21D
*RNF7031   LISTINGLINE     A(8)                   17D
*RNF7031   MAXRCDSINBLOCK  I(5,0)                 65D
*RNF7031   MBR             A(10)                  24D
*RNF7031   MEMBERNUMBER    I(5,0)                105D
*RNF7031   MISCFLAGS1      A(1)                   80D
*RNF7031   MISCFLAGS2      A(1)                   83D
*RNF7031   MISCFLAGS3      A(1)                   86D
*RNF7031   MSGID           A(7)                   46D
*RNF7031   NBRLOCKEDRCDS   I(5,0)                100D
*RNF7031   NBROFCOL        I(5,0)                 59D
*RNF7031   NBROFROWS       I(5,0)                 58D
*RNF7031   NBRRCDS         I(10,0)                60D
*RNF7031   NUM_DEVS        I(5,0)                 87D
*RNF7031   NUMBASEDMBRS    I(5,0)                 82D
*RNF7031   NUMBEROFCOLS    I(5,0)                 57D
*RNF7031   NUMBEROFROWS    I(5,0)                 56D
*RNF7031   NUMKEYS         I(5,0)                103D
*RNF7031   ODPTYPE         A(2)                   47D
*RNF7031   OEPCOUNT        I(5,0)                 81D
*RNF7031   ONLINEOFFLINE   A(1)                   74D
*RNF7031   OPENID          A(2)                   84D
*RNF7031   OTHERIOCOUNT    I(10,0)                91D
*RNF7031   OVERFLOW        I(5,0)                 42D
*RNF7031   PAGESIZE        I(5,0)                 41D
*RNF7031   PGMDEVICE       A(10)                  96D
*RNF7031   PGMDEVNAME      A(10)                  94D
*RNF7031   PRINTCURRENTLINE...
                           I(5,0)                 39D
*RNF7031   PRINTOVERFLOW   I(5,0)                 38D
*RNF7031   PRINTPAGESIZE   I(5,0)                 37D
*RNF7031   RCDDELETEDBITS  A(1)                  102D
*RNF7031   RCDFMT          A(10)                  28D
*RNF7031   RCDFMTLEN       I(5,0)                 85D
*RNF7031   RCDLEN          I(5,0)                 22D
*RNF7031   RCDSREADSINCEOPEN...
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     42
                           I(10,0)                25D
*RNF7031   READCOUNT       I(10,0)                89D
*RNF7031   REQUESTER       A(1)                   69D
*RNF7031   ROWCOLUMN       I(5,0)                 33D
*RNF7031   RRN             I(10,0)                30D
*RNF7031   RRNLASTREAD     I(10,0)                27D
*RNF7031   SFLMINRRN       I(5,0)                 53D
*RNF7031   SFLNUMRCDS      I(5,0)                 54D
*RNF7031   SFLRCDNBR       I(5,0)                 29D
*RNF7031   SFLRRN          I(5,0)                 52D
*RNF7031   SPLF            A(10)                  48D
*RNF7031   SPLFLIB         A(10)                  49D
*RNF7031   SPLFNUMBER      I(5,0)                 50D
*RNF7031   SRCFILE         A(1)                   63D
*RNF7031   TOTALSFLROWS    I(5,0)                 35D
*RNF7031   USER            A(10)                  98D
*RNF7031   VOLUMELAVELOFFSET...
                           I(5,0)                 64D
*RNF7031   WRITECOUNT      I(10,0)                88D
*RNF7031   WRITEREADCOUNT  I(10,0)                90D
*RNF7031 INFDS_DB          DS(400)               108D
*RNF7031 INFDS_DSPF        DS(400)               109D
*RNF7031 INFDS_PRTF        DS(400)               110D
         INITIALPOS        S(10,0)               203D    607M    611     613
                                                 614M    622     637     649M
                                                 663M    894    1014    1085M
                                                1311M   1347M   1410M   1452M
                                                1516M   1542M   1595M
         INSERTSCREEN      PROTOTYPE             434M   1254M   1279    1280
         LOADDATATODS      PROTOTYPE            1324M   1636
         LOADDATATOSCREEN  PROTOTYPE            1397M   1501M   1581M   1614
         MAINLINE          PROTOTYPE               6     348
         MODIFYSCREEN      PROTOTYPE             438M   1258M   1374    1375
         NAMETASK          A(10)                 308M    334    1433    1617M
                                                1639
         NODATA_ON_SQL     CONST                 176D   1061
         OPCTASK           A(1)                  299M    325     682     711
                                                 739     769M   1407M   1451M
                                                1513M   1541M   1592M
         PAGEDOWN          CONST                 118D    620
         PAGEUP            CONST                 117D    610
         PERPAGE           CONST                 215D    677    1061
*RNF7030 PFKEY             **UNDEF**             661     668    1317    1415
                                                1521
*RNF7031 PFKEY01           CONST                 121D
*RNF7031 PFKEY02           CONST                 122D
         PFKEY03           CONST                 123D    599     605     606M
                                                1304    1309    1313M   1400
                                                1404    1408M   1504    1509
                                                1514M   1584    1588    1593M
*RNF7031 PFKEY04           CONST                 124D
*RNF7031 PFKEY05           CONST                 125D
*RNF7031 PFKEY06           CONST                 126D
*RNF7031 PFKEY07           CONST                 127D
*RNF7031 PFKEY08           CONST                 128D
*RNF7031 PFKEY09           CONST                 129D
*RNF7031 PFKEY10           CONST                 130D
*RNF7031 PFKEY11           CONST                 131D
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     43
*RNF7031 PFKEY12           CONST                 132D
*RNF7031 PFKEY13           CONST                 133D
*RNF7031 PFKEY14           CONST                 134D
*RNF7031 PFKEY15           CONST                 135D
*RNF7031 PFKEY16           CONST                 136D
*RNF7031 PFKEY17           CONST                 137D
*RNF7031 PFKEY18           CONST                 138D
*RNF7031 PFKEY19           CONST                 139D
*RNF7031 PFKEY20           CONST                 140D
*RNF7031 PFKEY21           CONST                 141D
*RNF7031 PFKEY22           CONST                 142D
*RNF7031 PFKEY23           CONST                 143D
*RNF7031 PFKEY24           CONST                 144D
         PREVFINALPOS      S(10,0)               208D   1012M   1015M   1179
         PREVINITIALPOS    S(10,0)               207D   1011M   1014M   1179
*RNF7031 PRINT             CONST                 119D
         PROTECTFIELDS_35  N(1)                  161D   1305M   1401M   1405M
                                                1505M   1510M   1585M   1589M
         PROTECTFIELDS_36  N(1)                  162D   1306M   1506M   1511M
                                                1586M   1590M
         PSQLSTATE         *(16)                 167D    169
         PTRDISPLAYINDICATORS...
                           *(16)                 149D    150
*RNF7031 RECORDBACKSPAC    CONST                 120D
         SCREENVALIDATION  N(1)                  795     796    1318    1362
                           PROTOTYPE            1416    1468    1522    1558
         SFLCLR            N(1)                  154D    910M    912M
         SFLDSP            N(1)                  152D    914M    934M
         SFLDSPCTL         N(1)                  153D    915M    939M
         SFLEND            N(1)                  155D    909M    931M
         SFLENDDATE        P(8,0)                303M    329    1121M
         SFLINITIAL        PROTOTYPE             908     928M
         SFLSTATE          P(2,0)                304M    330    1122M
         SFLSTRDATE        P(8,0)                302M    328    1120M
         SFLTASKID         P(10,0)               300M    326     691     719
                                                 747    1118M
         SFLTASKNAM        A(10)                 301M    327    1119M
         SHOWSCREEN        PROTOTYPE             357M    427     428     616M
                                                 653M    657M    666M    670M
                                                 709M    737M    765M   1315M
                                                1350M   1413M   1455M   1519M
                                                1545M   1598M
         SHOWSUBFILE       PROTOTYPE             436M    529     530
         SHOWWDW           PROTOTYPE             456     457    1322M   1345M
                                                1354M   1420M   1449M   1460M
                                                1526M   1539M   1550M
         SOLUTION          A(150)                310M    336    1435    1619M
                                                1641
*RNF7031 SQFAPP            CONST                 295D
*RNF7031 SQFCRT            CONST                 293D
*RNF7031 SQFOVR            CONST                 294D
*RNF7031 SQFRD             CONST                 292D
*RNF7031 SQLABC            B(9,0)                237D
*RNF7031 SQLAID            A(8)                  235D
         SQLCA             DS(136)               233D    271     276     280
                                                 284     641     694     722
                                                 750     829     964    1023
                                                1036    1041    1050    1073
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     44
                                                1096    1101    1146    1186
                                                1199    1204    1213    1225
                                                1230    1339    1443    1534
         SQLCABC           I(10,0)               236D    237
         SQLCAID           A(8)                  234D    235
         SQLCLSE           CONST                 279     290D
         SQLCLSE_CALL      PROTOTYPE             279D   1100M   1229M
         SQLCMIT           CONST                 283     291D
*RNF7031 SQLCMIT_CALL      PROTOTYPE             283D
*RNF7031 SQLCOD            B(9,0)                239D
         SQLCODE           I(10,0)               238D    239
*RNF7031 SQLERL            B(4,0)                241D
*RNF7031 SQLERM            A(70)                 243D
*RNF7031 SQLERP            A(8)                  245D
         SQLERR            A(24)                 246D    247     248     249
                                                 250     251     252     253
*RNF7031 SQLERRD(6)        I(10,0)               253D
         SQLERRMC          A(70)                 242D    243
         SQLERRML          I(5,0)                240D    241
         SQLERRP           A(8)                  244D    245
*RNF7031 SQLER1            B(9,0)                247D
*RNF7031 SQLER2            B(9,0)                248D
*RNF7031 SQLER3            B(9,0)                249D
*RNF7031 SQLER4            B(9,0)                250D
*RNF7031 SQLER5            B(9,0)                251D
         SQLER6            B(9,0)                252D    639M    692M    720M
                                                 748M    827M   1021M   1032M
                                                1048M   1071M   1093M   1184M
                                                1195M   1211M   1222M   1337M
                                                1441M   1532M
         SQLOPEN           CONST                 275     289D
         SQLOPEN_CALL      PROTOTYPE             275D   1040M   1203M
         SQLROUTE          CONST                 270     288D    963    1145
         SQLROUTE_CALL     PROTOTYPE             270D    640M    693M    721M
                                                 749M    828M   1035M   1049M
                                                1072M   1095M   1198M   1212M
                                                1224M   1338M   1442M   1533M
         SQLSTATE          A(5)                  167     267D    268
*RNF7031 SQLSTT            A(5)                  268D
*RNF7031 SQLWARN(11)       A(1)                  266D
*RNF7031 SQLWNA            A(1)                  265D
*RNF7031 SQLWN0            A(1)                  255D
*RNF7031 SQLWN1            A(1)                  256D
*RNF7031 SQLWN2            A(1)                  257D
*RNF7031 SQLWN3            A(1)                  258D
*RNF7031 SQLWN4            A(1)                  259D
*RNF7031 SQLWN5            A(1)                  260D
*RNF7031 SQLWN6            A(1)                  261D
*RNF7031 SQLWN7            A(1)                  262D
*RNF7031 SQLWN8            A(1)                  263D
*RNF7031 SQLWN9            A(1)                  264D
         SQLWRN            A(11)                 254D    255     256     257
                                                 258     259     260     261
                                                 262     263     264     265
                                                 266
         STARTDATE         P(8,0)                311M    337     839     847
                                                 849    1436    1620M   1642
         STARTDATEERROR_32 N(1)                  158D    841M    848     870M
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     45
         STATETASK         P(1,0)                313M    339    1438    1622M
                                                1644
         SUBFILESTART      PROTOTYPE             884     885     929M
         SUCCESS_ON_SQL    CONST                 174D   1065    1083    1343
                                                1447    1538
         TASKIDEXISTERROR_31...
                           N(1)                  157D    836M    869M
         TASKRRN           S(3,0)                  8     200D    676     677
                                                 678     913M    933    1084
                                                1117M
         TITLE1            A(50)                 319     386M    386     388M
                                                 388     390M    390     392M
                                                 392     396M    396
         TITLE2            A(50)                 320     378M    378
         TITLE3            A(50)                 321     379M    379
         TURNOFFERRORS     PROTOTYPE             818M    868
         VIEWSCREEN        PROTOTYPE             442M   1266M   1574    1575
         W_CRUDFINALIZE    N(1)                  218D    777     778M   1409M
                                                1456M   1515M   1546M   1594M
         W_WHERESFL        A(500)                211D    673M    895    1180
*RNF7031 WARNING_ON_SQL    CONST                 175D
         WDWCHOICE         A(1)                  316M    344    1323    1421
                                                1527
         WDWMSG1           A(40)                 346     471M    476M    482M
         WDWMSG2           A(40)                 347
         WDWTEXT1          A(40)                 342     463M
         WDWTEXT2          A(40)                 343     464M
         WRITESCREEN       PROTOTYPE             372     373     600M   1302M
                                                1398M   1502M   1582M
         XSQLSTATE         A(2)                  170D   1061    1065    1083
                                                1343    1447    1538
      Field References for subprocedure MAINLINE
         Field             Attributes         References (D=Defined M=Modified)
         CHOICE            A(1)                  350D    355M    357
      Field References for subprocedure WRITESCREEN
         Field             Attributes         References (D=Defined M=Modified)
         P_CHOICE          A(1)                  374D    385     387     389
                                                 391     395     401     403
                                                 403     403     405
      Field References for subprocedure SHOWSCREEN
         Field             Attributes         References (D=Defined M=Modified)
         P_CHOICE          A(1)                  429D    433     434     435
                                                 436     437     438     439
                                                 440     441     442
      Field References for subprocedure SHOWWDW
         Field             Attributes         References (D=Defined M=Modified)
         P_CHOICE          A(1)                  458D    462     470     475
                                                 481
      Field References for subprocedure CENTER
         Field             Attributes         References (D=Defined M=Modified)
         CENTEREDTEXT      A(80)                 510D    514M    515
         INITPOSITION      S(2,0)                509D    513M    514
         LENBLANKS         S(2,0)                508D    512M    513
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     46
         PAR_LENGTH        S(2,0)                504D    512
         PAR_TEXT          A(80)                 503D    512     514
      Field References for subprocedure SHOWSUBFILE
         Field             Attributes         References (D=Defined M=Modified)
         CHOICE            A(1)                  535D    669M    670     708M
                                                 709     736M    737     764M
                                                 765
         P_CHOICE          A(1)                  531D    600     616     653
                                                 657     666
         SQL_00000         B(4,0)                539D    642
*RNF7031 SQL_00001         B(4,0)                540D
*RNF7031 SQL_00002         U(10,0)               541D
         SQL_00003         A(1)                  542D    644
*RNF7031 SQL_00004         A(119)                543D
         SQL_00005         S(10,0)               544D    637M
         SQL_00006         S(10,0)               545D    638M
         SQL_00007         A(1)                  546D    645
         SQL_00008         B(4,0)                550D    695
*RNF7031 SQL_00009         B(4,0)                551D
*RNF7031 SQL_00010         U(10,0)               552D
         SQL_00011         A(1)                  553D    697
*RNF7031 SQL_00012         A(119)                554D
         SQL_00013         P(10,0)               555D    691M
         SQL_00014         S(10,0)               556D    698
         SQL_00015         A(10)                 557D    699
                           VARYING(2)
         SQL_00016         A(150)                558D    700
                           VARYING(2)
         SQL_00017         A(150)                559D    701
                           VARYING(2)
         SQL_00018         S(8,0)                560D    702
         SQL_00019         S(8,0)                561D    703
         SQL_00020         S(1,0)                562D    704
         SQL_00021         A(10)                 563D    705
                           VARYING(2)
         SQL_00022         B(4,0)                567D    723
*RNF7031 SQL_00023         B(4,0)                568D
*RNF7031 SQL_00024         U(10,0)               569D
         SQL_00025         A(1)                  570D    725
*RNF7031 SQL_00026         A(119)                571D
         SQL_00027         P(10,0)               572D    719M
         SQL_00028         S(10,0)               573D    726
         SQL_00029         A(10)                 574D    727
                           VARYING(2)
         SQL_00030         A(150)                575D    728
                           VARYING(2)
         SQL_00031         A(150)                576D    729
                           VARYING(2)
         SQL_00032         S(8,0)                577D    730
         SQL_00033         S(8,0)                578D    731
         SQL_00034         S(1,0)                579D    732
         SQL_00035         A(10)                 580D    733
                           VARYING(2)
         SQL_00036         B(4,0)                584D    751
*RNF7031 SQL_00037         B(4,0)                585D
*RNF7031 SQL_00038         U(10,0)               586D
         SQL_00039         A(1)                  587D    753
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     47
*RNF7031 SQL_00040         A(119)                588D
         SQL_00041         P(10,0)               589D    747M
         SQL_00042         S(10,0)               590D    754
         SQL_00043         A(10)                 591D    755
                           VARYING(2)
         SQL_00044         A(150)                592D    756
                           VARYING(2)
         SQL_00045         A(150)                593D    757
                           VARYING(2)
         SQL_00046         S(8,0)                594D    758
         SQL_00047         S(8,0)                595D    759
         SQL_00048         S(1,0)                596D    760
         SQL_00049         A(10)                 597D    761
                           VARYING(2)
         W_EXIST           A(1)                  534D    645M    648
      Field References for subprocedure SCREENVALIDATION
         Field             Attributes         References (D=Defined M=Modified)
         P_CHOICE          A(1)                  797D    816
         SQL_00050         B(4,0)                806D    830
*RNF7031 SQL_00051         B(4,0)                807D
*RNF7031 SQL_00052         U(10,0)               808D
         SQL_00053         A(1)                  809D    832
*RNF7031 SQL_00054         A(119)                810D
         SQL_00055         P(10,0)               811D    826M
         SQL_00056         A(1)                  812D    833
         W_EXISTS          A(1)                  801D    833M    836
         W_VALIDISNOTOK    N(1)                  800D    855M    857
      Field References for subprocedure TURNOFFERRORS
         Field             Attributes         References (D=Defined M=Modified)
         No references in the source.
      Field References for subprocedure SUBFILESTART
         Field             Attributes         References (D=Defined M=Modified)
         SQLCUSTOMIZED     A(500)                889D    891M    897
      Field References for subprocedure SFLINITIAL
         Field             Attributes         References (D=Defined M=Modified)
         No references in the source.
      Field References for subprocedure ACTIVATESUBFILE
         Field             Attributes         References (D=Defined M=Modified)
         No references in the source.
      Field References for subprocedure FILLSFL
         Field             Attributes         References (D=Defined M=Modified)
         COUNT             S(2,0)                957D   1061    1062M   1062
                                                1085
         LASTRRN           S(10,0)               959D   1063M   1063    1086
         PAR_SQLCUSTOMIZED A(500)                954D    965    1024
         SQCALL000008      PROTOTYPE             963D   1022M
         SQL_00057         B(4,0)                969D   1037    1042
*RNF7031 SQL_00058         B(4,0)                970D
         SQL_00059         U(10,0)               971D   1033
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     48
         SQL_00060         A(1)                  972D   1034
*RNF7031 SQL_00061         A(118)                973D
*RNF7031 SQL_00062         A(1)                  974D
         SQL_00063         B(4,0)                978D   1051
*RNF7031 SQL_00064         B(4,0)                979D
*RNF7031 SQL_00065         U(10,0)               980D
         SQL_00066         A(1)                  981D   1053
*RNF7031 SQL_00067         A(118)                982D
         SQL_00068         S(10,0)               983D   1054
         SQL_00069         A(20)                 984D   1055
         SQL_00070         S(8,0)                985D   1056
         SQL_00071         S(8,0)                986D   1057
         SQL_00072         S(1,0)                987D   1058
         SQL_00073         B(4,0)                991D   1074
*RNF7031 SQL_00074         B(4,0)                992D
*RNF7031 SQL_00075         U(10,0)               993D
         SQL_00076         A(1)                  994D   1076
*RNF7031 SQL_00077         A(118)                995D
         SQL_00078         S(10,0)               996D   1077
         SQL_00079         A(20)                 997D   1078
         SQL_00080         S(8,0)                998D   1079
         SQL_00081         S(8,0)                999D   1080
         SQL_00082         S(1,0)               1000D   1081
         SQL_00083         B(4,0)               1004D   1097    1102
*RNF7031 SQL_00084         B(4,0)               1005D
         SQL_00085         U(10,0)              1006D   1094
*RNF7031 SQL_00086         A(1)                 1007D
*RNF7031 SQL_00087         A(118)               1008D
*RNF7031 SQL_00088         A(1)                 1009D
      Field References for subprocedure DATATOSFL
         Field             Attributes         References (D=Defined M=Modified)
         No references in the source.
      Field References for subprocedure GETTOTALRECORDS
         Field             Attributes         References (D=Defined M=Modified)
         SQCALL000013      PROTOTYPE            1145D   1185M
         SQL_00089         B(4,0)               1151D   1200    1205
*RNF7031 SQL_00090         B(4,0)               1152D
         SQL_00091         U(10,0)              1153D   1196
         SQL_00092         A(1)                 1154D   1197
*RNF7031 SQL_00093         A(118)               1155D
*RNF7031 SQL_00094         A(1)                 1156D
         SQL_00095         B(4,0)               1160D   1214
*RNF7031 SQL_00096         B(4,0)               1161D
*RNF7031 SQL_00097         U(10,0)              1162D
         SQL_00098         A(1)                 1163D   1216
*RNF7031 SQL_00099         A(118)               1164D
         SQL_00100         S(10,0)              1165D   1217
         SQL_00101         B(4,0)               1169D   1226    1231
*RNF7031 SQL_00102         B(4,0)               1170D
         SQL_00103         U(10,0)              1171D   1223
*RNF7031 SQL_00104         A(1)                 1172D
*RNF7031 SQL_00105         A(118)               1173D
*RNF7031 SQL_00106         A(1)                 1174D
         SQLCUSTOMIZED     A(500)               1143D   1147    1176M   1187
         W_TOTAL           S(10,0)              1141D   1217M   1235
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     49
      Field References for subprocedure EXECUTECRUDSCREEN
         Field             Attributes         References (D=Defined M=Modified)
         P_CHOICE          A(1)                 1250D   1253    1254    1257
                                                1258    1261    1262    1265
                                                1266
      Field References for subprocedure INSERTSCREEN
         Field             Attributes         References (D=Defined M=Modified)
         CHOICE            A(1)                 1284D   1314M   1315    1321M
                                                1322    1344M   1345    1349M
                                                1350    1353M   1354
         P_CHOICE          A(1)                 1281D   1302    1318    1362
         SQL_00107         B(4,0)               1288D   1340
*RNF7031 SQL_00108         B(4,0)               1289D
*RNF7031 SQL_00109         U(10,0)              1290D
*RNF7031 SQL_00110         A(1)                 1291D
*RNF7031 SQL_00111         A(118)               1292D
         SQL_00112         S(10,0)              1293D   1329M
         SQL_00113         A(10)                1294D   1330M
                           VARYING(2)
         SQL_00114         A(150)               1295D   1331M
                           VARYING(2)
         SQL_00115         A(150)               1296D   1332M
                           VARYING(2)
         SQL_00116         S(8,0)               1297D   1333M
         SQL_00117         S(8,0)               1298D   1334M
         SQL_00118         S(1,0)               1299D   1335M
         SQL_00119         A(10)                1300D   1336M
                           VARYING(2)
      Field References for subprocedure MODIFYSCREEN
         Field             Attributes         References (D=Defined M=Modified)
         CHOICE            A(1)                 1379D   1412M   1413    1419M
                                                1420    1448M   1449    1454M
                                                1455    1459M   1460
         P_CHOICE          A(1)                 1376D   1398    1416    1468
         SQL_00120         B(4,0)               1383D   1444
*RNF7031 SQL_00121         B(4,0)               1384D
*RNF7031 SQL_00122         U(10,0)              1385D
*RNF7031 SQL_00123         A(1)                 1386D
*RNF7031 SQL_00124         A(118)               1387D
         SQL_00125         A(10)                1388D   1433M
         SQL_00126         A(150)               1389D   1434M
         SQL_00127         A(150)               1390D   1435M
         SQL_00128         P(8,0)               1391D   1436M
         SQL_00129         P(8,0)               1392D   1437M
         SQL_00130         P(1,0)               1393D   1438M
         SQL_00131         A(10)                1394D   1439M
         SQL_00132         P(10,0)              1395D   1440M
      Field References for subprocedure DELETESCREEN
         Field             Attributes         References (D=Defined M=Modified)
         CHOICE            A(1)                 1490D   1518M   1519    1525M
                                                1526    1544M   1545    1549M
                                                1550
         P_CHOICE          A(1)                 1487D   1502    1522    1539
                                                1558
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     50
         SQL_00133         B(4,0)               1494D   1535
*RNF7031 SQL_00134         B(4,0)               1495D
*RNF7031 SQL_00135         U(10,0)              1496D
*RNF7031 SQL_00136         A(1)                 1497D
*RNF7031 SQL_00137         A(118)               1498D
         SQL_00138         P(10,0)              1499D   1531M
      Field References for subprocedure VIEWSCREEN
         Field             Attributes         References (D=Defined M=Modified)
         CHOICE            A(1)                 1579D   1597M   1598
         P_CHOICE          A(1)                 1576D   1582
      Field References for subprocedure LOADDATATOSCREEN
         Field             Attributes         References (D=Defined M=Modified)
         No references in the source.
      Field References for subprocedure LOADDATATODS
         Field             Attributes         References (D=Defined M=Modified)
         No references in the source.
      Indicator References:
         Indicator                            References (D=Defined M=Modified)
         *IN                                     149
*RNF7031 03                                      305D    306D
*RNF7031 05                                      305D
*RNF7031 06                                      305D
*RNF7031 10                                      306D
*RNF7031 31                                      306D
*RNF7031 32                                      306D
*RNF7031 33                                      306D
*RNF7031 34                                      306D
*RNF7031 35                                      306D
*RNF7031 36                                      306D
*RNF7031 80                                      305D
*RNF7031 81                                      305D
*RNF7031 96                                      305D
*RNF7031 97                                      305D
*RNF7031 98                                      305D
*RNF7031 99                                      305D
         LR                                      361M
       * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     51
                      E x t e r n a l   R e f e r e n c e s
      Statically bound procedures:
         Procedure                            References
         No references in the source.
      Imported fields:
         Field             Attributes         Defined
         No references in the source.
      Exported fields:
         Field             Attributes         Defined
         No references in the source.
   * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     52
                          M e s s a g e   S u m m a r y
 Msg id  Sv Number Message text
*RNF7031 00    465 The name or indicator is not referenced.
*RNF7089 00      1 RPG provides Separate-Indicator area for file.
*RNF7030 30      1 The name or indicator is not defined.
*RNF7418 30      5 The result field used in the EVAL operation cannot be
                   modified.
*RNF7421 30      5 Operands are not compatible with the type of operator.
*RNF7423 30      5 A relational expression or indicator is expected for logical
                   operations.
*RNF7503 30      5 Expression contains an operand that is not defined.
       * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-09 08:21:11        Page     53
                            F i n a l   S u m m a r y
  Message Totals:
    Information  (00) . . . . . . . :      466
    Warning      (10) . . . . . . . :        0
    Error        (20) . . . . . . . :        0
    Severe Error (30+)  . . . . . . :       21
    ---------------------------------  -------
    Total . . . . . . . . . . . . . :      487
  Source Totals:
    Records . . . . . . . . . . . . :     1646
    Specifications  . . . . . . . . :     1093
    Data records  . . . . . . . . . :        0
    Comments  . . . . . . . . . . . :      476
         * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
Compilation stopped. Severity 30 errors found in program.
          * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

