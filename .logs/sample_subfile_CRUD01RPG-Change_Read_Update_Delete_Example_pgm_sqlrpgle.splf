>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
CPC2198: Current library changed to NLITTEN1.
CPC2196: Library NLITTEN1 added to library list.

>> executing command: CRTSQLRPGI srcstmf('/home/nlitten/builds/nick.litten.public/sample_subfile/CRUD01RPG-Change_Read_Update_Delete_Example.pgm.sqlrpgle') OBJ(NLITTEN1/CRUD01RPG) COMMIT(*NONE ) OBJTYPE(*PGM) OPTION(*EVENTF) OUTPUT(*PRINT) TEXT('Change Read Update Delete Example') TGTRLS(V7R4M0) DBGVIEW(*SOURCE) RPGPPOPT(*LVL2) COMPILEOPT('TGTCCSID(*JOB) OPTIMIZE(*FULL) INCDIR(''includes'')')
>> liblist: QSYS QSYS2 QHLPSYS QUSRSYS QSHELL NLITTEN1 NLITTEN1 QTEMP QGPL
>> executing time: 2025-05-07-11.48.36.00

SQL9019: SQL precompile failed.
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      1
  Command  . . . . . . . . . . . . :   CRTBNDRPG
    Issued by  . . . . . . . . . . :     NICKLITTEN
  Program  . . . . . . . . . . . . :   CRUD01RPG
    Library  . . . . . . . . . . . :     NLITTEN1
  Text 'description' . . . . . . . :   Change Read Update Delete Example
  Source stream file   . . . . . . :   /home/nlitten/builds/nick.litten.public/sample_sub
                                       file/CRUD01RPG-Change_Read_Update_Delete_Example.p
                                       gm.sqlrpgle
    CCSID  . . . . . . . . . . . . :     1208
  Target CCSID . . . . . . . . . . :   *JOB (37)
  Text 'description' . . . . . . . :
  Last Change  . . . . . . . . . . :   25-04-11  09:32:08
  Generation severity level  . . . :   10
  Default activation group . . . . :   *YES
  Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                       *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                       *DEBUGIO   *UNREF     *EVENTF
  Debugging views  . . . . . . . . :   *ALL
  Debug encryption key . . . . . . :   *NONE
  Output . . . . . . . . . . . . . :   *PRINT
  Optimization level . . . . . . . :   *FULL
  Source listing indentation . . . :   *NONE
  Type conversion options  . . . . :   *NONE
  Sort sequence  . . . . . . . . . :   *JOB
  Language identifier  . . . . . . :   *JOB
  Replace program  . . . . . . . . :   *YES
  User profile . . . . . . . . . . :   *USER
  Authority  . . . . . . . . . . . :   *LIBCRTAUT
  Truncate numeric . . . . . . . . :   *YES
  Fix numeric  . . . . . . . . . . :   *NONE
  Target release . . . . . . . . . :   V7R4M0
  Allow null values  . . . . . . . :   *NO
  Define condition names . . . . . :   *NONE
  Enable performance collection  . :   *PEP
  Profiling data . . . . . . . . . :   *NOCOL
  Licensed Internal Code options . :
  Generate program interface . . . :   *NO
  Include directory  . . . . . . . :   includes
  Preprocessor options . . . . . . :   *NORMVCOMMENT *EXPINCLUDE   *NOSEQSRC
  Output source file . . . . . . . :   QSQLPRE
    Library  . . . . . . . . . . . :     QTEMP
  Output source member . . . . . . :   CRUD01RPG
  MINIMUM OUTPUT LINE LENGTH . . . :   100
  Require prototype for export . . :   *NO
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      2
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
                          S o u r c e   L i s t i n g
     1 **free                                                                                                               000001
     2                                                                                                                      000002
     3 // --------------------------------------------------------------------------                                        000003
     4 // *** WORK IN PROGRESS _ NOT FINISHED YET ***                                                                       000004
     5 // --------------------------------------------------------------------------                                        000005
     6 ctl-opt main(mainline) copyright('| CRUD01RPG 2025.04.11');                                                          000006
     7                                                                                                                      000007
     8 dcl-f CRUD01PNL workstn sfile(SFLTASK:taskrrn) usropn infds(infds);                                                  000008
     9                                                                                                                      000009
    10 /include 'information_data_structures.rpgleinc                                                                       000010
======>         aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
*RNF0272 30 a      000010  The /COPY directive has a syntax error; directive ignored.
    11                                                                                                                      000011
    12 // Validation indicators                                                                                             000012
    13 Dcl-S ptrDisplayIndicators Pointer Inz(%Addr(*In));                                                                  000013
    14 Dcl-Ds DisplayIndicators Based(ptrDisplayIndicators);                                                                000014
    15   // Subfile indicators                                                                                              000015
    16   SflDsp          Ind Pos(99);                                                                                       000016
    17   SflDspCtl       Ind Pos(98);                                                                                       000017
    18   SflClr          Ind Pos(97);                                                                                       000018
    19   SflEnd          Ind Pos(96);                                                                                       000019
    20   // Validation Errors                                                                                               000020
    21   Taskidexisterror_31 Ind Pos(31);                                                                                   000021
    22   Startdateerror_32  Ind Pos(32);                                                                                    000022
    23   Enddateerror_33 Ind Pos(33);                                                                                       000023
    24   Dategreaterthanerror_34 Ind Pos(34);                                                                               000024
    25   ProtectFields_35 Ind Pos(35);                                                                                      000025
    26   ProtectFields_36 Ind Pos(36);                                                                                      000026
    27   IndErrors char(20) Pos(31);                                                                                        000027
    28 end-ds;                                                                                                              000028
    29                                                                                                                      000029
    30 // Variable Pointer for SQL Errors                                                                                   000030
    31 Dcl-S pSqlstate Pointer Inz(%Addr(SQLState));                                                                        000031
    32                                                                                                                      000032
    33 Dcl-Ds Ds_SqlState based(pSqlstate);                                                                                 000033
    34   xSqlstate char(2);                                                                                                 000034
    35 end-ds;                                                                                                              000035
    36                                                                                                                      000036
    37 // Constant error on SQL                                                                                             000037
    38 Dcl-C SUCCESS_ON_SQL '00';                                                                                           000038
    39 Dcl-C WARNING_ON_SQL '01';                                                                                           000039
    40 Dcl-C NODATA_ON_SQL  '02';                                                                                           000040
    41                                                                                                                      000041
    42 // Data structure based in the query neccesary for fill the subfile of                                               000042
    43 // the file CRUD01TBL                                                                                                000043
    44 Dcl-Ds Ds_taskdata qualified;                                                                                        000044
    45   Taskid     zoned(10);                                                                                              000045
    46   Nametask    char(20);                                                                                              000046
    47   Start_date zoned(8);                                                                                               000047
    48   End_date   zoned(8);                                                                                               000048
    49   Taskstate  zoned(1);                                                                                               000049
    50 end-ds;                                                                                                              000050
    51                                                                                                                      000051
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      3
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    52 // Data structure for general use in CRUD operations                                                                 000052
    53 Dcl-Ds Ds_datacrud extname('CRUD01TBL') qualified end-ds;                                                            000053
    54                                                                                                                      000054
    55 // Relative record number for SFLTASK subfile task                                                                   000055
    56 Dcl-S taskrrn zoned(3:0);                                                                                            000056
    57                                                                                                                      000057
    58 // Variables for subfile scroll position                                                                             000058
    59 Dcl-S Initialpos zoned(10:0) inz(0);                                                                                 000059
    60 Dcl-S Finalpos zoned(10:0) inz(10);                                                                                  000060
    61                                                                                                                      000061
    62 // Previous initial and finalpos for indicates final                                                                 000062
    63 Dcl-S Previnitialpos zoned(10:0);                                                                                    000063
    64 Dcl-S PrevFinalpos zoned(10:0) ;                                                                                     000064
    65                                                                                                                      000065
    66 // Variable for apply filter to subfile query                                                                        000066
    67 Dcl-S w_Wheresfl char(500) inz(*blanks);                                                                             000067
    68                                                                                                                      000068
    69 // Quantity of records per page in subfile change the inz value depend                                               000069
    70 // of your subfile capacity                                                                                          000070
    71 Dcl-C PERPAGE 10;                                                                                                    000071
    72                                                                                                                      000072
    73 // Variable for indicates that crud operations are finalized                                                         000073
    74 Dcl-S w_Crudfinalize Ind;                                                                                            000074
    75                                                                                                                      000075
    76 // Variable with current user                                                                                        000076
    77 Dcl-S CurrentUser char(10) inz(*user);                                                                               000077
    78                                                                                                                      000078
    79                                                                                                                      000079
    80                                                                                                                      000080
    81                                                                                                                      000081
    82                                                                                                                      000082
    83                                                                                                                      000083
    84 // --------------------------------------------------------------------------                                        000084
    85 // This is the mainline process that is executed when the program is called                                          000085
    86 // --------------------------------------------------------------------------                                        000086
    87 Dcl-Proc mainline;                                                                                                   000087
    88                                                                                                                      000088
    89   Dcl-S choice char(1) inz(*blanks);                                                                                 000089
    90                                                                                                                      000090
    91   open CRUD01PNL;                                                                                                    000091
    92                                                                                                                      000092
    93   // The value 'S' is for Subfile Menu                                                                               000093
    94   choice = 'S';                                                                                                      000094
    95                                                                                                                      000095
    96   ShowScreen(choice);                                                                                                000096
    97                                                                                                                      000097
    98   // Termination of program                                                                                          000098
    99   close CRUD01PNL;                                                                                                   000099
   100   *Inlr = *On;                                                                                                       000100
   101 end-proc;                                                                                                            000101
   102                                                                                                                      000102
   103                                                                                                                      000103
   104                                                                                                                      000104
   105                                                                                                                      000105
   106                                                                                                                      000106
   107                                                                                                                      000107
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      4
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   108 // --------------------------------------------------------------------------                                        000108
   109 // This procedure receives a parameter for the titles that are written                                               000109
   110 // --------------------------------------------------------------------------                                        000110
   111 Dcl-Proc WriteScreen;                                                                                                000111
   112   Dcl-Pi WriteScreen;                                                                                                000112
   113     p_choice char(1);                                                                                                000113
   114   end-pi;                                                                                                            000114
   115                                                                                                                      000115
   116   // Secondary titles                                                                                                000116
   117   TITLE2 = Center('Created by Some Bloke':%len(TITLE2));                                                             000117
   118   TITLE3 = Center('Back in 2018':%len(TITLE3));                                                                      000118
   119                                                                                                                      000119
   120   // Principal title                                                                                                 000120
   121   Select;                                                                                                            000121
   122                                                                                                                      000122
   123       // CRUD Options                                                                                                000123
   124     When (p_choice = 'I');                                                                                           000124
   125       TITLE1 = Center('TASKS ADMINISTRATOR INSERT':%len(TITLE1));                                                    000125
   126     When (p_choice = 'M');                                                                                           000126
   127       TITLE1 = Center('TASKS ADMINISTRATOR MODIFY':%len(TITLE1));                                                    000127
   128     When (p_choice = 'D');                                                                                           000128
   129       TITLE1 = Center('TASKS ADMINISTRATOR DELETE':%len(TITLE1));                                                    000129
   130     When (p_choice = 'V');                                                                                           000130
   131       TITLE1 = Center('TASKS ADMINISTRATOR VIEW':%len(TITLE1));                                                      000131
   132                                                                                                                      000132
   133       // Subfile                                                                                                     000133
   134     When (p_choice = 'S');                                                                                           000134
   135       TITLE1 = Center('TASKS ADMINISTRATOR MAIN MENU':%len(TITLE1));                                                 000135
   136   EndSl;                                                                                                             000136
   137                                                                                                                      000137
   138   // Use an IF/ELSEIF as a different way of doing SELECT groups                                                      000138
   139   // here is an example:                                                                                             000139
   140   If (p_choice = 'S');                                                                                               000140
   141     FOOTTEXT = 'F3=Exit  F5=Refresh  F6=Create';                                                                     000141
   142   elseif (p_choice = 'I' or p_choice= 'M' or p_choice= 'D');                                                         000142
   143     FOOTTEXT = 'F3=Exit      F10=Confirm';                                                                           000143
   144   elseif (p_choice = 'V');                                                                                           000144
   145     FOOTTEXT = 'F3=Exit  ';                                                                                          000145
   146   EndIf;                                                                                                             000146
   147                                                                                                                      000147
   148   write HEADER;                                                                                                      000148
   149   write FOOTER;                                                                                                      000149
   150 end-proc;                                                                                                            000150
   151                                                                                                                      000151
   152                                                                                                                      000152
   153                                                                                                                      000153
   154                                                                                                                      000154
   155                                                                                                                      000155
   156                                                                                                                      000156
   157                                                                                                                      000157
   158                                                                                                                      000158
   159                                                                                                                      000159
   160                                                                                                                      000160
   161                                                                                                                      000161
   162                                                                                                                      000162
   163 // --------------------------------------------------------------------------                                        000163
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      5
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   164 // This procedure executes and show the screen choiced by parameter                                                  000164
   165 // --------------------------------------------------------------------------                                        000165
   166 Dcl-Proc ShowScreen;                                                                                                 000166
   167   Dcl-Pi ShowScreen ;                                                                                                000167
   168     p_choice char(1);                                                                                                000168
   169   end-pi;                                                                                                            000169
   170                                                                                                                      000170
   171   Select;                                                                                                            000171
   172     When (p_choice = 'I');                                                                                           000172
   173       InsertScreen(p_choice);                                                                                        000173
   174     When (p_choice = 'S');                                                                                           000174
   175       ShowSubfile(p_choice);                                                                                         000175
   176     When (p_choice = 'M');                                                                                           000176
   177       ModifyScreen(p_choice);                                                                                        000177
   178     When (p_choice = 'D');                                                                                           000178
   179       DeleteScreen(p_choice);                                                                                        000179
   180     When (p_choice = 'V');                                                                                           000180
   181       ViewScreen(p_choice);                                                                                          000181
   182   EndSl;                                                                                                             000182
   183                                                                                                                      000183
   184 end-proc;                                                                                                            000184
   185                                                                                                                      000185
   186                                                                                                                      000186
   187                                                                                                                      000187
   188                                                                                                                      000188
   189                                                                                                                      000189
   190                                                                                                                      000190
   191                                                                                                                      000191
   192 // --------------------------------------------------------------------------                                        000192
   193 // Show Window to user for confirm the current action                                                                000193
   194 // --------------------------------------------------------------------------                                        000194
   195 Dcl-Proc ShowWdw;                                                                                                    000195
   196   Dcl-Pi ShowWdw;                                                                                                    000196
   197     p_choice char(1);                                                                                                000197
   198   end-pi;                                                                                                            000198
   199                                                                                                                      000199
   200   // 'C' for confirm save record in database                                                                         000200
   201   If (p_choice = 'C');                                                                                               000201
   202     WDWTEXT1 = 'Are you sure to execute this action?';                                                               000202
   203     WDWTEXT2 = 'Please type Y/N ';                                                                                   000203
   204     write WDWCONFIRM;                                                                                                000204
   205     exfmt WDWCONFIRM;                                                                                                000205
   206   EndIf;                                                                                                             000206
   207                                                                                                                      000207
   208   // 'M' for message information                                                                                     000208
   209   If (p_choice = 'M');                                                                                               000209
   210     WDWMSG1 = 'Your record has been saved';                                                                          000210
   211     exfmt WDWMESSAGE;                                                                                                000211
   212   EndIf;                                                                                                             000212
   213                                                                                                                      000213
   214   If (p_choice = 'D');                                                                                               000214
   215     WDWMSG1 = 'Your record has been deleted';                                                                        000215
   216     exfmt WDWMESSAGE;                                                                                                000216
   217   EndIf;                                                                                                             000217
   218                                                                                                                      000218
   219   // 'E' for error message                                                                                           000219
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      6
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   220   If (p_choice = 'E');                                                                                               000220
   221     WDWMSG1 = 'Error executing this action ';                                                                        000221
   222     exfmt WDWMESSAGE;                                                                                                000222
   223   EndIf;                                                                                                             000223
   224                                                                                                                      000224
   225 end-proc;                                                                                                            000225
   226                                                                                                                      000226
   227                                                                                                                      000227
   228                                                                                                                      000228
   229                                                                                                                      000229
   230                                                                                                                      000230
   231                                                                                                                      000231
   232                                                                                                                      000232
   233                                                                                                                      000233
   234                                                                                                                      000234
   235                                                                                                                      000235
   236                                                                                                                      000236
   237 // --------------------------------------------------------------------------                                        000237
   238 // This procedure Center the titles of the screen                                                                    000238
   239 // --------------------------------------------------------------------------                                        000239
   240 Dcl-Proc Center;                                                                                                     000240
   241   Dcl-Pi Center char(80);                                                                                            000241
   242     Par_Text char(80) value;                                                                                         000242
   243     Par_Length zoned(2:0) value;                                                                                     000243
   244   end-pi;                                                                                                            000244
   245                                                                                                                      000245
   246   // Local variables                                                                                                 000246
   247   Dcl-S LenBlanks zoned(2:0);                                                                                        000247
   248   Dcl-S InitPosition zoned(2:0);                                                                                     000248
   249   Dcl-S Centeredtext char(80);                                                                                       000249
   250                                                                                                                      000250
   251   LenBlanks= Par_Length - %Len(%Trim(Par_Text));                                                                     000251
   252   InitPosition = LenBlanks /2;                                                                                       000252
   253   %Subst(Centeredtext:InitPosition)= %Trim(Par_Text);                                                                000253
   254   Return Centeredtext;                                                                                               000254
   255                                                                                                                      000255
   256 end-proc;                                                                                                            000256
   257                                                                                                                      000257
   258                                                                                                                      000258
   259                                                                                                                      000259
   260                                                                                                                      000260
   261                                                                                                                      000261
   262                                                                                                                      000262
   263                                                                                                                      000263
   264                                                                                                                      000264
   265 // --------------------------------------------------------------------------                                        000265
   266 // Show the subfile in the screen                                                                                    000266
   267 // --------------------------------------------------------------------------                                        000267
   268 Dcl-Proc ShowSubfile;                                                                                                000268
   269   Dcl-Pi ShowSubfile;                                                                                                000269
   270     p_choice char(1);                                                                                                000270
   271   end-pi;                                                                                                            000271
   272                                                                                                                      000272
   273   Dcl-S w_exist char(1);                                                                                             000273
   274   Dcl-S choice char(1);                                                                                              000274
   275                                                                                                                      000275
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      7
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   276   dow (not pfkey(03));                                                                                               000276
   277     WriteScreen(p_choice);                                                                                           000277
   278     ActivateSubfile();                                                                                               000278
   279     exfmt SFLTASKCTL;                                                                                                000279
   280                                                                                                                      000280
   281     Select ;                                                                                                         000281
   282       When (pfkey(03));                                                                                              000282
   283         pfkey(03) = *Off;                                                                                            000283
   284         reset Initialpos;                                                                                            000284
   285         reset Finalpos;                                                                                              000285
   286         leave;                                                                                                       000286
   287       When (infds.funcKey = PAGEUP);                                                                                 000287
   288         If (Initialpos = 0 and Finalpos = 10);                                                                       000288
   289           iter;                                                                                                      000289
   290         elseif (Initialpos > 1 and Finalpos > 10);                                                                   000290
   291           Initialpos -= 11;                                                                                          000291
   292           Finalpos -= 10;                                                                                            000292
   293           ShowScreen(p_choice);                                                                                      000293
   294           leave;                                                                                                     000294
   295         EndIf;                                                                                                       000295
   296                                                                                                                      000296
   297       When (infds.funcKey = PAGEDOWN);                                                                               000297
   298                                                                                                                      000298
   299         If (Initialpos > 0 and Finalpos > 10);                                                                       000299
   300                                                                                                                      000300
   301           exec sql                                                                                                   000301
   302           SELECT '1'                                                                                                 000302
   303             INTO : w_exist                                                                                           000303
   304             FROM (SELECT A.*,                                                                                        000304
   305                          RowNumber()                                                                                 000305
   306                     Over()                                                                                           000306
   307                     as RNum                                                                                          000307
   308                     FROM CRUD01TBL AS A                                                                              000308
   309                     Where 1 = 1)                                                                                     000309
   310             as Tbl                                                                                                   000310
   311             Where RNum BetWeen : Initialpos AND                                                                      000311
   312                   :Finalpos                                                                                          000312
   313             FETCH FIRST ROW ONLY;                                                                                    000313
   314                                                                                                                      000314
   315           If (w_exist <> '1');                                                                                       000315
   316             Initialpos -= 11;                                                                                        000316
   317             Finalpos -= 10;                                                                                          000317
   318           EndIf;                                                                                                     000318
   319                                                                                                                      000319
   320           ShowScreen(p_choice);                                                                                      000320
   321           leave;                                                                                                     000321
   322                                                                                                                      000322
   323         Else;                                                                                                        000323
   324           ShowScreen(p_choice);                                                                                      000324
   325           leave;                                                                                                     000325
   326         EndIf;                                                                                                       000326
   327                                                                                                                      000327
   328       When (pfkey(05));                                                                                              000328
   329                                                                                                                      000329
   330         reset Initialpos;                                                                                            000330
   331         reset Finalpos;                                                                                              000331
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      8
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   332                                                                                                                      000332
   333         ShowScreen(p_choice);                                                                                        000333
   334         leave;                                                                                                       000334
   335       When (pfkey(06));                                                                                              000335
   336         choice = 'I';                                                                                                000336
   337         ShowScreen(choice);                                                                                          000337
   338         leave;                                                                                                       000338
   339       Other;                                                                                                         000339
   340         reset w_Wheresfl;                                                                                            000340
   341                                                                                                                      000341
   342         // if there are selected records in subfile then executes                                                    000342
   343         If (taskrrn > *zeros);                                                                                       000343
   344           for taskrrn = 1 to PERPAGE;                                                                                000344
   345             chain taskrrn SFLTASK;                                                                                   000345
   346             If (%found());                                                                                           000346
   347                                                                                                                      000347
   348               Select;                                                                                                000348
   349                 When (OPCTASK = '2');                                                                                000349
   350                                                                                                                      000350
   351                   clear Ds_datacrud;                                                                                 000351
   352                                                                                                                      000352
   353                   // Loads the data into data structure                                                              000353
   354                   exec sql                                                                                           000354
   355                 SELECT * INTO:Ds_datacrud                                                                            000355
   356                   FROM CRUD01TBL                                                                                     000356
   357                   WHERE TASK_ID = : SFLTASKID;                                                                       000357
   358                                                                                                                      000358
   359                   choice = 'M';                                                                                      000359
   360                   ShowScreen(choice);                                                                                000360
   361                   leave;                                                                                             000361
   362                 When (OPCTASK = '4');                                                                                000362
   363                   clear Ds_datacrud;                                                                                 000363
   364                                                                                                                      000364
   365                   // Loads the data into data structure                                                              000365
   366                   exec sql                                                                                           000366
   367                 SELECT * INTO:Ds_datacrud                                                                            000367
   368                   FROM CRUD01TBL                                                                                     000368
   369                   WHERE TASK_ID = : SFLTASKID;                                                                       000369
   370                                                                                                                      000370
   371                   choice = 'D';                                                                                      000371
   372                   ShowScreen(choice);                                                                                000372
   373                   leave;                                                                                             000373
   374                 When (OPCTASK = '5');                                                                                000374
   375                   clear Ds_datacrud;                                                                                 000375
   376                                                                                                                      000376
   377                   // Loads the data into data structure                                                              000377
   378                   exec sql                                                                                           000378
   379                 SELECT * INTO:Ds_datacrud                                                                            000379
   380                   FROM CRUD01TBL                                                                                     000380
   381                   WHERE TASK_ID = : SFLTASKID;                                                                       000381
   382                                                                                                                      000382
   383                   choice = 'V';                                                                                      000383
   384                   ShowScreen(choice);                                                                                000384
   385                   leave;                                                                                             000385
   386               EndSl;                                                                                                 000386
   387               // Clean the field                                                                                     000387
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page      9
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   388               OPCTASK = *Blanks;                                                                                     000388
   389               Update SFLTASK;                                                                                        000389
   390             Else;                                                                                                    000390
   391               leave;                                                                                                 000391
   392             EndIf;                                                                                                   000392
   393           endfor;                                                                                                    000393
   394         EndIf;                                                                                                       000394
   395     EndSl;                                                                                                           000395
   396     If (w_Crudfinalize = *On);                                                                                       000396
   397       w_Crudfinalize = *Off;                                                                                         000397
   398       leave;                                                                                                         000398
   399     EndIf;                                                                                                           000399
   400                                                                                                                      000400
   401   enddo;                                                                                                             000401
   402                                                                                                                      000402
   403 end-proc ;                                                                                                           000403
   404                                                                                                                      000404
   405                                                                                                                      000405
   406                                                                                                                      000406
   407                                                                                                                      000407
   408                                                                                                                      000408
   409                                                                                                                      000409
   410                                                                                                                      000410
   411 // --------------------------------------------------------------------------                                        000411
   412 // handle all screen validation                                                                                      000412
   413 // --------------------------------------------------------------------------                                        000413
   414 Dcl-Proc ScreenValidation ;                                                                                          000414
   415   Dcl-Pi ScreenValidation Ind;                                                                                       000415
   416     p_choice char(1);                                                                                                000416
   417   end-pi;                                                                                                            000417
   418                                                                                                                      000418
   419   Dcl-S w_ValidisnotOK Ind;                                                                                          000419
   420   Dcl-S w_Exists char(1);                                                                                            000420
   421                                                                                                                      000421
   422   // Set zeros in general variable based in  DisplayIndicators                                                       000422
   423   IndErrors = *zeros;                                                                                                000423
   424                                                                                                                      000424
   425   If (p_choice = 'I'); // Validations for Insert                                                                     000425
   426                                                                                                                      000426
   427     TurnoffErrors();                                                                                                 000427
   428                                                                                                                      000428
   429     // Search Task id entered into database                                                                          000429
   430     exec sql                                                                                                         000430
   431       SELECT '1'                                                                                                     000431
   432         INTO : w_Exists                                                                                              000432
   433         FROM CRUD01TBL                                                                                               000433
   434         WHERE TASK_ID = :CRUDTASKID;                                                                                 000434
   435                                                                                                                      000435
   436     Taskidexisterror_31 = (w_Exists = '1');                                                                          000436
   437                                                                                                                      000437
   438     // Validation of dates                                                                                           000438
   439     test(De) *iso STARTDATE; //Validates if date is in YYYYMMDD                                                      000439
   440                                                                                                                      000440
   441     Startdateerror_32 = %error;                                                                                      000441
   442                                                                                                                      000442
   443     test(De) *iso ENDDATE;                                                                                           000443
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     10
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   444                                                                                                                      000444
   445     Enddateerror_33 = %error;                                                                                        000445
   446                                                                                                                      000446
   447     If (STARTDATE <> *zeros and ENDDATE <> *zeros                                                                    000447
   448         and Startdateerror_32 = *Off and Enddateerror_33 = *Off);                                                    000448
   449       If (STARTDATE > ENDDATE);                                                                                      000449
   450         Dategreaterthanerror_34 = *On;                                                                               000450
   451       EndIf;                                                                                                         000451
   452     EndIf;                                                                                                           000452
   453   EndIf;                                                                                                             000453
   454                                                                                                                      000454
   455   w_ValidisnotOK = IndErrors <> *Zeros;                                                                              000455
   456                                                                                                                      000456
   457   Return w_ValidisnotOK;                                                                                             000457
   458 end-proc;                                                                                                            000458
   459                                                                                                                      000459
   460                                                                                                                      000460
   461                                                                                                                      000461
   462                                                                                                                      000462
   463                                                                                                                      000463
   464                                                                                                                      000464
   465 // --------------------------------------------------------------------------                                        000465
   466 // reset errors                                                                                                      000466
   467 // --------------------------------------------------------------------------                                        000467
   468 Dcl-Proc TurnoffErrors;                                                                                              000468
   469   Taskidexisterror_31 = *Off;                                                                                        000469
   470   Startdateerror_32 = *Off;                                                                                          000470
   471   Enddateerror_33 = *Off;                                                                                            000471
   472   Dategreaterthanerror_34 = *Off;                                                                                    000472
   473 end-proc ;                                                                                                           000473
   474                                                                                                                      000474
   475                                                                                                                      000475
   476                                                                                                                      000476
   477                                                                                                                      000477
   478                                                                                                                      000478
   479 // --------------------------------------------------------------------------                                        000479
   480 // This procedure set the sql variable to the procedure to                                                           000480
   481 // populate the subfile with data based in the customized                                                            000481
   482 // sql variable                                                                                                      000482
   483 // --------------------------------------------------------------------------                                        000483
   484 Dcl-Proc SubfileStart;                                                                                               000484
   485   Dcl-Pi SubfileStart;                                                                                               000485
   486   end-pi;                                                                                                            000486
   487                                                                                                                      000487
   488   // Variable for store the sql query required                                                                       000488
   489   Dcl-S sqlcustomized char(500);                                                                                     000489
   490                                                                                                                      000490
   491   sqlcustomized = 'SELECT TASK_ID , NAME , STARTDATE , ENDDATE , STATE '+                                            000491
   492                   'FROM (SELECT A.*, RowNumber() Over() as RNum FROM '+                                              000492
   493                   'CRUD01TBL AS A Where 1=1) as Tbl Where RNum '+                                                    000493
   494                   'BetWeen '+%char(Initialpos)+' and '+%char(Finalpos) +                                             000494
   495                   ' '+%trim(w_Wheresfl);                                                                             000495
   496                                                                                                                      000496
   497   FillSfl(sqlcustomized);                                                                                            000497
   498                                                                                                                      000498
   499 end-proc;                                                                                                            000499
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     11
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   500                                                                                                                      000500
   501                                                                                                                      000501
   502                                                                                                                      000502
   503                                                                                                                      000503
   504                                                                                                                      000504
   505 // --------------------------------------------------------------------------                                        000505
   506 // Initialize and prepare the subfile                                                                                000506
   507 // --------------------------------------------------------------------------                                        000507
   508 Dcl-Proc Sflinitial;                                                                                                 000508
   509   SflEnd = *off;                                                                                                     000509
   510   SflClr = *on;                                                                                                      000510
   511   write SFLTASKCTL;                                                                                                  000511
   512   SflClr = *off;                                                                                                     000512
   513   taskrrn = *zeros;                                                                                                  000513
   514   SflDsp = *off;                                                                                                     000514
   515   SflDspCtl = *off;                                                                                                  000515
   516 end-proc;                                                                                                            000516
   517                                                                                                                      000517
   518                                                                                                                      000518
   519                                                                                                                      000519
   520                                                                                                                      000520
   521                                                                                                                      000521
   522                                                                                                                      000522
   523                                                                                                                      000523
   524 // --------------------------------------------------------------------------                                        000524
   525 // Activate the subfile for being displayed on screen                                                                000525
   526 // --------------------------------------------------------------------------                                        000526
   527 Dcl-Proc ActivateSubfile;                                                                                            000527
   528   Sflinitial();                                                                                                      000528
   529   SubfileStart();                                                                                                    000529
   530                                                                                                                      000530
   531   SflEnd = Gettotalrecords() < 10;                                                                                   000531
   532                                                                                                                      000532
   533   If (taskrrn > 0);                                                                                                  000533
   534     SflDsp = *On;                                                                                                    000534
   535   Else;                                                                                                              000535
   536     write EMPTY;                                                                                                     000536
   537   EndIf;                                                                                                             000537
   538                                                                                                                      000538
   539   SflDspCtl = *On;                                                                                                   000539
   540 end-proc;                                                                                                            000540
   541                                                                                                                      000541
   542                                                                                                                      000542
   543                                                                                                                      000543
   544                                                                                                                      000544
   545                                                                                                                      000545
   546                                                                                                                      000546
   547                                                                                                                      000547
   548                                                                                                                      000548
   549 // --------------------------------------------------------------------------                                        000549
   550 // Fill the subfile with a Cursor                                                                                    000550
   551 // --------------------------------------------------------------------------                                        000551
   552 Dcl-Proc FillSfl;                                                                                                    000552
   553   Dcl-Pi FillSfl;                                                                                                    000553
   554     Par_sqlcustomized char(500);                                                                                     000554
   555   end-pi;                                                                                                            000555
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     12
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   556                                                                                                                      000556
   557   Dcl-S Count zoned(2:0);                                                                                            000557
   558                                                                                                                      000558
   559   Dcl-S LastRRN zoned(10:0);                                                                                         000559
   560                                                                                                                      000560
   561   // Set previous values for indicates final of subfile is it is                                                     000561
   562   // necessary                                                                                                       000562
   563   clear Previnitialpos;                                                                                              000563
   564   clear PrevFinalpos;                                                                                                000564
   565                                                                                                                      000565
   566   Previnitialpos = Initialpos;                                                                                       000566
   567   PrevFinalpos = Finalpos;                                                                                           000567
   568                                                                                                                      000568
   569   clear Ds_taskdata;                                                                                                 000569
   570                                                                                                                      000570
   571   exec sql                                                                                                           000571
   572     PREPARE YOURQUERY FROM : Par_sqlcustomized;                                                                      000572
   573                                                                                                                      000573
   574   exec sql                                                                                                           000574
   575     DECLARE TASK_CURSOR INSENSITIVE SCROLL CURSOR FOR YOURQUERY;                                                     000575
   576                                                                                                                      000576
   577   exec sql                                                                                                           000577
   578     OPEN TASK_CURSOR;                                                                                                000578
   579                                                                                                                      000579
   580   exec sql                                                                                                           000580
   581     FETCH NEXT FROM TASK_CURSOR INTO : Ds_taskdata;                                                                  000581
   582                                                                                                                      000582
   583   dow (xSQLState <> NODATA_ON_SQL) and (Count < PERPAGE);                                                            000583
   584     Count = Count+1;                                                                                                 000584
   585     LastRRN = LastRRN+1;                                                                                             000585
   586                                                                                                                      000586
   587     If (xSQLState = SUCCESS_ON_SQL);                                                                                 000587
   588       DatatoSfl();                                                                                                   000588
   589     EndIf;                                                                                                           000589
   590                                                                                                                      000590
   591     exec sql                                                                                                         000591
   592       FETCH NEXT FROM TASK_CURSOR INTO : Ds_taskdata;                                                                000592
   593     If (xSQLState <> SUCCESS_ON_SQL);                                                                                000593
   594       If (taskrrn = 10);                                                                                             000594
   595         Initialpos += Count+1;                                                                                       000595
   596         Finalpos += LastRRN;                                                                                         000596
   597       EndIf;                                                                                                         000597
   598     EndIf;                                                                                                           000598
   599   enddo;                                                                                                             000599
   600                                                                                                                      000600
   601   exec sql                                                                                                           000601
   602     CLOSE TASK_CURSOR;                                                                                               000602
   603 end-proc;                                                                                                            000603
   604                                                                                                                      000604
   605                                                                                                                      000605
   606                                                                                                                      000606
   607                                                                                                                      000607
   608                                                                                                                      000608
   609                                                                                                                      000609
   610                                                                                                                      000610
   611 // --------------------------------------------------------------------------                                        000611
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     13
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   612 // This procedure assign the data fetched from cursor to subfile                                                     000612
   613 // --------------------------------------------------------------------------                                        000613
   614 Dcl-Proc DatatoSfl;                                                                                                  000614
   615   taskrrn +=1;                                                                                                       000615
   616   SFLTASKID = Ds_taskdata.Taskid;                                                                                    000616
   617   SFLTASKNAM = Ds_taskdata.Nametask;                                                                                 000617
   618   SFLSTRDATE = Ds_taskdata.Start_date;                                                                               000618
   619   SFLENDDATE = Ds_taskdata.End_date;                                                                                 000619
   620   SFLSTATE = Ds_taskdata.Taskstate;                                                                                  000620
   621   write SFLTASK;                                                                                                     000621
   622   clear SFLTASK;                                                                                                     000622
   623 end-proc;                                                                                                            000623
   624                                                                                                                      000624
   625                                                                                                                      000625
   626                                                                                                                      000626
   627                                                                                                                      000627
   628                                                                                                                      000628
   629                                                                                                                      000629
   630                                                                                                                      000630
   631                                                                                                                      000631
   632 // --------------------------------------------------------------------------                                        000632
   633 // get total records                                                                                                 000633
   634 // --------------------------------------------------------------------------                                        000634
   635 Dcl-Proc Gettotalrecords;                                                                                            000635
   636   Dcl-Pi Gettotalrecords zoned(10);                                                                                  000636
   637   end-pi;                                                                                                            000637
   638                                                                                                                      000638
   639   Dcl-S w_Total zoned(10:0);                                                                                         000639
   640                                                                                                                      000640
   641   Dcl-S sqlcustomized char(500);                                                                                     000641
   642                                                                                                                      000642
   643   sqlcustomized = 'SELECT COUNT(*) '+                                                                                000643
   644          'FROM (SELECT A.*, RowNumber() Over() as RNum FROM '+                                                       000644
   645          'CRUD01TBL AS A Where 1=1) as Tbl Where RNum '+                                                             000645
   646          'BetWeen '+%char(Previnitialpos)+' and '+%char(PrevFinalpos) +                                              000646
   647          ' '+%trim(w_Wheresfl);                                                                                      000647
   648                                                                                                                      000648
   649   exec sql                                                                                                           000649
   650     PREPARE QRY FROM: sqlcustomized;                                                                                 000650
   651                                                                                                                      000651
   652   exec sql                                                                                                           000652
   653     DECLARE QRYC CURSOR FOR QRY;                                                                                     000653
   654                                                                                                                      000654
   655   exec sql                                                                                                           000655
   656     OPEN QRYC;                                                                                                       000656
   657                                                                                                                      000657
   658   exec sql                                                                                                           000658
   659     FETCH QRYC INTO:w_Total;                                                                                         000659
   660                                                                                                                      000660
   661   exec sql                                                                                                           000661
   662     CLOSE QRYC;                                                                                                      000662
   663                                                                                                                      000663
   664   Return w_Total;                                                                                                    000664
   665 end-proc;                                                                                                            000665
   666                                                                                                                      000666
   667                                                                                                                      000667
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     14
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   668                                                                                                                      000668
   669                                                                                                                      000669
   670                                                                                                                      000670
   671                                                                                                                      000671
   672                                                                                                                      000672
   673                                                                                                                      000673
   674 // --------------------------------------------------------------------------                                        000674
   675 // run the CRUD                                                                                                      000675
   676 // --------------------------------------------------------------------------                                        000676
   677 Dcl-Proc ExecuteCrudScreen;                                                                                          000677
   678   Dcl-Pi ExecuteCrudScreen;                                                                                          000678
   679     p_choice char(1);                                                                                                000679
   680   end-pi;                                                                                                            000680
   681                                                                                                                      000681
   682   If (p_choice = 'I'); // Insert Screen                                                                              000682
   683     InsertScreen(p_choice);                                                                                          000683
   684   EndIf;                                                                                                             000684
   685                                                                                                                      000685
   686   If (p_choice = 'M'); // Modify Screen                                                                              000686
   687     ModifyScreen(p_choice);                                                                                          000687
   688   EndIf;                                                                                                             000688
   689                                                                                                                      000689
   690   If (p_choice = 'D'); // Delete Screen                                                                              000690
   691     DeleteScreen(p_choice);                                                                                          000691
   692   EndIf;                                                                                                             000692
   693                                                                                                                      000693
   694   If (p_choice = 'V'); // View Screen                                                                                000694
   695     ViewScreen(p_choice);                                                                                            000695
   696   EndIf;                                                                                                             000696
   697 end-proc;                                                                                                            000697
   698                                                                                                                      000698
   699                                                                                                                      000699
   700                                                                                                                      000700
   701                                                                                                                      000701
   702                                                                                                                      000702
   703                                                                                                                      000703
   704                                                                                                                      000704
   705 // --------------------------------------------------------------------------                                        000705
   706 // write the screen                                                                                                  000706
   707 // --------------------------------------------------------------------------                                        000707
   708 Dcl-Proc InsertScreen;                                                                                               000708
   709   Dcl-Pi InsertScreen;                                                                                               000709
   710     p_choice char(1);                                                                                                000710
   711   end-pi;                                                                                                            000711
   712                                                                                                                      000712
   713   Dcl-S choice char(1);                                                                                              000713
   714                                                                                                                      000714
   715   WriteScreen(p_choice);                                                                                             000715
   716                                                                                                                      000716
   717   dow (not pfkey(03));                                                                                               000717
   718     ProtectFields_35 = *Off;                                                                                         000718
   719     ProtectFields_36 = *Off;                                                                                         000719
   720     exfmt CRUDTASK;                                                                                                  000720
   721     Select;                                                                                                          000721
   722       When (pfkey(03));                                                                                              000722
   723         clear CRUDTASK;                                                                                              000723
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     15
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   724         reset Initialpos;                                                                                            000724
   725         reset Finalpos;                                                                                              000725
   726         pfkey(03) = *Off;                                                                                            000726
   727         choice = 'S';                                                                                                000727
   728         ShowScreen(choice);                                                                                          000728
   729         leave;                                                                                                       000729
   730       When (pfkey(10));                                                                                              000730
   731         If (ScreenValidation(p_choice) = *Off);                                                                      000731
   732                                                                                                                      000732
   733           // Executes window confirmation                                                                            000733
   734           choice = 'C';                                                                                              000734
   735           ShowWdw(choice);                                                                                           000735
   736           If (WDWCHOICE = 'Y');                                                                                      000736
   737             LoaddatatoDs();                                                                                          000737
   738                                                                                                                      000738
   739             exec sql                                                                                                 000739
   740             INSERT INTO CRUD01TBL                                                                                    000740
   741               VALUES (:Ds_datacrud);                                                                                 000741
   742                                                                                                                      000742
   743             If (xSQLState = SUCCESS_ON_SQL);                                                                         000743
   744               choice = 'M'; // Message of successful                                                                 000744
   745               ShowWdw(choice);                                                                                       000745
   746               clear CRUDTASK;                                                                                        000746
   747               reset Initialpos;                                                                                      000747
   748               reset Finalpos;                                                                                        000748
   749               choice = 'S';                                                                                          000749
   750               ShowScreen(choice);                                                                                    000750
   751               leave;                                                                                                 000751
   752             Else;                                                                                                    000752
   753               choice = 'E'; // Error Message                                                                         000753
   754               ShowWdw(choice);                                                                                       000754
   755             EndIf;                                                                                                   000755
   756           Else ;                                                                                                     000756
   757             clear CRUDTASK;                                                                                          000757
   758           EndIf;                                                                                                     000758
   759         EndIf;                                                                                                       000759
   760                                                                                                                      000760
   761       Other;                                                                                                         000761
   762         If (ScreenValidation(p_choice) = *On);                                                                       000762
   763           iter;                                                                                                      000763
   764         EndIf ;                                                                                                      000764
   765     EndSl;                                                                                                           000765
   766   enddo;                                                                                                             000766
   767 end-proc;                                                                                                            000767
   768                                                                                                                      000768
   769                                                                                                                      000769
   770                                                                                                                      000770
   771 // --------------------------------------------------------------------------                                        000771
   772 // modify screen                                                                                                     000772
   773 // --------------------------------------------------------------------------                                        000773
   774 Dcl-Proc ModifyScreen;                                                                                               000774
   775   Dcl-Pi ModifyScreen;                                                                                               000775
   776     p_choice char(1);                                                                                                000776
   777   end-pi;                                                                                                            000777
   778                                                                                                                      000778
   779   Dcl-S choice char(1);                                                                                              000779
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     16
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   780                                                                                                                      000780
   781   LoaddatatoScreen();                                                                                                000781
   782   WriteScreen(p_choice);                                                                                             000782
   783                                                                                                                      000783
   784   dow (not pfkey(03));                                                                                               000784
   785     ProtectFields_35 = *On;                                                                                          000785
   786     exfmt CRUDTASK;                                                                                                  000786
   787     Select;                                                                                                          000787
   788       When (pfkey(03));                                                                                              000788
   789         ProtectFields_35 = *Off;                                                                                     000789
   790         clear CRUDTASK;                                                                                              000790
   791         clear OPCTASK;                                                                                               000791
   792         pfkey(03) = *Off;                                                                                            000792
   793         w_Crudfinalize = *On ;                                                                                       000793
   794         reset Initialpos;                                                                                            000794
   795         reset Finalpos;                                                                                              000795
   796         choice = 'S';                                                                                                000796
   797         ShowScreen(choice);                                                                                          000797
   798         leave;                                                                                                       000798
   799       When (pfkey(10));                                                                                              000799
   800         If (ScreenValidation(p_choice) = *Off);                                                                      000800
   801                                                                                                                      000801
   802           // Executes window confirmation                                                                            000802
   803           choice = 'C';                                                                                              000803
   804           ShowWdw(choice);                                                                                           000804
   805           If (WDWCHOICE = 'Y');                                                                                      000805
   806                                                                                                                      000806
   807             exec sql                                                                                                 000807
   808             UPDATE CRUD01TBL                                                                                         000808
   809               SET NAME = :NAMETASK,                                                                                  000809
   810                   DESCR = :DESCRP,                                                                                   000810
   811                   ENDDES = :SOLUTION,                                                                                000811
   812                   STARTDATE = :STARTDATE,                                                                            000812
   813                   ENDDATE = :ENDDATE,                                                                                000813
   814                   STATE = :STATETASK,                                                                                000814
   815                   OWNER = :CurrentUser                                                                               000815
   816               WHERE TASK_ID = : CRUDTASKID;                                                                          000816
   817                                                                                                                      000817
   818             If (xSQLState = SUCCESS_ON_SQL);                                                                         000818
   819               choice = 'M'; // Message of successful                                                                 000819
   820               ShowWdw(choice);                                                                                       000820
   821               clear CRUDTASK;                                                                                        000821
   822               clear OPCTASK;                                                                                         000822
   823               reset Initialpos;                                                                                      000823
   824               reset Finalpos;                                                                                        000824
   825               choice = 'S';                                                                                          000825
   826               ShowScreen(choice);                                                                                    000826
   827               w_Crudfinalize = *On ;                                                                                 000827
   828               leave;                                                                                                 000828
   829             Else;                                                                                                    000829
   830               choice = 'E'; // Error Message                                                                         000830
   831               ShowWdw(choice);                                                                                       000831
   832             EndIf;                                                                                                   000832
   833           Else ;                                                                                                     000833
   834             clear CRUDTASK;                                                                                          000834
   835           EndIf;                                                                                                     000835
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     17
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   836         EndIf;                                                                                                       000836
   837                                                                                                                      000837
   838       Other;                                                                                                         000838
   839         If (ScreenValidation(p_choice) = *On);                                                                       000839
   840           iter;                                                                                                      000840
   841         EndIf ;                                                                                                      000841
   842     EndSl;                                                                                                           000842
   843   enddo;                                                                                                             000843
   844 end-proc;                                                                                                            000844
   845                                                                                                                      000845
   846                                                                                                                      000846
   847                                                                                                                      000847
   848                                                                                                                      000848
   849                                                                                                                      000849
   850                                                                                                                      000850
   851                                                                                                                      000851
   852                                                                                                                      000852
   853 // --------------------------------------------------------------------------                                        000853
   854 // delete screen                                                                                                     000854
   855 // --------------------------------------------------------------------------                                        000855
   856 Dcl-Proc DeleteScreen;                                                                                               000856
   857   Dcl-Pi DeleteScreen;                                                                                               000857
   858     p_choice char(1);                                                                                                000858
   859   end-pi;                                                                                                            000859
   860                                                                                                                      000860
   861   Dcl-S choice char(1);                                                                                              000861
   862                                                                                                                      000862
   863   LoaddatatoScreen();                                                                                                000863
   864   WriteScreen(p_choice);                                                                                             000864
   865                                                                                                                      000865
   866   dow (not pfkey(03));                                                                                               000866
   867     ProtectFields_35 = *On;                                                                                          000867
   868     ProtectFields_36 = *On;                                                                                          000868
   869     exfmt CRUDTASK;                                                                                                  000869
   870     Select;                                                                                                          000870
   871       When (pfkey(03));                                                                                              000871
   872         ProtectFields_35 = *Off;                                                                                     000872
   873         ProtectFields_36 = *Off;                                                                                     000873
   874         clear CRUDTASK;                                                                                              000874
   875         clear OPCTASK;                                                                                               000875
   876         pfkey(03) = *Off;                                                                                            000876
   877         w_Crudfinalize = *On ;                                                                                       000877
   878         reset Initialpos;                                                                                            000878
   879         reset Finalpos;                                                                                              000879
   880         choice = 'S';                                                                                                000880
   881         ShowScreen(choice);                                                                                          000881
   882         leave;                                                                                                       000882
   883       When (pfkey(10));                                                                                              000883
   884         If (ScreenValidation(p_choice) = *Off);                                                                      000884
   885                                                                                                                      000885
   886           // Executes window confirmation                                                                            000886
   887           choice = 'C';                                                                                              000887
   888           ShowWdw(choice);                                                                                           000888
   889           If (WDWCHOICE = 'Y');                                                                                      000889
   890                                                                                                                      000890
   891             exec sql                                                                                                 000891
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     18
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   892             DELETE FROM CRUD01TBL WHERE TASK_ID = : CRUDTASKID;                                                      000892
   893                                                                                                                      000893
   894             If (xSQLState = SUCCESS_ON_SQL);                                                                         000894
   895               ShowWdw(p_choice);                                                                                     000895
   896               clear CRUDTASK;                                                                                        000896
   897               clear OPCTASK;                                                                                         000897
   898               reset Initialpos;                                                                                      000898
   899               reset Finalpos;                                                                                        000899
   900               choice = 'S';                                                                                          000900
   901               ShowScreen(choice);                                                                                    000901
   902               w_Crudfinalize = *On ;                                                                                 000902
   903               leave;                                                                                                 000903
   904             Else;                                                                                                    000904
   905               choice = 'E'; // Error Message                                                                         000905
   906               ShowWdw(choice);                                                                                       000906
   907             EndIf;                                                                                                   000907
   908           Else ;                                                                                                     000908
   909             clear CRUDTASK;                                                                                          000909
   910           EndIf;                                                                                                     000910
   911         EndIf;                                                                                                       000911
   912                                                                                                                      000912
   913       Other;                                                                                                         000913
   914         If (ScreenValidation(p_choice) = *On);                                                                       000914
   915           iter;                                                                                                      000915
   916         EndIf ;                                                                                                      000916
   917     EndSl;                                                                                                           000917
   918   enddo;                                                                                                             000918
   919 end-proc;                                                                                                            000919
   920                                                                                                                      000920
   921                                                                                                                      000921
   922                                                                                                                      000922
   923                                                                                                                      000923
   924                                                                                                                      000924
   925                                                                                                                      000925
   926                                                                                                                      000926
   927 // --------------------------------------------------------------------------                                        000927
   928 // view the screen                                                                                                   000928
   929 // --------------------------------------------------------------------------                                        000929
   930 Dcl-Proc ViewScreen;                                                                                                 000930
   931   Dcl-Pi ViewScreen;                                                                                                 000931
   932     p_choice char(1);                                                                                                000932
   933   end-pi;                                                                                                            000933
   934                                                                                                                      000934
   935   Dcl-S choice char(1);                                                                                              000935
   936                                                                                                                      000936
   937   LoaddatatoScreen();                                                                                                000937
   938   WriteScreen(p_choice);                                                                                             000938
   939                                                                                                                      000939
   940   dow (not pfkey(03));                                                                                               000940
   941     ProtectFields_35 = *On;                                                                                          000941
   942     ProtectFields_36 = *On;                                                                                          000942
   943     exfmt CRUDTASK;                                                                                                  000943
   944     If (pfkey(03));                                                                                                  000944
   945       ProtectFields_35 = *Off;                                                                                       000945
   946       ProtectFields_36 = *Off;                                                                                       000946
   947       clear CRUDTASK;                                                                                                000947
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     19
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   948       clear OPCTASK;                                                                                                 000948
   949       pfkey(03) = *Off;                                                                                              000949
   950       w_Crudfinalize = *On ;                                                                                         000950
   951       reset Initialpos;                                                                                              000951
   952       reset Finalpos;                                                                                                000952
   953       choice = 'S';                                                                                                  000953
   954       ShowScreen(choice);                                                                                            000954
   955       leave;                                                                                                         000955
   956     EndIf;                                                                                                           000956
   957   enddo;                                                                                                             000957
   958 end-proc;                                                                                                            000958
   959                                                                                                                      000959
   960                                                                                                                      000960
   961                                                                                                                      000961
   962                                                                                                                      000962
   963                                                                                                                      000963
   964                                                                                                                      000964
   965                                                                                                                      000965
   966                                                                                                                      000966
   967 // --------------------------------------------------------------------------                                        000967
   968 // load screen data                                                                                                  000968
   969 // --------------------------------------------------------------------------                                        000969
   970 Dcl-Proc LoaddatatoScreen;                                                                                           000970
   971   clear CRUDTASK;                                                                                                    000971
   972   CRUDTASKID = Ds_datacrud.Task_id;                                                                                  000972
   973   NAMETASK = Ds_datacrud.Name;                                                                                       000973
   974   DESCRP = Ds_datacrud.Descr;                                                                                        000974
   975   SOLUTION = Ds_datacrud.Enddes;                                                                                     000975
   976   STARTDATE = Ds_datacrud.Startdate;                                                                                 000976
   977   ENDDATE = Ds_datacrud.Enddate;                                                                                     000977
   978   STATETASK = Ds_datacrud.State;                                                                                     000978
   979 end-proc ;                                                                                                           000979
   980                                                                                                                      000980
   981                                                                                                                      000981
   982                                                                                                                      000982
   983                                                                                                                      000983
   984                                                                                                                      000984
   985                                                                                                                      000985
   986                                                                                                                      000986
   987                                                                                                                      000987
   988                                                                                                                      000988
   989 // --------------------------------------------------------------------------                                        000989
   990 // load data to data structure                                                                                       000990
   991 // --------------------------------------------------------------------------                                        000991
   992 Dcl-Proc LoaddatatoDs;                                                                                               000992
   993   clear Ds_datacrud;                                                                                                 000993
   994   Ds_datacrud.Task_id = CRUDTASKID;                                                                                  000994
   995   Ds_datacrud.Name = %trim(NAMETASK);                                                                                000995
   996   Ds_datacrud.Descr = %trim(DESCRP);                                                                                 000996
   997   Ds_datacrud.Enddes = %trim(SOLUTION);                                                                              000997
   998   Ds_datacrud.Startdate = STARTDATE;                                                                                 000998
   999   Ds_datacrud.Enddate = ENDDATE;                                                                                     000999
  1000   Ds_datacrud.State = STATETASK;                                                                                     001000
  1001   Ds_datacrud.Owner = CurrentUser;                                                                                   001001
  1002 end-proc;                                                                                                            001002
       * * * * *   E N D   O F   S O U R C E   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     20
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     21
Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
                       C o m p i l e   T i m e   D a t a
    * * * * *   E N D   O F   C O M P I L E   T I M E   D A T A   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     22
                          M e s s a g e   S u m m a r y
 Msg id  Sv Number Message text
*RNF0272 30      1 The /COPY directive has a syntax error; directive ignored.
       * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NLITTEN1/CRUD01RPG       PROJEX     25-05-07 11:48:36        Page     23
                            F i n a l   S u m m a r y
  Message Totals:
    Information  (00) . . . . . . . :        0
    Warning      (10) . . . . . . . :        0
    Error        (20) . . . . . . . :        0
    Severe Error (30+)  . . . . . . :        1
    ---------------------------------  -------
    Total . . . . . . . . . . . . . :        1
  Source Totals:
    Records . . . . . . . . . . . . :     1002
    Specifications  . . . . . . . . :      565
    Data records  . . . . . . . . . :        0
    Comments  . . . . . . . . . . . :      393
         * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
Compilation stopped. Severity 30 errors found in program.
          * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

