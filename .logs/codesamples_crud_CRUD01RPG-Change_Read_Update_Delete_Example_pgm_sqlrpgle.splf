>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
CPC2198: Current library changed to NICKLITTEN.
CPC2196: Library NICKLITTEN added to library list.

>> executing command: CRTSQLRPGI srcstmf('/home/NICKLITTEN/builds/nick.litten.public/codesamples/crud/CRUD01RPG-Change_Read_Update_Delete_Example.pgm.sqlrpgle') OBJ(NICKLITTEN/CRUD01RPG) COMMIT(*NONE ) OBJTYPE(*PGM) OPTION(*EVENTF) OUTPUT(*PRINT) TEXT('Change Read Update Delete Example') TGTRLS(V7R4M0) DBGVIEW(*SOURCE) RPGPPOPT(*LVL2) COMPILEOPT('TGTCCSID(*JOB) OPTIMIZE(*FULL) INCDIR(''includes'')')
>> liblist: QSYS QSYS2 QHLPSYS QUSRSYS QSHELL NICKLITTEN NICKLITTEN QTEMP QGPL
>> executing time: 2026-02-09-16.36.34.00

SQL9001: SQL precompile failed.
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      1
  Command  . . . . . . . . . . . . :   CRTBNDRPG
    Issued by  . . . . . . . . . . :     NICKLITTEN
  Program  . . . . . . . . . . . . :   CRUD01RPG
    Library  . . . . . . . . . . . :     NICKLITTEN
  Text 'description' . . . . . . . :   Change Read Update Delete Example
  Source stream file   . . . . . . :   /home/NICKLITTEN/builds/nick.litten.public/codesam
                                       ples/crud/CRUD01RPG-Change_Read_Update_Delete_Exam
                                       ple.pgm.sqlrpgle
    CCSID  . . . . . . . . . . . . :     1208
  Target CCSID . . . . . . . . . . :   *JOB (37)
  Text 'description' . . . . . . . :
  Last Change  . . . . . . . . . . :   26-02-09  14:47:26
  Generation severity level  . . . :   10
  Default activation group . . . . :   *YES
  Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                       *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                       *DEBUGIO   *UNREF     *EVENTF
  Debugging views  . . . . . . . . :   *ALL
  Debug encryption key . . . . . . :   *NONE
  Output . . . . . . . . . . . . . :   *PRINT
  Optimization level . . . . . . . :   *FULL
  Source listing indentation . . . :   *NONE
  Type conversion options  . . . . :   *NONE
  Sort sequence  . . . . . . . . . :   *JOB
  Language identifier  . . . . . . :   *JOB
  Replace program  . . . . . . . . :   *YES
  User profile . . . . . . . . . . :   *USER
  Authority  . . . . . . . . . . . :   *LIBCRTAUT
  Truncate numeric . . . . . . . . :   *YES
  Fix numeric  . . . . . . . . . . :   *NONE
  Target release . . . . . . . . . :   V7R4M0
  Allow null values  . . . . . . . :   *NO
  Define condition names . . . . . :   *NONE
  Enable performance collection  . :   *PEP
  Profiling data . . . . . . . . . :   *NOCOL
  Licensed Internal Code options . :
  Generate program interface . . . :   *NO
  Include directory  . . . . . . . :   includes
  Preprocessor options . . . . . . :   *NORMVCOMMENT *EXPINCLUDE   *NOSEQSRC
  Output source file . . . . . . . :   QSQLPRE
    Library  . . . . . . . . . . . :     QTEMP
  Output source member . . . . . . :   CRUD01RPG
  MINIMUM OUTPUT LINE LENGTH . . . :   100
  Require prototype for export . . :   *NO
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      2
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
                          S o u r c e   L i s t i n g
     1 **free                                                                                                               000001
     2                                                                                                                      000002
     3 //                                                                                                                   000003
     4 // CRUD01RPG - Task Administrator with Subfile                                                                       000004
     5 // This program demonstrates CRUD operations using modern RPGLE practices                                            000005
     6 //                                                                                                                   000006
     7 // MODIFICATION HISTORY:                                                                                             000007
     8 // 2019.06.25 Nick Litten V1.0 Created                                                                               000008
     9 // 2026.02.03 IBM Bob     V2.0 Modernized and improved                                                               000009
    10 //                                                                                                                   000010
    11                                                                                                                      000011
    12 ctl-opt main(mainline)                                                                                               000012
    13         copyright('| CRUD01RPG V2.0 - Improved')                                                                     000013
    14         option(*nodebugio:*srcstmt)                                                                                  000014
    15         dftactgrp(*no)                                                                                               000015
    16         actgrp(*new);                                                                                                000016
    17                                                                                                                      000017
    18 dcl-f CRUD01PNL workstn sfile(SFLTASK:subfileRRN) usropn infds(infds);                                               000018
    19                                                                                                                      000019
    20 /include 'information_data_structures.rpgleinc'                                                                      000020
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
        *--------------------------------------------------------------------------------------------*
        * RPG member name  . . . . . :  informati+                                                   *                     1
        * External name  . . . . . . :  includes/information_data_structures.rpgleinc                *                     1
        * Last change  . . . . . . . :  26-02-06  15:36:52                                           *                     1
        *--------------------------------------------------------------------------------------------*
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    21+**FREE                                                                                                              1000001
    22+                                                                                                                    1000002
    23+Dcl-Ds infds qualified;                                                                                             1000003
    24+   FileOpen ind pos(9); // File Open Indicator?                                                                     1000004
    25+   FileEOF ind pos(10); // File at End of File?                                                                     1000005
    26+   ListingLine char(8) pos(30);                                                                                     1000006
    27+   // --SpecialStatus zoned(5) pos(38);                                                                             1000007
    28+   File char(10) pos(83);                                                                                           1000008
    29+   fileType int(5) pos(147);                                                                                        1000009
    30+   Lib char(10) pos(93);                                                                                            1000010
    31+   RcdLen int(5) pos(125);                                                                                          1000011
    32+   keyLen int(5) pos(127); // Max key len                                                                           1000012
    33+   Mbr char(10) pos(129);                                                                                           1000013
    34+   RcdsReadSinceOpen int(10) pos(156); // number of records retrieved since open                                    1000014
    35+   Ccsid int(5) pos(218);                                                                                           1000015
    36+   RRNlastRead int(10) pos(247); // relative record number of last record processed                                 1000016
    37+   Rcdfmt char(10) pos(261);                                                                                        1000017
    38+   SflRcdNbr int(5) pos(378);                                                                                       1000018
    39+   RRN int(10) pos(397);                                                                                            1000019
    40+   // DSPF BITs                                                                                                     1000020
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      3
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    41+   funcKey char(1) pos(369); // DS@AID for nice "funckey = PageDown" type syntax                                    1000021
    42+   RowColumn int(5) pos(370); // DS@POS - cursor row & column                                                       1000022
    43+   firstRrnOnScreen int(5) pos(378); // DS@TOP SFL RRN Top of scrn                                                  1000023
    44+   totalSflRows int(5) pos(380); // DS@TOT records in subfile                                                       1000024
    45+   // PRTF BITs                                                                                                     1000025
    46+   printPageSize int(5) pos(152); // PR@SIZ page size                                                               1000026
    47+   printOverflow int(5) pos(188); // PR@FLW printer file overflow                                                   1000027
    48+   printCurrentLine int(5) pos(367); // PR@CLN current line number                                                  1000028
    49+   // *PRTF Stuff:                                                                                                  1000029
    50+   PageSize int(5) pos(152); // PR@SIZ page size                                                                    1000030
    51+   Overflow int(5) pos(188); // PR@FLW printer file overflow                                                        1000031
    52+   CurrentLine int(5) pos(367); // PR@CLN current line number                                                       1000032
    53+   CurrentPage int(10) pos(369);                                                                                    1000033
    54+   // Error MSGID -- available after POST                                                                           1000034
    55+   MsgID char(7) pos(46);                                                                                           1000035
    56+   ODPtype char(2) pos(81); // ODP Type                                                                             1000036
    57+   splf char(10) pos(103);                                                                                          1000037
    58+   splfLib char(10) pos(113);                                                                                       1000038
    59+   splfNumber int(5) pos(123);                                                                                      1000039
    60+   // *DSPF Stuff:                                                                                                  1000040
    61+   SflRRN int(5) pos(376);                                                                                          1000041
    62+   SflMinRRN int(5) pos(378);                                                                                       1000042
    63+   SflNumRcds int(5) pos(380);                                                                                      1000043
    64+   ActualCursor char(2) pos(382);                                                                                   1000044
    65+   NumberOfRows int(5) pos(282);                                                                                    1000045
    66+   NumberOfCols int(5) pos(284);                                                                                    1000046
    67+   nbrOfRows int(5) pos(152);                                                                                       1000047
    68+   nbrOfCol int(5) pos(154);                                                                                        1000048
    69+   nbrRcds int(10) pos(156);                                                                                        1000049
    70+   accessType char(2) pos(160);                                                                                     1000050
    71+   DupKey char(1) pos(162);                                                                                         1000051
    72+   srcFile char(1) pos(163);                                                                                        1000052
    73+   VolumeLavelOffset int(5) pos(184);                                                                               1000053
    74+   MaxRcdsInBlock int(5) pos(186);                                                                                  1000054
    75+   BlockIncrement int(5) pos(190);                                                                                  1000055
    76+   deviceClass char(1) pos(271);                                                                                    1000056
    77+   deviceType char(6) pos(272);                                                                                     1000057
    78+   Requester char(1) pos(278);                                                                                      1000058
    79+   AcquireStatus char(1) pos(279);                                                                                  1000059
    80+   InviteStatus char(1) pos(280);                                                                                   1000060
    81+   DataAvailable char(1) pos(281);                                                                                  1000061
    82+   AllowBlink char(1) pos(286);                                                                                     1000062
    83+   OnlineOffline char(1) pos(287);                                                                                  1000063
    84+   DisplayLocation char(1) pos(288);                                                                                1000064
    85+   DisplayType char(1) pos(289);                                                                                    1000065
    86+   KeyboardType char(1) pos(290);                                                                                   1000066
    87+   ControllerInfo char(1) pos(342);                                                                                 1000067
    88+   ColorCapable char(1) pos(343);                                                                                   1000068
    89+   MiscFlags1 char(1) pos(196);                                                                                     1000069
    90+   OepCount int(5) pos(207);                                                                                        1000070
    91+   NumBasedMbrs int(5) pos(211);                                                                                    1000071
    92+   MiscFlags2 char(1) pos(213);                                                                                     1000072
    93+   OpenID char(2) pos(214);                                                                                         1000073
    94+   RcdFmtLen int(5) pos(216);                                                                                       1000074
    95+   MiscFlags3 char(1) pos(220);                                                                                     1000075
    96+   NUM_DEVS int(5) pos(227);                                                                                        1000076
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      4
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    97+   writeCount int(10) pos(243);                                                                                     1000077
    98+   readCount int(10) pos(247);                                                                                      1000078
    99+   writeReadCount int(10) pos(251);                                                                                 1000079
   100+   otherIOCount int(10) pos(255);                                                                                   1000080
   101+   currentOperations char(1) pos(260);                                                                              1000081
   102+   DevClass char(2) pos(271);                                                                                       1000082
   103+   PgmDevName char(10) pos(273);                                                                                    1000083
   104+   IOrcdLen int(10) pos(283);                                                                                       1000084
   105+   PgmDevice char(10) pos(241);                                                                                     1000085
   106+   DeviceDesc char(10) pos(251);                                                                                    1000086
   107+   user char(10) pos(261);                                                                                          1000087
   108+   // Disk :                                                                                                        1000088
   109+   NbrLockedRcds int(5) pos(377);                                                                                   1000089
   110+   FilePosBits char(1) pos(385);                                                                                    1000090
   111+   RcdDeletedBits char(1) pos(384);                                                                                 1000091
   112+   Numkeys int(5) pos(387);                                                                                         1000092
   113+   Keylength int(5) pos(393);                                                                                       1000093
   114+   MemberNumber int(5) pos(395);                                                                                    1000094
   115+end-ds;                                                                                                             1000095
   116+                                                                                                                    1000096
   117+Dcl-Ds infds_DB likeds(infds);                                                                                      1000097
   118+Dcl-Ds infds_DSPF likeds(infds);                                                                                    1000098
   119+Dcl-Ds infds_PRTF likeds(infds);                                                                                    1000099
   120+                                                                                                                    1000100
   121+// Hexadecimal representation of function Keys                                                                      1000101
   122+// If you use an INFDS against your display file you can check functions by                                         1000102
   123+// using : IF infs.funcKey = PFKEY03;                                                                               1000103
   124+Dcl-C ENTER CONST(X'F1');                                                                                           1000104
   125+Dcl-C HELP CONST(X'F3');                                                                                            1000105
   126+Dcl-C PAGEUP CONST(X'F4');                                                                                          1000106
   127+Dcl-C PAGEDOWN CONST(X'F5');                                                                                        1000107
   128+Dcl-C PRINT CONST(X'F6');                                                                                           1000108
   129+Dcl-C RECORDBACKSPAC CONST(X'F8');                                                                                  1000109
   130+Dcl-C PFKEY01 CONST(X'31');                                                                                         1000110
   131+Dcl-C PFKEY02 CONST(X'32');                                                                                         1000111
   132+Dcl-C PFKEY03 CONST(X'33');                                                                                         1000112
   133+Dcl-C PFKEY04 CONST(X'34');                                                                                         1000113
   134+Dcl-C PFKEY05 CONST(X'35');                                                                                         1000114
   135+Dcl-C PFKEY06 CONST(X'36');                                                                                         1000115
   136+Dcl-C PFKEY07 CONST(X'37');                                                                                         1000116
   137+Dcl-C PFKEY08 CONST(X'38');                                                                                         1000117
   138+Dcl-C PFKEY09 CONST(X'39');                                                                                         1000118
   139+Dcl-C PFKEY10 CONST(X'3A');                                                                                         1000119
   140+Dcl-C PFKEY11 CONST(X'3B');                                                                                         1000120
   141+Dcl-C PFKEY12 CONST(X'3C');                                                                                         1000121
   142+Dcl-C PFKEY13 CONST(X'B1');                                                                                         1000122
   143+Dcl-C PFKEY14 CONST(X'B2');                                                                                         1000123
   144+Dcl-C PFKEY15 CONST(X'B3');                                                                                         1000124
   145+Dcl-C PFKEY16 CONST(X'B4');                                                                                         1000125
   146+Dcl-C PFKEY17 CONST(X'B5');                                                                                         1000126
   147+Dcl-C PFKEY18 CONST(X'B6');                                                                                         1000127
   148+Dcl-C PFKEY19 CONST(X'B7');                                                                                         1000128
   149+Dcl-C PFKEY20 CONST(X'B8');                                                                                         1000129
   150+Dcl-C PFKEY21 CONST(X'B9');                                                                                         1000130
   151+Dcl-C PFKEY22 CONST(X'BA');                                                                                         1000131
   152+Dcl-C PFKEY23 CONST(X'BB');                                                                                         1000132
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      5
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   153+Dcl-C PFKEY24 CONST(X'BC');                                                                                         1000133
   154+Dcl-C CLEAR CONST(X'BD');                                                                                           1000134
   155+                                                                                                                    1000135
   156                                                                                                                      000021
   157 // ============================================================================                                      000022
   158 // NAMED CONSTANTS - Replace magic values for better readability                                                     000023
   159 // ============================================================================                                      000024
   160                                                                                                                      000025
   161 // Screen operation modes                                                                                            000026
   162 Dcl-C MODE_INSERT    'I';                                                                                            000027
   163 Dcl-C MODE_MODIFY    'M';                                                                                            000028
   164 Dcl-C MODE_DELETE    'D';                                                                                            000029
   165 Dcl-C MODE_VIEW      'V';                                                                                            000030
   166 Dcl-C MODE_SUBFILE   'S';                                                                                            000031
   167                                                                                                                      000032
   168 // Window types                                                                                                      000033
   169 Dcl-C WDW_CONFIRM    'C';                                                                                            000034
   170 Dcl-C WDW_MESSAGE    'M';                                                                                            000035
   171 Dcl-C WDW_DELETE     'D';                                                                                            000036
   172 Dcl-C WDW_ERROR      'E';                                                                                            000037
   173                                                                                                                      000038
   174 // Subfile options                                                                                                   000039
   175 Dcl-C OPT_MODIFY     '2';                                                                                            000040
   176 Dcl-C OPT_DELETE     '4';                                                                                            000041
   177 Dcl-C OPT_VIEW       '5';                                                                                            000042
   178                                                                                                                      000043
   179 // SQL State constants                                                                                               000044
   180 Dcl-C SUCCESS_ON_SQL '00';                                                                                           000045
   181 Dcl-C WARNING_ON_SQL '01';                                                                                           000046
   182 Dcl-C NODATA_ON_SQL  '02';                                                                                           000047
   183                                                                                                                      000048
   184 // Subfile configuration                                                                                             000049
   185 Dcl-C PERPAGE        10;                                                                                             000050
   186 Dcl-C MAX_RRN        9999;                                                                                           000051
   187                                                                                                                      000052
   188 // ============================================================================                                      000053
   189 // DISPLAY FILE INDICATORS - Using based data structure for clarity                                                  000054
   190 // ============================================================================                                      000055
   191                                                                                                                      000056
   192 Dcl-S ptrDisplayIndicators Pointer Inz(%Addr(*In));                                                                  000057
   193 Dcl-Ds DisplayIndicators Based(ptrDisplayIndicators);                                                                000058
   194   // Subfile control indicators                                                                                      000059
   195   SflDsp          Ind Pos(99);                                                                                       000060
   196   SflDspCtl       Ind Pos(98);                                                                                       000061
   197   SflClr          Ind Pos(97);                                                                                       000062
   198   SflEnd          Ind Pos(96);                                                                                       000063
   199                                                                                                                      000064
   200   // Validation error indicators                                                                                     000065
   201   TaskIdExistsError    Ind Pos(31);                                                                                  000066
   202   StartDateError       Ind Pos(32);                                                                                  000067
   203   EndDateError         Ind Pos(33);                                                                                  000068
   204   DateRangeError       Ind Pos(34);                                                                                  000069
   205   ProtectFields_35     Ind Pos(35);                                                                                  000070
   206   ProtectFields_36     Ind Pos(36);                                                                                  000071
   207                                                                                                                      000072
   208   // Error indicator overlay for bulk operations                                                                     000073
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      6
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   209   IndErrors char(20) Pos(31);                                                                                        000074
   210 end-ds;                                                                                                              000075
   211                                                                                                                      000076
   212 // ============================================================================                                      000077
   213 // SQL ERROR HANDLING - Improved access to SQLSTATE                                                                  000078
   214 // ============================================================================                                      000079
   215                                                                                                                      000080
   216 Dcl-S pSqlstate Pointer Inz(%Addr(SQLState));                                                                        000081
   217 Dcl-Ds Ds_SqlState based(pSqlstate);                                                                                 000082
   218   xSqlstate char(2);                                                                                                 000083
   219 end-ds;                                                                                                              000084
   220                                                                                                                      000085
   221 // ============================================================================                                      000086
   222 // DATA STRUCTURES                                                                                                   000087
   223 // ============================================================================                                      000088
   224                                                                                                                      000089
   225 // Task data for subfile population                                                                                  000090
   226 Dcl-Ds t_taskData qualified template;                                                                                000091
   227   taskId     int(10);                                                                                                000092
   228   name       char(20);                                                                                               000093
   229   startDate  date;                                                                                                   000094
   230   endDate    date;                                                                                                   000095
   231   state      int(3);                                                                                                 000096
   232 end-ds;                                                                                                              000097
   233                                                                                                                      000098
   234                                                                                                                      000099
   235                                                                                                                      000100
   236 // Main task record - externally described                                                                           000101
   237 Dcl-Ds taskRecord extname('CRUD01TBL') qualified end-ds;                                                             000102
   238                                                                                                                      000103
   239 // ============================================================================                                      000104
   240 // GLOBAL VARIABLES                                                                                                  000105
   241 // ============================================================================                                      000106
   242                                                                                                                      000107
   243 // Subfile management                                                                                                000108
   244 Dcl-S subfileRRN      int(5);                                                                                        000109
   245 Dcl-S initialPos      int(10) inz(0);                                                                                000110
   246 Dcl-S finalPos        int(10) inz(10);                                                                               000111
   247 Dcl-S prevInitialPos  int(10);                                                                                       000112
   248 Dcl-S prevFinalPos    int(10);                                                                                       000113
   249                                                                                                                      000114
   250 // Task data for cursor operations                                                                                   000115
   251 Dcl-Ds taskData likeds(t_taskData);                                                                                  000116
   252                                                                                                                      000117
   253 // Query filtering                                                                                                   000118
   254 Dcl-S whereClause     varchar(500) inz('');                                                                          000119
   255                                                                                                                      000120
   256 // Operation control                                                                                                 000121
   257 Dcl-S crudFinalized   ind;                                                                                           000122
   258 Dcl-S currentUser     char(10) inz(*user);                                                                           000123
   259                                                                                                                      000124
   260 // ============================================================================                                      000125
   261 // MAIN PROCEDURE                                                                                                    000126
   262 // ============================================================================                                      000127
   263                                                                                                                      000128
   264 Dcl-Proc mainline;                                                                                                   000129
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      7
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   265   Dcl-S screenMode char(1);                                                                                          000130
   266                                                                                                                      000131
   267   monitor;                                                                                                           000132
   268     open CRUD01PNL;                                                                                                  000133
   269                                                                                                                      000134
   270     screenMode = MODE_SUBFILE;                                                                                       000135
   271     ShowScreen(screenMode);                                                                                          000136
   272                                                                                                                      000137
   273     close CRUD01PNL;                                                                                                 000138
   274     *Inlr = *On;                                                                                                     000139
   275                                                                                                                      000140
   276   on-error;                                                                                                          000141
   277     // Handle any unexpected errors                                                                                  000142
   278     If %open(CRUD01PNL);                                                                                             000143
   279       close CRUD01PNL;                                                                                               000144
   280     EndIf;                                                                                                           000145
   281     *Inlr = *On;                                                                                                     000146
   282   endmon;                                                                                                            000147
   283 end-proc;                                                                                                            000148
   284                                                                                                                      000149
   285 // ============================================================================                                      000150
   286 // SCREEN MANAGEMENT PROCEDURES                                                                                      000151
   287 // ============================================================================                                      000152
   288 // WriteScreen - Set screen titles and footer based on mode                                                          000153
   289 Dcl-Proc WriteScreen;                                                                                                000154
   290   Dcl-Pi *N;                                                                                                         000155
   291     mode char(1) const;                                                                                              000156
   292   end-pi;                                                                                                            000157
   293                                                                                                                      000158
   294   // Set secondary titles                                                                                            000159
   295   TITLE2 = centerText('Task Management System' : %len(TITLE2));                                                      000160
   296   TITLE3 = centerText('Version 2.0' : %len(TITLE3));                                                                 000161
   297                                                                                                                      000162
   298   // Set primary title based on mode                                                                                 000163
   299   Select;                                                                                                            000164
   300     When mode = MODE_INSERT;                                                                                         000165
   301       TITLE1 = centerText('TASKS ADMINISTRATOR - INSERT' : %len(TITLE1));                                            000166
   302       FOOTTEXT = 'F3=Exit  F10=Confirm';                                                                             000167
   303                                                                                                                      000168
   304     When mode = MODE_MODIFY;                                                                                         000169
   305       TITLE1 = centerText('TASKS ADMINISTRATOR - MODIFY' : %len(TITLE1));                                            000170
   306       FOOTTEXT = 'F3=Exit  F10=Confirm';                                                                             000171
   307                                                                                                                      000172
   308     When mode = MODE_DELETE;                                                                                         000173
   309       TITLE1 = centerText('TASKS ADMINISTRATOR - DELETE' : %len(TITLE1));                                            000174
   310       FOOTTEXT = 'F3=Exit  F10=Confirm';                                                                             000175
   311                                                                                                                      000176
   312     When mode = MODE_VIEW;                                                                                           000177
   313       TITLE1 = centerText('TASKS ADMINISTRATOR - VIEW' : %len(TITLE1));                                              000178
   314       FOOTTEXT = 'F3=Exit';                                                                                          000179
   315                                                                                                                      000180
   316     When mode = MODE_SUBFILE;                                                                                        000181
   317       TITLE1 = centerText('TASKS ADMINISTRATOR - MAIN MENU' : %len(TITLE1));                                         000182
   318       FOOTTEXT = 'F3=Exit  F5=Refresh  F6=Create';                                                                   000183
   319   EndSl;                                                                                                             000184
   320                                                                                                                      000185
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      8
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   321   write HEADER;                                                                                                      000186
   322   write FOOTER;                                                                                                      000187
   323 end-proc;                                                                                                            000188
   324                                                                                                                      000189
   325                                                                                                                      000190
   326                                                                                                                      000191
   327                                                                                                                      000192
   328                                                                                                                      000193
   329 // ShowScreen - Route to appropriate screen based on mode                                                            000194
   330 Dcl-Proc ShowScreen;                                                                                                 000195
   331   Dcl-Pi *N;                                                                                                         000196
   332     mode char(1) const;                                                                                              000197
   333   end-pi;                                                                                                            000198
   334                                                                                                                      000199
   335   Select;                                                                                                            000200
   336     When mode = MODE_INSERT;                                                                                         000201
   337       InsertScreen(mode);                                                                                            000202
   338     When mode = MODE_SUBFILE;                                                                                        000203
   339       ShowSubfile(mode);                                                                                             000204
   340     When mode = MODE_MODIFY;                                                                                         000205
   341       ModifyScreen(mode);                                                                                            000206
   342     When mode = MODE_DELETE;                                                                                         000207
   343       DeleteScreen(mode);                                                                                            000208
   344     When mode = MODE_VIEW;                                                                                           000209
   345       ViewScreen(mode);                                                                                              000210
   346   EndSl;                                                                                                             000211
   347 end-proc;                                                                                                            000212
   348                                                                                                                      000213
   349                                                                                                                      000214
   350                                                                                                                      000215
   351                                                                                                                      000216
   352                                                                                                                      000217
   353 // ShowWindow - Display confirmation or message windows                                                              000218
   354 Dcl-Proc ShowWindow;                                                                                                 000219
   355   Dcl-Pi *N;                                                                                                         000220
   356     windowType char(1) const;                                                                                        000221
   357   end-pi;                                                                                                            000222
   358                                                                                                                      000223
   359   Select;                                                                                                            000224
   360     When windowType = WDW_CONFIRM;                                                                                   000225
   361       WDWTEXT1 = 'Are you sure you want to proceed?';                                                                000226
   362       WDWTEXT2 = 'Please type Y/N';                                                                                  000227
   363       write WDWCONFIRM;                                                                                              000228
   364       exfmt WDWCONFIRM;                                                                                              000229
   365                                                                                                                      000230
   366     When windowType = WDW_MESSAGE;                                                                                   000231
   367       WDWMSG1 = 'Record saved successfully';                                                                         000232
   368       exfmt WDWMESSAGE;                                                                                              000233
   369                                                                                                                      000234
   370     When windowType = WDW_DELETE;                                                                                    000235
   371       WDWMSG1 = 'Record deleted successfully';                                                                       000236
   372       exfmt WDWMESSAGE;                                                                                              000237
   373                                                                                                                      000238
   374     When windowType = WDW_ERROR;                                                                                     000239
   375       WDWMSG1 = 'Error executing operation';                                                                         000240
   376       exfmt WDWMESSAGE;                                                                                              000241
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page      9
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   377   EndSl;                                                                                                             000242
   378 end-proc;                                                                                                            000243
   379                                                                                                                      000244
   380 // ============================================================================                                      000245
   381 // UTILITY PROCEDURES                                                                                                000246
   382 // ============================================================================                                      000247
   383 // centerText - Center text within specified length                                                                  000248
   384 Dcl-Proc centerText;                                                                                                 000249
   385   Dcl-Pi *N char(80);                                                                                                000250
   386     text char(80) const;                                                                                             000251
   387     length int(5) const;                                                                                             000252
   388   end-pi;                                                                                                            000253
   389                                                                                                                      000254
   390   Dcl-S blanksNeeded int(5);                                                                                         000255
   391   Dcl-S startPos int(5);                                                                                             000256
   392   Dcl-S centered char(80) inz(*blanks);                                                                              000257
   393   Dcl-S textLen int(5);                                                                                              000258
   394                                                                                                                      000259
   395   textLen = %len(%trim(text));                                                                                       000260
   396                                                                                                                      000261
   397   // Ensure we don't exceed the target length                                                                        000262
   398   If textLen >= length;                                                                                              000263
   399     Return %subst(text : 1 : length);                                                                                000264
   400   EndIf;                                                                                                             000265
   401                                                                                                                      000266
   402   blanksNeeded = length - textLen;                                                                                   000267
   403   startPos = (blanksNeeded / 2) + 1;                                                                                 000268
   404                                                                                                                      000269
   405   If startPos > 0;                                                                                                   000270
   406     %subst(centered : startPos) = %trim(text);                                                                       000271
   407   Else;                                                                                                              000272
   408     centered = text;                                                                                                 000273
   409   EndIf;                                                                                                             000274
   410                                                                                                                      000275
   411   Return centered;                                                                                                   000276
   412 end-proc;                                                                                                            000277
   413                                                                                                                      000278
   414                                                                                                                      000279
   415                                                                                                                      000280
   416                                                                                                                      000281
   417                                                                                                                      000282
   418 // resetErrors - Clear all validation error indicators                                                               000283
   419 Dcl-Proc resetErrors;                                                                                                000284
   420   TaskIdExistsError = *off;                                                                                          000285
   421   StartDateError = *off;                                                                                             000286
   422   EndDateError = *off;                                                                                               000287
   423   DateRangeError = *off;                                                                                             000288
   424 end-proc;                                                                                                            000289
   425                                                                                                                      000290
   426                                                                                                                      000291
   427                                                                                                                      000292
   428                                                                                                                      000293
   429                                                                                                                      000294
   430 // handleSqlError - Centralized SQL error handling                                                                   000295
   431 Dcl-Proc handleSqlError;                                                                                             000296
   432   Dcl-Pi *N ind;                                                                                                     000297
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     10
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   433     operation varchar(50) const;                                                                                     000298
   434   end-pi;                                                                                                            000299
   435                                                                                                                      000300
   436   If xSqlstate <> SUCCESS_ON_SQL;                                                                                    000301
   437     WDWMSG1 = 'SQL Error: ' + %trim(operation);                                                                      000302
   438     WDWMSG2 = 'SQLSTATE: ' + SQLSTATE + ' Code: ' + %char(SQLCODE);                                                  000303
   439     exfmt WDWMESSAGE;                                                                                                000304
   440     Return *on;                                                                                                      000305
   441   EndIf;                                                                                                             000306
   442                                                                                                                      000307
   443   Return *off;                                                                                                       000308
   444 end-proc;                                                                                                            000309
   445                                                                                                                      000310
   446 // ============================================================================                                      000311
   447 // SUBFILE MANAGEMENT PROCEDURES                                                                                     000312
   448 // ============================================================================                                      000313
   449 // ShowSubfile - Main subfile display loop                                                                           000314
   450 Dcl-Proc ShowSubfile;                                                                                                000315
   451   Dcl-Pi *N;                                                                                                         000316
   452     mode char(1) const;                                                                                              000317
   453   end-pi;                                                                                                            000318
   454                                                                                                                      000319
   455   Dcl-S nextMode char(1);                                                                                            000320
   456                                                                                                                      000321
   457   dow not pfkey(03);                                                                                                 000322
   458     WriteScreen(mode);                                                                                               000323
   459     ActivateSubfile();                                                                                               000324
   460     exfmt SFLTASKCTL;                                                                                                000325
   461                                                                                                                      000326
   462     Select;                                                                                                          000327
   463       When pfkey(03);                                                                                                000328
   464         pfkey(03) = *off;                                                                                            000329
   465         initialPos = 0;                                                                                              000330
   466         finalPos = PERPAGE;                                                                                          000331
   467         leave;                                                                                                       000332
   468                                                                                                                      000333
   469       When infds.funcKey = PAGEUP;                                                                                   000334
   470         handlePageUp(mode);                                                                                          000335
   471                                                                                                                      000336
   472       When infds.funcKey = PAGEDOWN;                                                                                 000337
   473         handlePageDown(mode);                                                                                        000338
   474                                                                                                                      000339
   475       When pfkey(05);                                                                                                000340
   476         initialPos = 0;                                                                                              000341
   477         finalPos = PERPAGE;                                                                                          000342
   478         iter;                                                                                                        000343
   479                                                                                                                      000344
   480       When pfkey(06);                                                                                                000345
   481         nextMode = MODE_INSERT;                                                                                      000346
   482         ShowScreen(nextMode);                                                                                        000347
   483         leave;                                                                                                       000348
   484                                                                                                                      000349
   485       Other;                                                                                                         000350
   486         processSubfileOptions(nextMode);                                                                             000351
   487         If nextMode <> *blanks;                                                                                      000352
   488           ShowScreen(nextMode);                                                                                      000353
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     11
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   489           leave;                                                                                                     000354
   490         EndIf;                                                                                                       000355
   491     EndSl;                                                                                                           000356
   492                                                                                                                      000357
   493     If crudFinalized;                                                                                                000358
   494       crudFinalized = *off;                                                                                          000359
   495       leave;                                                                                                         000360
   496     EndIf;                                                                                                           000361
   497   enddo;                                                                                                             000362
   498 end-proc;                                                                                                            000363
   499                                                                                                                      000364
   500                                                                                                                      000365
   501                                                                                                                      000366
   502                                                                                                                      000367
   503                                                                                                                      000368
   504 // handlePageUp - Process page up request                                                                            000369
   505 Dcl-Proc handlePageUp;                                                                                               000370
   506   Dcl-Pi *N;                                                                                                         000371
   507     mode char(1) const;                                                                                              000372
   508   end-pi;                                                                                                            000373
   509                                                                                                                      000374
   510   If initialPos = 0 and finalPos = PERPAGE;                                                                          000375
   511     // Already at first page                                                                                         000376
   512     Return;                                                                                                          000377
   513   EndIf;                                                                                                             000378
   514                                                                                                                      000379
   515   If initialPos > 1;                                                                                                 000380
   516     initialPos -= (PERPAGE + 1);                                                                                     000381
   517     finalPos -= PERPAGE;                                                                                             000382
   518     ShowScreen(mode);                                                                                                000383
   519   EndIf;                                                                                                             000384
   520 end-proc;                                                                                                            000385
   521                                                                                                                      000386
   522                                                                                                                      000387
   523                                                                                                                      000388
   524                                                                                                                      000389
   525                                                                                                                      000390
   526 // handlePageDown - Process page down request                                                                        000391
   527 Dcl-Proc handlePageDown;                                                                                             000392
   528   Dcl-Pi *N;                                                                                                         000393
   529     mode char(1) const;                                                                                              000394
   530   end-pi;                                                                                                            000395
   531                                                                                                                      000396
   532   Dcl-S recordExists ind;                                                                                            000397
   533                                                                                                                      000398
   534   If initialPos > 0 and finalPos > PERPAGE;                                                                          000399
   535     recordExists = checkRecordsExist(initialPos : finalPos);                                                         000400
   536                                                                                                                      000401
   537     If not recordExists;                                                                                             000402
   538       initialPos -= (PERPAGE + 1);                                                                                   000403
   539       finalPos -= PERPAGE;                                                                                           000404
   540     EndIf;                                                                                                           000405
   541                                                                                                                      000406
   542     ShowScreen(mode);                                                                                                000407
   543   Else;                                                                                                              000408
   544     ShowScreen(mode);                                                                                                000409
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     12
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   545   EndIf;                                                                                                             000410
   546 end-proc;                                                                                                            000411
   547                                                                                                                      000412
   548                                                                                                                      000413
   549                                                                                                                      000414
   550                                                                                                                      000415
   551                                                                                                                      000416
   552 // checkRecordsExist - Verify records exist in range                                                                 000417
   553 Dcl-Proc checkRecordsExist;                                                                                          000418
   554   Dcl-Pi *N ind;                                                                                                     000419
   555     startPos int(10) const;                                                                                          000420
   556     endPos int(10) const;                                                                                            000421
   557   end-pi;                                                                                                            000422
   558                                                                                                                      000423
   559   Dcl-S recordCount int(10);                                                                                         000424
   560                                                                                                                      000425
   561   exec sql                                                                                                           000426
   562     SELECT COUNT(*) INTO :recordCount                                                                                000427
   563     FROM CRUD01TBL;                                                                                                  000428
   564                                                                                                                      000429
   565   // Check if the requested range is within available records                                                        000430
   566   Return (recordCount >= startPos);                                                                                  000431
   567 end-proc;                                                                                                            000432
   568                                                                                                                      000433
   569                                                                                                                      000434
   570                                                                                                                      000435
   571                                                                                                                      000436
   572                                                                                                                      000437
   573 // processSubfileOptions - Handle user selections in subfile                                                         000438
   574 Dcl-Proc processSubfileOptions;                                                                                      000439
   575   Dcl-Pi *N;                                                                                                         000440
   576     nextMode char(1);                                                                                                000441
   577   end-pi;                                                                                                            000442
   578                                                                                                                      000443
   579   Dcl-S rrn int(5);                                                                                                  000444
   580                                                                                                                      000445
   581   nextMode = *blanks;                                                                                                000446
   582                                                                                                                      000447
   583   If subfileRRN = 0;                                                                                                 000448
   584     Return;                                                                                                          000449
   585   EndIf;                                                                                                             000450
   586                                                                                                                      000451
   587   For rrn = 1 to PERPAGE;                                                                                            000452
   588     chain rrn SFLTASK;                                                                                               000453
   589                                                                                                                      000454
   590     If not %found();                                                                                                 000455
   591       leave;                                                                                                         000456
   592     EndIf;                                                                                                           000457
   593                                                                                                                      000458
   594     If OPCTASK = *blanks;                                                                                            000459
   595       iter;                                                                                                          000460
   596     EndIf;                                                                                                           000461
   597                                                                                                                      000462
   598     // Load task data                                                                                                000463
   599     If not loadTaskById(SFLTASKID);                                                                                  000464
   600       OPCTASK = *blanks;                                                                                             000465
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     13
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   601       update SFLTASK;                                                                                                000466
   602       iter;                                                                                                          000467
   603     EndIf;                                                                                                           000468
   604                                                                                                                      000469
   605     // Determine next screen based on option                                                                         000470
   606     Select;                                                                                                          000471
   607       When OPCTASK = OPT_MODIFY;                                                                                     000472
   608         nextMode = MODE_MODIFY;                                                                                      000473
   609       When OPCTASK = OPT_DELETE;                                                                                     000474
   610         nextMode = MODE_DELETE;                                                                                      000475
   611       When OPCTASK = OPT_VIEW;                                                                                       000476
   612         nextMode = MODE_VIEW;                                                                                        000477
   613     EndSl;                                                                                                           000478
   614                                                                                                                      000479
   615     OPCTASK = *blanks;                                                                                               000480
   616     update SFLTASK;                                                                                                  000481
   617     leave;                                                                                                           000482
   618   EndFor;                                                                                                            000483
   619 end-proc;                                                                                                            000484
   620                                                                                                                      000485
   621                                                                                                                      000486
   622                                                                                                                      000487
   623                                                                                                                      000488
   624                                                                                                                      000489
   625 // loadTaskById - Load task record by ID                                                                             000490
   626 Dcl-Proc loadTaskById;                                                                                               000491
   627   Dcl-Pi *N ind;                                                                                                     000492
   628     taskId int(10) const;                                                                                            000493
   629   end-pi;                                                                                                            000494
   630                                                                                                                      000495
   631   clear taskRecord;                                                                                                  000496
   632                                                                                                                      000497
   633   exec sql                                                                                                           000498
   634     SELECT * INTO :taskRecord                                                                                        000499
   635     FROM CRUD01TBL                                                                                                   000500
   636     WHERE TASK_ID = :taskId;                                                                                         000501
   637                                                                                                                      000502
   638   Return (xSqlstate = SUCCESS_ON_SQL);                                                                               000503
   639 end-proc;                                                                                                            000504
   640                                                                                                                      000505
   641                                                                                                                      000506
   642                                                                                                                      000507
   643                                                                                                                      000508
   644                                                                                                                      000509
   645 // SflInitial - Initialize subfile for loading                                                                       000510
   646 Dcl-Proc SflInitial;                                                                                                 000511
   647   SflEnd = *off;                                                                                                     000512
   648   SflClr = *on;                                                                                                      000513
   649   write SFLTASKCTL;                                                                                                  000514
   650   SflClr = *off;                                                                                                     000515
   651   subfileRRN = 0;                                                                                                    000516
   652   SflDsp = *off;                                                                                                     000517
   653   SflDspCtl = *off;                                                                                                  000518
   654 end-proc;                                                                                                            000519
   655                                                                                                                      000520
   656                                                                                                                      000521
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     14
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   657                                                                                                                      000522
   658                                                                                                                      000523
   659                                                                                                                      000524
   660 // ActivateSubfile - Prepare and display subfile                                                                     000525
   661 Dcl-Proc ActivateSubfile;                                                                                            000526
   662   Dcl-S totalRecords int(10);                                                                                        000527
   663                                                                                                                      000528
   664   SflInitial();                                                                                                      000529
   665   FillSubfile();                                                                                                     000530
   666                                                                                                                      000531
   667   totalRecords = getTotalRecords();                                                                                  000532
   668   // Set end indicator based on whether we've loaded all records                                                     000533
   669   SflEnd = (initialPos + subfileRRN >= totalRecords);                                                                000534
   670                                                                                                                      000535
   671   If subfileRRN > 0;                                                                                                 000536
   672     SflDsp = *on;                                                                                                    000537
   673   Else;                                                                                                              000538
   674     write EMPTY;                                                                                                     000539
   675   EndIf;                                                                                                             000540
   676                                                                                                                      000541
   677   SflDspCtl = *on;                                                                                                   000542
   678 end-proc;                                                                                                            000543
   679                                                                                                                      000544
   680                                                                                                                      000545
   681                                                                                                                      000546
   682                                                                                                                      000547
   683                                                                                                                      000548
   684 // FillSubfile - Load subfile with data using cursor                                                                 000549
   685 Dcl-Proc FillSubfile;                                                                                                000550
   686   Dcl-S count int(5) inz(0);                                                                                         000551
   687                                                                                                                      000552
   688   prevInitialPos = initialPos;                                                                                       000553
   689   prevFinalPos = finalPos;                                                                                           000554
   690                                                                                                                      000555
   691   clear taskData;                                                                                                    000556
   692                                                                                                                      000557
   693   exec sql                                                                                                           000558
   694     DECLARE TASK_CURSOR CURSOR FOR                                                                                   000559
   695     SELECT TASK_ID, NAME, STARTDATE, ENDDATE, STATE                                                                  000560
   696     FROM CRUD01TBL                                                                                                   000561
   697     ORDER BY TASK_ID                                                                                                 000562
   698     OFFSET :initialPos ROWS                                                                                          000563
   699     FETCH FIRST :PERPAGE ROWS ONLY;                                                                                  000564
   700                                                                                                                      000565
   701   exec sql OPEN TASK_CURSOR;                                                                                         000566
   702                                                                                                                      000567
   703   If xSqlstate <> SUCCESS_ON_SQL;                                                                                    000568
   704     Return;                                                                                                          000569
   705   EndIf;                                                                                                             000570
   706                                                                                                                      000571
   707   exec sql FETCH TASK_CURSOR INTO :taskData.taskId, :taskData.name,                                                  000572
   708                                    :taskData.startDate, :taskData.endDate,                                           000573
   709                                    :taskData.state;                                                                  000574
   710                                                                                                                      000575
   711   dow (xSqlstate = SUCCESS_ON_SQL) and (count < PERPAGE);                                                            000576
   712     count += 1;                                                                                                      000577
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     15
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   713     addToSubfile();                                                                                                  000578
   714     exec sql FETCH TASK_CURSOR INTO :taskData.taskId, :taskData.name,                                                000579
   715                                      :taskData.startDate, :taskData.endDate,                                         000580
   716                                      :taskData.state;                                                                000581
   717   enddo;                                                                                                             000582
   718                                                                                                                      000583
   719   exec sql CLOSE TASK_CURSOR;                                                                                        000584
   720                                                                                                                      000585
   721   // Update position for next page                                                                                   000586
   722   If count = PERPAGE;                                                                                                000587
   723     initialPos += count + 1;                                                                                         000588
   724     finalPos += count;                                                                                               000589
   725   EndIf;                                                                                                             000590
   726 end-proc;                                                                                                            000591
   727                                                                                                                      000592
   728                                                                                                                      000593
   729                                                                                                                      000594
   730                                                                                                                      000595
   731                                                                                                                      000596
   732 // addToSubfile - Add current record to subfile                                                                      000597
   733 Dcl-Proc addToSubfile;                                                                                               000598
   734   subfileRRN += 1;                                                                                                   000599
   735   SFLTASKID = taskData.taskId;                                                                                       000600
   736   SFLTASKNAM = taskData.name;                                                                                        000601
   737   SFLSTRDATE = %dec(taskData.startDate);                                                                             000602
   738   SFLENDDATE = %dec(taskData.endDate);                                                                               000603
   739   SFLSTATE = taskData.state;                                                                                         000604
   740   write SFLTASK;                                                                                                     000605
   741   clear SFLTASK;                                                                                                     000606
   742 end-proc;                                                                                                            000607
   743                                                                                                                      000608
   744                                                                                                                      000609
   745                                                                                                                      000610
   746                                                                                                                      000611
   747                                                                                                                      000612
   748 // getTotalRecords - Get count of all records                                                                        000613
   749 Dcl-Proc getTotalRecords;                                                                                            000614
   750   Dcl-Pi *N int(10);                                                                                                 000615
   751   end-pi;                                                                                                            000616
   752                                                                                                                      000617
   753   Dcl-S total int(10);                                                                                               000618
   754                                                                                                                      000619
   755   exec sql                                                                                                           000620
   756     SELECT COUNT(*) INTO :total                                                                                      000621
   757     FROM CRUD01TBL;                                                                                                  000622
   758                                                                                                                      000623
   759   If xSqlstate <> SUCCESS_ON_SQL;                                                                                    000624
   760     total = 0;                                                                                                       000625
   761   EndIf;                                                                                                             000626
   762                                                                                                                      000627
   763   Return total;                                                                                                      000628
   764 end-proc;                                                                                                            000629
   765                                                                                                                      000630
   766 // ============================================================================                                      000631
   767 // VALIDATION PROCEDURES                                                                                             000632
   768 // ============================================================================                                      000633
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     16
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   769 // validateScreen - Validate input based on mode                                                                     000634
   770 Dcl-Proc validateScreen;                                                                                             000635
   771   Dcl-Pi *N ind;                                                                                                     000636
   772     mode char(1) const;                                                                                              000637
   773   end-pi;                                                                                                            000638
   774                                                                                                                      000639
   775   Dcl-S hasErrors ind inz(*off);                                                                                     000640
   776                                                                                                                      000641
   777   IndErrors = *zeros;                                                                                                000642
   778   resetErrors();                                                                                                     000643
   779                                                                                                                      000644
   780   Select;                                                                                                            000645
   781     When mode = MODE_INSERT;                                                                                         000646
   782       hasErrors = validateInsert();                                                                                  000647
   783     When mode = MODE_MODIFY;                                                                                         000648
   784       hasErrors = validateModify();                                                                                  000649
   785     Other;                                                                                                           000650
   786       // No validation needed for DELETE or VIEW modes                                                               000651
   787       hasErrors = *off;                                                                                              000652
   788   EndSl;                                                                                                             000653
   789                                                                                                                      000654
   790   Return hasErrors;                                                                                                  000655
   791 end-proc;                                                                                                            000656
   792                                                                                                                      000657
   793                                                                                                                      000658
   794                                                                                                                      000659
   795                                                                                                                      000660
   796                                                                                                                      000661
   797 // validateInsert - Validation specific to insert operation                                                          000662
   798 Dcl-Proc validateInsert;                                                                                             000663
   799   Dcl-Pi *N ind;                                                                                                     000664
   800   end-pi;                                                                                                            000665
   801                                                                                                                      000666
   802   Dcl-S exists char(1);                                                                                              000667
   803   Dcl-S hasErrors ind inz(*off);                                                                                     000668
   804                                                                                                                      000669
   805   // Check if task ID already exists                                                                                 000670
   806   clear exists;                                                                                                      000671
   807   exec sql                                                                                                           000672
   808     SELECT '1' INTO :exists                                                                                          000673
   809     FROM CRUD01TBL                                                                                                   000674
   810     WHERE TASK_ID = :CRUDTASKID                                                                                      000675
   811     FETCH FIRST ROW ONLY;                                                                                            000676
   812                                                                                                                      000677
   813   If xSqlstate = SUCCESS_ON_SQL and exists = '1';                                                                    000678
   814     TaskIdExistsError = *on;                                                                                         000679
   815     hasErrors = *on;                                                                                                 000680
   816   EndIf;                                                                                                             000681
   817                                                                                                                      000682
   818   // Validate start date                                                                                             000683
   819   test(de) *iso STARTDATE;                                                                                           000684
   820   If %error;                                                                                                         000685
   821     StartDateError = *on;                                                                                            000686
   822     hasErrors = *on;                                                                                                 000687
   823   EndIf;                                                                                                             000688
   824                                                                                                                      000689
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     17
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   825   // Validate end date                                                                                               000690
   826   test(de) *iso ENDDATE;                                                                                             000691
   827   If %error;                                                                                                         000692
   828     EndDateError = *on;                                                                                              000693
   829     hasErrors = *on;                                                                                                 000694
   830   EndIf;                                                                                                             000695
   831                                                                                                                      000696
   832   // Validate date range                                                                                             000697
   833   If STARTDATE <> 0 and ENDDATE <> 0                                                                                 000698
   834      and not StartDateError and not EndDateError;                                                                    000699
   835     If STARTDATE > ENDDATE;                                                                                          000700
   836       DateRangeError = *on;                                                                                          000701
   837       hasErrors = *on;                                                                                               000702
   838     EndIf;                                                                                                           000703
   839   EndIf;                                                                                                             000704
   840                                                                                                                      000705
   841   Return hasErrors;                                                                                                  000706
   842 end-proc;                                                                                                            000707
   843                                                                                                                      000708
   844                                                                                                                      000709
   845                                                                                                                      000710
   846                                                                                                                      000711
   847                                                                                                                      000712
   848 // validateModify - Validation specific to modify operation                                                          000713
   849 Dcl-Proc validateModify;                                                                                             000714
   850   Dcl-Pi *N ind;                                                                                                     000715
   851   end-pi;                                                                                                            000716
   852                                                                                                                      000717
   853   Dcl-S hasErrors ind inz(*off);                                                                                     000718
   854                                                                                                                      000719
   855   // Validate start date                                                                                             000720
   856   test(de) *iso STARTDATE;                                                                                           000721
   857   If %error;                                                                                                         000722
   858     StartDateError = *on;                                                                                            000723
   859     hasErrors = *on;                                                                                                 000724
   860   EndIf;                                                                                                             000725
   861                                                                                                                      000726
   862   // Validate end date                                                                                               000727
   863   test(de) *iso ENDDATE;                                                                                             000728
   864   If %error;                                                                                                         000729
   865     EndDateError = *on;                                                                                              000730
   866     hasErrors = *on;                                                                                                 000731
   867   EndIf;                                                                                                             000732
   868                                                                                                                      000733
   869   // Validate date range                                                                                             000734
   870   If STARTDATE <> 0 and ENDDATE <> 0                                                                                 000735
   871      and not StartDateError and not EndDateError;                                                                    000736
   872     If STARTDATE > ENDDATE;                                                                                          000737
   873       DateRangeError = *on;                                                                                          000738
   874       hasErrors = *on;                                                                                               000739
   875     EndIf;                                                                                                           000740
   876   EndIf;                                                                                                             000741
   877                                                                                                                      000742
   878   Return hasErrors;                                                                                                  000743
   879 end-proc;                                                                                                            000744
   880                                                                                                                      000745
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     18
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   881 // ============================================================================                                      000746
   882 // CRUD OPERATION PROCEDURES                                                                                         000747
   883 // ============================================================================                                      000748
   884 // InsertScreen - Handle insert operation                                                                            000749
   885 Dcl-Proc InsertScreen;                                                                                               000750
   886   Dcl-Pi *N;                                                                                                         000751
   887     mode char(1) const;                                                                                              000752
   888   end-pi;                                                                                                            000753
   889                                                                                                                      000754
   890   Dcl-S nextMode char(1);                                                                                            000755
   891                                                                                                                      000756
   892   WriteScreen(mode);                                                                                                 000757
   893                                                                                                                      000758
   894   dow not pfkey(03);                                                                                                 000759
   895     ProtectFields_35 = *off;                                                                                         000760
   896     ProtectFields_36 = *off;                                                                                         000761
   897     exfmt CRUDTASK;                                                                                                  000762
   898                                                                                                                      000763
   899     Select;                                                                                                          000764
   900       When pfkey(03);                                                                                                000765
   901         cleanupAndReturn(nextMode);                                                                                  000766
   902         ShowScreen(nextMode);                                                                                        000767
   903         leave;                                                                                                       000768
   904                                                                                                                      000769
   905       When pfkey(10);                                                                                                000770
   906         If not validateScreen(mode);                                                                                 000771
   907           If confirmAction();                                                                                        000772
   908             If performInsert();                                                                                      000773
   909               ShowWindow(WDW_MESSAGE);                                                                               000774
   910               cleanupAndReturn(nextMode);                                                                            000775
   911               ShowScreen(nextMode);                                                                                  000776
   912               leave;                                                                                                 000777
   913             Else;                                                                                                    000778
   914               ShowWindow(WDW_ERROR);                                                                                 000779
   915             EndIf;                                                                                                   000780
   916           Else;                                                                                                      000781
   917             clear CRUDTASK;                                                                                          000782
   918           EndIf;                                                                                                     000783
   919         EndIf;                                                                                                       000784
   920                                                                                                                      000785
   921       Other;                                                                                                         000786
   922         If validateScreen(mode);                                                                                     000787
   923           iter;                                                                                                      000788
   924         EndIf;                                                                                                       000789
   925     EndSl;                                                                                                           000790
   926   enddo;                                                                                                             000791
   927 end-proc;                                                                                                            000792
   928                                                                                                                      000793
   929                                                                                                                      000794
   930                                                                                                                      000795
   931                                                                                                                      000796
   932                                                                                                                      000797
   933 // performInsert - Execute insert with transaction control                                                           000798
   934 Dcl-Proc performInsert;                                                                                              000799
   935   Dcl-Pi *N ind;                                                                                                     000800
   936   end-pi;                                                                                                            000801
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     19
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   937                                                                                                                      000802
   938   loadDataToRecord();                                                                                                000803
   939                                                                                                                      000804
   940   monitor;                                                                                                           000805
   941     exec sql                                                                                                         000806
   942       INSERT INTO CRUD01TBL (                                                                                        000807
   943         TASK_ID, NAME, DESCR, ENDDES,                                                                                000808
   944         STARTDATE, ENDDATE, STATE, OWNER                                                                             000809
   945       ) VALUES (                                                                                                     000810
   946         :taskRecord.Task_id,                                                                                         000811
   947         :taskRecord.Name,                                                                                            000812
   948         :taskRecord.Descr,                                                                                           000813
   949         :taskRecord.Enddes,                                                                                          000814
   950         :taskRecord.Startdate,                                                                                       000815
   951         :taskRecord.Enddate,                                                                                         000816
   952         :taskRecord.State,                                                                                           000817
   953         :taskRecord.Owner                                                                                            000818
   954       );                                                                                                             000819
   955                                                                                                                      000820
   956     If xSqlstate = SUCCESS_ON_SQL;                                                                                   000821
   957       exec sql COMMIT;                                                                                               000822
   958       Return *on;                                                                                                    000823
   959     Else;                                                                                                            000824
   960       exec sql ROLLBACK;                                                                                             000825
   961       Return *off;                                                                                                   000826
   962     EndIf;                                                                                                           000827
   963                                                                                                                      000828
   964   on-error;                                                                                                          000829
   965     exec sql ROLLBACK;                                                                                               000830
   966     Return *off;                                                                                                     000831
   967   endmon;                                                                                                            000832
   968 end-proc;                                                                                                            000833
   969                                                                                                                      000834
   970                                                                                                                      000835
   971                                                                                                                      000836
   972                                                                                                                      000837
   973                                                                                                                      000838
   974 // ModifyScreen - Handle modify operation                                                                            000839
   975 Dcl-Proc ModifyScreen;                                                                                               000840
   976   Dcl-Pi *N;                                                                                                         000841
   977     mode char(1) const;                                                                                              000842
   978   end-pi;                                                                                                            000843
   979                                                                                                                      000844
   980   Dcl-S nextMode char(1);                                                                                            000845
   981                                                                                                                      000846
   982   loadDataToScreen();                                                                                                000847
   983   WriteScreen(mode);                                                                                                 000848
   984                                                                                                                      000849
   985   dow not pfkey(03);                                                                                                 000850
   986     ProtectFields_35 = *on;                                                                                          000851
   987     exfmt CRUDTASK;                                                                                                  000852
   988                                                                                                                      000853
   989     Select;                                                                                                          000854
   990       When pfkey(03);                                                                                                000855
   991         ProtectFields_35 = *off;                                                                                     000856
   992         cleanupAndReturn(nextMode);                                                                                  000857
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     20
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   993         crudFinalized = *on;                                                                                         000858
   994         ShowScreen(nextMode);                                                                                        000859
   995         leave;                                                                                                       000860
   996                                                                                                                      000861
   997       When pfkey(10);                                                                                                000862
   998         If not validateScreen(mode);                                                                                 000863
   999           If confirmAction();                                                                                        000864
  1000             If performUpdate();                                                                                      000865
  1001               ShowWindow(WDW_MESSAGE);                                                                               000866
  1002               cleanupAndReturn(nextMode);                                                                            000867
  1003               crudFinalized = *on;                                                                                   000868
  1004               ShowScreen(nextMode);                                                                                  000869
  1005               leave;                                                                                                 000870
  1006             Else;                                                                                                    000871
  1007               ShowWindow(WDW_ERROR);                                                                                 000872
  1008             EndIf;                                                                                                   000873
  1009           Else;                                                                                                      000874
  1010             clear CRUDTASK;                                                                                          000875
  1011           EndIf;                                                                                                     000876
  1012         EndIf;                                                                                                       000877
  1013                                                                                                                      000878
  1014       Other;                                                                                                         000879
  1015         If validateScreen(mode);                                                                                     000880
  1016           iter;                                                                                                      000881
  1017         EndIf;                                                                                                       000882
  1018     EndSl;                                                                                                           000883
  1019   enddo;                                                                                                             000884
  1020 end-proc;                                                                                                            000885
  1021                                                                                                                      000886
  1022                                                                                                                      000887
  1023                                                                                                                      000888
  1024                                                                                                                      000889
  1025                                                                                                                      000890
  1026 // performUpdate - Execute update operation                                                                          000891
  1027 Dcl-Proc performUpdate;                                                                                              000892
  1028   Dcl-Pi *N ind;                                                                                                     000893
  1029   end-pi;                                                                                                            000894
  1030                                                                                                                      000895
  1031   monitor;                                                                                                           000896
  1032     exec sql                                                                                                         000897
  1033       UPDATE CRUD01TBL                                                                                               000898
  1034       SET NAME = :NAMETASK,                                                                                          000899
  1035           DESCR = :DESCRP,                                                                                           000900
  1036           ENDDES = :SOLUTION,                                                                                        000901
  1037           STARTDATE = :STARTDATE,                                                                                    000902
  1038           ENDDATE = :ENDDATE,                                                                                        000903
  1039           STATE = :STATETASK,                                                                                        000904
  1040           OWNER = :currentUser                                                                                       000905
  1041       WHERE TASK_ID = :CRUDTASKID;                                                                                   000906
  1042                                                                                                                      000907
  1043     If xSqlstate = SUCCESS_ON_SQL;                                                                                   000908
  1044       exec sql COMMIT;                                                                                               000909
  1045       Return *on;                                                                                                    000910
  1046     Else;                                                                                                            000911
  1047       exec sql ROLLBACK;                                                                                             000912
  1048       Return *off;                                                                                                   000913
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     21
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1049     EndIf;                                                                                                           000914
  1050                                                                                                                      000915
  1051   on-error;                                                                                                          000916
  1052     exec sql ROLLBACK;                                                                                               000917
  1053     Return *off;                                                                                                     000918
  1054   endmon;                                                                                                            000919
  1055 end-proc;                                                                                                            000920
  1056                                                                                                                      000921
  1057                                                                                                                      000922
  1058                                                                                                                      000923
  1059                                                                                                                      000924
  1060                                                                                                                      000925
  1061 // DeleteScreen - Handle delete operation                                                                            000926
  1062 Dcl-Proc DeleteScreen;                                                                                               000927
  1063   Dcl-Pi *N;                                                                                                         000928
  1064     mode char(1) const;                                                                                              000929
  1065   end-pi;                                                                                                            000930
  1066                                                                                                                      000931
  1067   Dcl-S nextMode char(1);                                                                                            000932
  1068                                                                                                                      000933
  1069   loadDataToScreen();                                                                                                000934
  1070   WriteScreen(mode);                                                                                                 000935
  1071                                                                                                                      000936
  1072   dow not pfkey(03);                                                                                                 000937
  1073     ProtectFields_35 = *on;                                                                                          000938
  1074     ProtectFields_36 = *on;                                                                                          000939
  1075     exfmt CRUDTASK;                                                                                                  000940
  1076                                                                                                                      000941
  1077     Select;                                                                                                          000942
  1078       When pfkey(03);                                                                                                000943
  1079         ProtectFields_35 = *off;                                                                                     000944
  1080         ProtectFields_36 = *off;                                                                                     000945
  1081         cleanupAndReturn(nextMode);                                                                                  000946
  1082         crudFinalized = *on;                                                                                         000947
  1083         ShowScreen(nextMode);                                                                                        000948
  1084         leave;                                                                                                       000949
  1085                                                                                                                      000950
  1086       When pfkey(10);                                                                                                000951
  1087         If confirmAction();                                                                                          000952
  1088           If performDelete();                                                                                        000953
  1089             ShowWindow(WDW_DELETE);                                                                                  000954
  1090             cleanupAndReturn(nextMode);                                                                              000955
  1091             crudFinalized = *on;                                                                                     000956
  1092             ShowScreen(nextMode);                                                                                    000957
  1093             leave;                                                                                                   000958
  1094           Else;                                                                                                      000959
  1095             ShowWindow(WDW_ERROR);                                                                                   000960
  1096           EndIf;                                                                                                     000961
  1097         Else;                                                                                                        000962
  1098           clear CRUDTASK;                                                                                            000963
  1099         EndIf;                                                                                                       000964
  1100                                                                                                                      000965
  1101       Other;                                                                                                         000966
  1102         iter;                                                                                                        000967
  1103     EndSl;                                                                                                           000968
  1104   enddo;                                                                                                             000969
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     22
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1105 end-proc;                                                                                                            000970
  1106                                                                                                                      000971
  1107                                                                                                                      000972
  1108                                                                                                                      000973
  1109                                                                                                                      000974
  1110                                                                                                                      000975
  1111 // performDelete - Execute delete operation                                                                          000976
  1112 Dcl-Proc performDelete;                                                                                              000977
  1113   Dcl-Pi *N ind;                                                                                                     000978
  1114   end-pi;                                                                                                            000979
  1115                                                                                                                      000980
  1116   monitor;                                                                                                           000981
  1117     exec sql                                                                                                         000982
  1118       DELETE FROM CRUD01TBL                                                                                          000983
  1119       WHERE TASK_ID = :CRUDTASKID;                                                                                   000984
  1120                                                                                                                      000985
  1121     If xSqlstate = SUCCESS_ON_SQL;                                                                                   000986
  1122       exec sql COMMIT;                                                                                               000987
  1123       Return *on;                                                                                                    000988
  1124     Else;                                                                                                            000989
  1125       exec sql ROLLBACK;                                                                                             000990
  1126       Return *off;                                                                                                   000991
  1127     EndIf;                                                                                                           000992
  1128                                                                                                                      000993
  1129   on-error;                                                                                                          000994
  1130     exec sql ROLLBACK;                                                                                               000995
  1131     Return *off;                                                                                                     000996
  1132   endmon;                                                                                                            000997
  1133 end-proc;                                                                                                            000998
  1134                                                                                                                      000999
  1135                                                                                                                      001000
  1136                                                                                                                      001001
  1137                                                                                                                      001002
  1138                                                                                                                      001003
  1139 // ViewScreen - Display record in read-only mode                                                                     001004
  1140 Dcl-Proc ViewScreen;                                                                                                 001005
  1141   Dcl-Pi *N;                                                                                                         001006
  1142     mode char(1) const;                                                                                              001007
  1143   end-pi;                                                                                                            001008
  1144                                                                                                                      001009
  1145   Dcl-S nextMode char(1);                                                                                            001010
  1146                                                                                                                      001011
  1147   loadDataToScreen();                                                                                                001012
  1148   WriteScreen(mode);                                                                                                 001013
  1149                                                                                                                      001014
  1150   dow not pfkey(03);                                                                                                 001015
  1151     ProtectFields_35 = *on;                                                                                          001016
  1152     ProtectFields_36 = *on;                                                                                          001017
  1153     exfmt CRUDTASK;                                                                                                  001018
  1154                                                                                                                      001019
  1155     If pfkey(03);                                                                                                    001020
  1156       ProtectFields_35 = *off;                                                                                       001021
  1157       ProtectFields_36 = *off;                                                                                       001022
  1158       cleanupAndReturn(nextMode);                                                                                    001023
  1159       crudFinalized = *on;                                                                                           001024
  1160       ShowScreen(nextMode);                                                                                          001025
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     23
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1161       leave;                                                                                                         001026
  1162     EndIf;                                                                                                           001027
  1163   enddo;                                                                                                             001028
  1164 end-proc;                                                                                                            001029
  1165                                                                                                                      001030
  1166 // ============================================================================                                      001031
  1167 // DATA TRANSFER PROCEDURES                                                                                          001032
  1168 // ============================================================================                                      001033
  1169 // loadDataToScreen - Transfer data from record to screen                                                            001034
  1170 Dcl-Proc loadDataToScreen;                                                                                           001035
  1171   clear CRUDTASK;                                                                                                    001036
  1172   CRUDTASKID = taskRecord.Task_id;                                                                                   001037
  1173   NAMETASK = taskRecord.Name;                                                                                        001038
  1174   DESCRP = taskRecord.Descr;                                                                                         001039
  1175   SOLUTION = taskRecord.Enddes;                                                                                      001040
  1176   STARTDATE = taskRecord.Startdate;                                                                                  001041
  1177   ENDDATE = taskRecord.Enddate;                                                                                      001042
  1178   STATETASK = taskRecord.State;                                                                                      001043
  1179 end-proc;                                                                                                            001044
  1180                                                                                                                      001045
  1181                                                                                                                      001046
  1182                                                                                                                      001047
  1183                                                                                                                      001048
  1184                                                                                                                      001049
  1185 // loadDataToRecord - Transfer data from screen to record                                                            001050
  1186 Dcl-Proc loadDataToRecord;                                                                                           001051
  1187   clear taskRecord;                                                                                                  001052
  1188   taskRecord.Task_id = CRUDTASKID;                                                                                   001053
  1189   taskRecord.Name = %trim(NAMETASK);                                                                                 001054
  1190   taskRecord.Descr = %trim(DESCRP);                                                                                  001055
  1191   taskRecord.Enddes = %trim(SOLUTION);                                                                               001056
  1192   taskRecord.Startdate = STARTDATE;                                                                                  001057
  1193   taskRecord.Enddate = ENDDATE;                                                                                      001058
  1194   taskRecord.State = STATETASK;                                                                                      001059
  1195   taskRecord.Owner = currentUser;                                                                                    001060
  1196 end-proc;                                                                                                            001061
  1197                                                                                                                      001062
  1198                                                                                                                      001063
  1199                                                                                                                      001064
  1200                                                                                                                      001065
  1201                                                                                                                      001066
  1202 // confirmAction - Get user confirmation                                                                             001067
  1203 Dcl-Proc confirmAction;                                                                                              001068
  1204   Dcl-Pi *N ind;                                                                                                     001069
  1205   end-pi;                                                                                                            001070
  1206                                                                                                                      001071
  1207   ShowWindow(WDW_CONFIRM);                                                                                           001072
  1208   Return (WDWCHOICE = 'Y');                                                                                          001073
  1209 end-proc;                                                                                                            001074
  1210                                                                                                                      001075
  1211                                                                                                                      001076
  1212                                                                                                                      001077
  1213                                                                                                                      001078
  1214                                                                                                                      001079
  1215 // cleanupAndReturn - Clean up and prepare to return to subfile                                                      001080
  1216 Dcl-Proc cleanupAndReturn;                                                                                           001081
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     24
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1217   Dcl-Pi *N;                                                                                                         001082
  1218     nextMode char(1);                                                                                                001083
  1219   end-pi;                                                                                                            001084
  1220                                                                                                                      001085
  1221   clear CRUDTASK;                                                                                                    001086
  1222   clear OPCTASK;                                                                                                     001087
  1223   pfkey(03) = *off;                                                                                                  001088
  1224   initialPos = 0;                                                                                                    001089
  1225   finalPos = PERPAGE;                                                                                                001090
  1226   nextMode = MODE_SUBFILE;                                                                                           001091
  1227 end-proc;                                                                                                            001092
       * * * * *   E N D   O F   S O U R C E   * * * * *
                            / C o p y   M e m b e r s
Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
Number Id              Library    File       Member            Date     Time
    20    1 informati+ includes/information_data_struc+  1208  26-02-06 15:36:52
         * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     25
Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
                       C o m p i l e   T i m e   D a t a
    * * * * *   E N D   O F   C O M P I L E   T I M E   D A T A   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     26
                          M e s s a g e   S u m m a r y
 Msg id  Sv Number Message text
       * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
 5770WDS V7R5M0  220415 RN        IBM ILE RPG             NICKLITTEN/CRUD01RPG     PROJEX     26-02-09 16:36:34        Page     27
                            F i n a l   S u m m a r y
  Message Totals:
    Information  (00) . . . . . . . :        0
    Warning      (10) . . . . . . . :        0
    Error        (20) . . . . . . . :        0
    Severe Error (30+)  . . . . . . :        0
    ---------------------------------  -------
    Total . . . . . . . . . . . . . :        0
  Source Totals:
    Records . . . . . . . . . . . . :     1227
    Specifications  . . . . . . . . :      759
    Data records  . . . . . . . . . :        0
    Comments  . . . . . . . . . . . :      401
         * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
Diagnostic check of source is complete. Highest severity is 00.
          * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     1
Source type...............RPG
Object name...............NICKLITTEN/CRUD01RPG
Source file...............QTEMP/QSQLPRE
Member....................*OBJ
To source file............QTEMP/QSQLTEMP1
Options...................*LSTDBG
RPG preprocessor options..*LVL2
Listing option............*PRINT
Target release............V7R4M0
INCLUDE file..............*LIBL/QRPGLESRC
Commit....................*NONE
Allow copy of data........*OPTIMIZE
Close SQL cursor..........*ENDACTGRP
Allow blocking............*ALLREAD
Delay PREPARE.............*NO
Concurrent access
  resolution..............*DFT
Generation level..........10
Printer file..............*LIBL/QSYSPRT
Date format...............*JOB
Date separator............*JOB
Time format...............*HMS
Time separator ...........*JOB
Replace...................*YES
Relational database.......*LOCAL
User .....................*CURRENT
RDB connect method........*DUW
Default collection........*NONE
Dynamic default
  collection..............*NO
Package name..............*OBJLIB/*OBJ
Path......................*NAMING
SQL rules.................*DB2
Created object type.......*PGM
Debugging view............*SOURCE
Debugging encryption key..*NONE
User profile .............*NAMING
Dynamic user profile......*USER
Sort sequence.............*JOB
Language ID...............*JOB
IBM SQL flagging..........*NOFLAG
ANS flagging..............*NONE
Text......................Change Read Update Delete Example
Source file CCSID.........37
Job CCSID.................37
Decimal result options:
  Maximum precision.......31
  Maximum scale...........31
  Minimum divide scale....0
DECFLOAT rounding mode....*HALFEVEN
Compiler options..........TGTCCSID(*JOB) OPTIMIZE(*FULL) INCDIR('includes')
Source member changed on 26-02-09  16:36:34
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     2
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
    1   **free                                                                                                 000001   26-02-09
    2                                                                                                          000002   26-02-09
    3   //                                                                                                     000003   26-02-09
    4   // CRUD01RPG - Task Administrator with Subfile                                                         000004   26-02-09
    5   // This program demonstrates CRUD operations using modern RPGLE practices                              000005   26-02-09
    6   //                                                                                                     000006   26-02-09
    7   // MODIFICATION HISTORY:                                                                               000007   26-02-09
    8   // 2019.06.25 Nick Litten V1.0 Created                                                                 000008   26-02-09
    9   // 2026.02.03 IBM Bob     V2.0 Modernized and improved                                                 000009   26-02-09
   10   //                                                                                                     000010   26-02-09
   11                                                                                                          000011   26-02-09
   12   ctl-opt main(mainline)                                                                                 000012   26-02-09
   13           copyright('| CRUD01RPG V2.0 - Improved')                                                       000013   26-02-09
   14           option(*nodebugio:*srcstmt)                                                                    000014   26-02-09
   15           dftactgrp(*no)                                                                                 000015   26-02-09
   16           actgrp(*new);                                                                                  000016   26-02-09
   17                                                                                                          000017   26-02-09
   18   dcl-f CRUD01PNL workstn sfile(SFLTASK:subfileRRN) usropn infds(infds);                                 000018   26-02-09
   19                                                                                                          000019   26-02-09
   20   // /include 'information_data_structures.rpgleinc'                                                     000020   26-02-09
   21   **END-FREE                                                                                             000000
   22   **FREE                                                                                                 000001   26-02-06
   23                                                                                                          000002   26-02-06
   24   Dcl-Ds infds qualified;                                                                                000003   26-02-06
   25      FileOpen ind pos(9); // File Open Indicator?                                                        000004   26-02-06
   26      FileEOF ind pos(10); // File at End of File?                                                        000005   26-02-06
   27      ListingLine char(8) pos(30);                                                                        000006   26-02-06
   28      // --SpecialStatus zoned(5) pos(38);                                                                000007   26-02-06
   29      File char(10) pos(83);                                                                              000008   26-02-06
   30      fileType int(5) pos(147);                                                                           000009   26-02-06
   31      Lib char(10) pos(93);                                                                               000010   26-02-06
   32      RcdLen int(5) pos(125);                                                                             000011   26-02-06
   33      keyLen int(5) pos(127); // Max key len                                                              000012   26-02-06
   34      Mbr char(10) pos(129);                                                                              000013   26-02-06
   35      RcdsReadSinceOpen int(10) pos(156); // number of records retrieved since open                       000014   26-02-06
   36      Ccsid int(5) pos(218);                                                                              000015   26-02-06
   37      RRNlastRead int(10) pos(247); // relative record number of last record processed                    000016   26-02-06
   38      Rcdfmt char(10) pos(261);                                                                           000017   26-02-06
   39      SflRcdNbr int(5) pos(378);                                                                          000018   26-02-06
   40      RRN int(10) pos(397);                                                                               000019   26-02-06
   41      // DSPF BITs                                                                                        000020   26-02-06
   42      funcKey char(1) pos(369); // DS@AID for nice "funckey = PageDown" type syntax                       000021   26-02-06
   43      RowColumn int(5) pos(370); // DS@POS - cursor row & column                                          000022   26-02-06
   44      firstRrnOnScreen int(5) pos(378); // DS@TOP SFL RRN Top of scrn                                     000023   26-02-06
   45      totalSflRows int(5) pos(380); // DS@TOT records in subfile                                          000024   26-02-06
   46      // PRTF BITs                                                                                        000025   26-02-06
   47      printPageSize int(5) pos(152); // PR@SIZ page size                                                  000026   26-02-06
   48      printOverflow int(5) pos(188); // PR@FLW printer file overflow                                      000027   26-02-06
   49      printCurrentLine int(5) pos(367); // PR@CLN current line number                                     000028   26-02-06
   50      // *PRTF Stuff:                                                                                     000029   26-02-06
   51      PageSize int(5) pos(152); // PR@SIZ page size                                                       000030   26-02-06
   52      Overflow int(5) pos(188); // PR@FLW printer file overflow                                           000031   26-02-06
   53      CurrentLine int(5) pos(367); // PR@CLN current line number                                          000032   26-02-06
   54      CurrentPage int(10) pos(369);                                                                       000033   26-02-06
   55      // Error MSGID -- available after POST                                                              000034   26-02-06
   56      MsgID char(7) pos(46);                                                                              000035   26-02-06
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     3
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
   57      ODPtype char(2) pos(81); // ODP Type                                                                000036   26-02-06
   58      splf char(10) pos(103);                                                                             000037   26-02-06
   59      splfLib char(10) pos(113);                                                                          000038   26-02-06
   60      splfNumber int(5) pos(123);                                                                         000039   26-02-06
   61      // *DSPF Stuff:                                                                                     000040   26-02-06
   62      SflRRN int(5) pos(376);                                                                             000041   26-02-06
   63      SflMinRRN int(5) pos(378);                                                                          000042   26-02-06
   64      SflNumRcds int(5) pos(380);                                                                         000043   26-02-06
   65      ActualCursor char(2) pos(382);                                                                      000044   26-02-06
   66      NumberOfRows int(5) pos(282);                                                                       000045   26-02-06
   67      NumberOfCols int(5) pos(284);                                                                       000046   26-02-06
   68      nbrOfRows int(5) pos(152);                                                                          000047   26-02-06
   69      nbrOfCol int(5) pos(154);                                                                           000048   26-02-06
   70      nbrRcds int(10) pos(156);                                                                           000049   26-02-06
   71      accessType char(2) pos(160);                                                                        000050   26-02-06
   72      DupKey char(1) pos(162);                                                                            000051   26-02-06
   73      srcFile char(1) pos(163);                                                                           000052   26-02-06
   74      VolumeLavelOffset int(5) pos(184);                                                                  000053   26-02-06
   75      MaxRcdsInBlock int(5) pos(186);                                                                     000054   26-02-06
   76      BlockIncrement int(5) pos(190);                                                                     000055   26-02-06
   77      deviceClass char(1) pos(271);                                                                       000056   26-02-06
   78      deviceType char(6) pos(272);                                                                        000057   26-02-06
   79      Requester char(1) pos(278);                                                                         000058   26-02-06
   80      AcquireStatus char(1) pos(279);                                                                     000059   26-02-06
   81      InviteStatus char(1) pos(280);                                                                      000060   26-02-06
   82      DataAvailable char(1) pos(281);                                                                     000061   26-02-06
   83      AllowBlink char(1) pos(286);                                                                        000062   26-02-06
   84      OnlineOffline char(1) pos(287);                                                                     000063   26-02-06
   85      DisplayLocation char(1) pos(288);                                                                   000064   26-02-06
   86      DisplayType char(1) pos(289);                                                                       000065   26-02-06
   87      KeyboardType char(1) pos(290);                                                                      000066   26-02-06
   88      ControllerInfo char(1) pos(342);                                                                    000067   26-02-06
   89      ColorCapable char(1) pos(343);                                                                      000068   26-02-06
   90      MiscFlags1 char(1) pos(196);                                                                        000069   26-02-06
   91      OepCount int(5) pos(207);                                                                           000070   26-02-06
   92      NumBasedMbrs int(5) pos(211);                                                                       000071   26-02-06
   93      MiscFlags2 char(1) pos(213);                                                                        000072   26-02-06
   94      OpenID char(2) pos(214);                                                                            000073   26-02-06
   95      RcdFmtLen int(5) pos(216);                                                                          000074   26-02-06
   96      MiscFlags3 char(1) pos(220);                                                                        000075   26-02-06
   97      NUM_DEVS int(5) pos(227);                                                                           000076   26-02-06
   98      writeCount int(10) pos(243);                                                                        000077   26-02-06
   99      readCount int(10) pos(247);                                                                         000078   26-02-06
  100      writeReadCount int(10) pos(251);                                                                    000079   26-02-06
  101      otherIOCount int(10) pos(255);                                                                      000080   26-02-06
  102      currentOperations char(1) pos(260);                                                                 000081   26-02-06
  103      DevClass char(2) pos(271);                                                                          000082   26-02-06
  104      PgmDevName char(10) pos(273);                                                                       000083   26-02-06
  105      IOrcdLen int(10) pos(283);                                                                          000084   26-02-06
  106      PgmDevice char(10) pos(241);                                                                        000085   26-02-06
  107      DeviceDesc char(10) pos(251);                                                                       000086   26-02-06
  108      user char(10) pos(261);                                                                             000087   26-02-06
  109      // Disk :                                                                                           000088   26-02-06
  110      NbrLockedRcds int(5) pos(377);                                                                      000089   26-02-06
  111      FilePosBits char(1) pos(385);                                                                       000090   26-02-06
  112      RcdDeletedBits char(1) pos(384);                                                                    000091   26-02-06
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     4
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  113      Numkeys int(5) pos(387);                                                                            000092   26-02-06
  114      Keylength int(5) pos(393);                                                                          000093   26-02-06
  115      MemberNumber int(5) pos(395);                                                                       000094   26-02-06
  116   end-ds;                                                                                                000095   26-02-06
  117                                                                                                          000096   26-02-06
  118   Dcl-Ds infds_DB likeds(infds);                                                                         000097   26-02-06
  119   Dcl-Ds infds_DSPF likeds(infds);                                                                       000098   26-02-06
  120   Dcl-Ds infds_PRTF likeds(infds);                                                                       000099   26-02-06
  121                                                                                                          000100   26-02-06
  122   // Hexadecimal representation of function Keys                                                         000101   26-02-06
  123   // If you use an INFDS against your display file you can check functions by                            000102   26-02-06
  124   // using : IF infs.funcKey = PFKEY03;                                                                  000103   26-02-06
  125   Dcl-C ENTER CONST(X'F1');                                                                              000104   26-02-06
  126   Dcl-C HELP CONST(X'F3');                                                                               000105   26-02-06
  127   Dcl-C PAGEUP CONST(X'F4');                                                                             000106   26-02-06
  128   Dcl-C PAGEDOWN CONST(X'F5');                                                                           000107   26-02-06
  129   Dcl-C PRINT CONST(X'F6');                                                                              000108   26-02-06
  130   Dcl-C RECORDBACKSPAC CONST(X'F8');                                                                     000109   26-02-06
  131   Dcl-C PFKEY01 CONST(X'31');                                                                            000110   26-02-06
  132   Dcl-C PFKEY02 CONST(X'32');                                                                            000111   26-02-06
  133   Dcl-C PFKEY03 CONST(X'33');                                                                            000112   26-02-06
  134   Dcl-C PFKEY04 CONST(X'34');                                                                            000113   26-02-06
  135   Dcl-C PFKEY05 CONST(X'35');                                                                            000114   26-02-06
  136   Dcl-C PFKEY06 CONST(X'36');                                                                            000115   26-02-06
  137   Dcl-C PFKEY07 CONST(X'37');                                                                            000116   26-02-06
  138   Dcl-C PFKEY08 CONST(X'38');                                                                            000117   26-02-06
  139   Dcl-C PFKEY09 CONST(X'39');                                                                            000118   26-02-06
  140   Dcl-C PFKEY10 CONST(X'3A');                                                                            000119   26-02-06
  141   Dcl-C PFKEY11 CONST(X'3B');                                                                            000120   26-02-06
  142   Dcl-C PFKEY12 CONST(X'3C');                                                                            000121   26-02-06
  143   Dcl-C PFKEY13 CONST(X'B1');                                                                            000122   26-02-06
  144   Dcl-C PFKEY14 CONST(X'B2');                                                                            000123   26-02-06
  145   Dcl-C PFKEY15 CONST(X'B3');                                                                            000124   26-02-06
  146   Dcl-C PFKEY16 CONST(X'B4');                                                                            000125   26-02-06
  147   Dcl-C PFKEY17 CONST(X'B5');                                                                            000126   26-02-06
  148   Dcl-C PFKEY18 CONST(X'B6');                                                                            000127   26-02-06
  149   Dcl-C PFKEY19 CONST(X'B7');                                                                            000128   26-02-06
  150   Dcl-C PFKEY20 CONST(X'B8');                                                                            000129   26-02-06
  151   Dcl-C PFKEY21 CONST(X'B9');                                                                            000130   26-02-06
  152   Dcl-C PFKEY22 CONST(X'BA');                                                                            000131   26-02-06
  153   Dcl-C PFKEY23 CONST(X'BB');                                                                            000132   26-02-06
  154   Dcl-C PFKEY24 CONST(X'BC');                                                                            000133   26-02-06
  155   Dcl-C CLEAR CONST(X'BD');                                                                              000134   26-02-06
  156                                                                                                          000135   26-02-06
  157                                                                                                          000021   26-02-09
  158   // ============================================================================                        000022   26-02-09
  159   // NAMED CONSTANTS - Replace magic values for better readability                                       000023   26-02-09
  160   // ============================================================================                        000024   26-02-09
  161                                                                                                          000025   26-02-09
  162   // Screen operation modes                                                                              000026   26-02-09
  163   Dcl-C MODE_INSERT    'I';                                                                              000027   26-02-09
  164   Dcl-C MODE_MODIFY    'M';                                                                              000028   26-02-09
  165   Dcl-C MODE_DELETE    'D';                                                                              000029   26-02-09
  166   Dcl-C MODE_VIEW      'V';                                                                              000030   26-02-09
  167   Dcl-C MODE_SUBFILE   'S';                                                                              000031   26-02-09
  168                                                                                                          000032   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     5
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  169   // Window types                                                                                        000033   26-02-09
  170   Dcl-C WDW_CONFIRM    'C';                                                                              000034   26-02-09
  171   Dcl-C WDW_MESSAGE    'M';                                                                              000035   26-02-09
  172   Dcl-C WDW_DELETE     'D';                                                                              000036   26-02-09
  173   Dcl-C WDW_ERROR      'E';                                                                              000037   26-02-09
  174                                                                                                          000038   26-02-09
  175   // Subfile options                                                                                     000039   26-02-09
  176   Dcl-C OPT_MODIFY     '2';                                                                              000040   26-02-09
  177   Dcl-C OPT_DELETE     '4';                                                                              000041   26-02-09
  178   Dcl-C OPT_VIEW       '5';                                                                              000042   26-02-09
  179                                                                                                          000043   26-02-09
  180   // SQL State constants                                                                                 000044   26-02-09
  181   Dcl-C SUCCESS_ON_SQL '00';                                                                             000045   26-02-09
  182   Dcl-C WARNING_ON_SQL '01';                                                                             000046   26-02-09
  183   Dcl-C NODATA_ON_SQL  '02';                                                                             000047   26-02-09
  184                                                                                                          000048   26-02-09
  185   // Subfile configuration                                                                               000049   26-02-09
  186   Dcl-C PERPAGE        10;                                                                               000050   26-02-09
  187   Dcl-C MAX_RRN        9999;                                                                             000051   26-02-09
  188                                                                                                          000052   26-02-09
  189   // ============================================================================                        000053   26-02-09
  190   // DISPLAY FILE INDICATORS - Using based data structure for clarity                                    000054   26-02-09
  191   // ============================================================================                        000055   26-02-09
  192                                                                                                          000056   26-02-09
  193   Dcl-S ptrDisplayIndicators Pointer Inz(%Addr(*In));                                                    000057   26-02-09
  194   Dcl-Ds DisplayIndicators Based(ptrDisplayIndicators);                                                  000058   26-02-09
  195     // Subfile control indicators                                                                        000059   26-02-09
  196     SflDsp          Ind Pos(99);                                                                         000060   26-02-09
  197     SflDspCtl       Ind Pos(98);                                                                         000061   26-02-09
  198     SflClr          Ind Pos(97);                                                                         000062   26-02-09
  199     SflEnd          Ind Pos(96);                                                                         000063   26-02-09
  200                                                                                                          000064   26-02-09
  201     // Validation error indicators                                                                       000065   26-02-09
  202     TaskIdExistsError    Ind Pos(31);                                                                    000066   26-02-09
  203     StartDateError       Ind Pos(32);                                                                    000067   26-02-09
  204     EndDateError         Ind Pos(33);                                                                    000068   26-02-09
  205     DateRangeError       Ind Pos(34);                                                                    000069   26-02-09
  206     ProtectFields_35     Ind Pos(35);                                                                    000070   26-02-09
  207     ProtectFields_36     Ind Pos(36);                                                                    000071   26-02-09
  208                                                                                                          000072   26-02-09
  209     // Error indicator overlay for bulk operations                                                       000073   26-02-09
  210     IndErrors char(20) Pos(31);                                                                          000074   26-02-09
  211   end-ds;                                                                                                000075   26-02-09
  212                                                                                                          000076   26-02-09
  213   // ============================================================================                        000077   26-02-09
  214   // SQL ERROR HANDLING - Improved access to SQLSTATE                                                    000078   26-02-09
  215   // ============================================================================                        000079   26-02-09
  216                                                                                                          000080   26-02-09
  217   Dcl-S pSqlstate Pointer Inz(%Addr(SQLState));                                                          000081   26-02-09
  218   Dcl-Ds Ds_SqlState based(pSqlstate);                                                                   000082   26-02-09
  219     xSqlstate char(2);                                                                                   000083   26-02-09
  220   end-ds;                                                                                                000084   26-02-09
  221                                                                                                          000085   26-02-09
  222   // ============================================================================                        000086   26-02-09
  223   // DATA STRUCTURES                                                                                     000087   26-02-09
  224   // ============================================================================                        000088   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     6
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  225                                                                                                          000089   26-02-09
  226   // Task data for subfile population                                                                    000090   26-02-09
  227   Dcl-Ds t_taskData qualified template;                                                                  000091   26-02-09
  228     taskId     int(10);                                                                                  000092   26-02-09
  229     name       char(20);                                                                                 000093   26-02-09
  230     startDate  date;                                                                                     000094   26-02-09
  231     endDate    date;                                                                                     000095   26-02-09
  232     state      int(3);                                                                                   000096   26-02-09
  233   end-ds;                                                                                                000097   26-02-09
  234                                                                                                          000098   26-02-09
  235                                                                                                          000099   26-02-09
  236                                                                                                          000100   26-02-09
  237   // Main task record - externally described                                                             000101   26-02-09
  238   Dcl-Ds taskRecord extname('CRUD01TBL') qualified end-ds;                                               000102   26-02-09
  239                                                                                                          000103   26-02-09
  240   // ============================================================================                        000104   26-02-09
  241   // GLOBAL VARIABLES                                                                                    000105   26-02-09
  242   // ============================================================================                        000106   26-02-09
  243                                                                                                          000107   26-02-09
  244   // Subfile management                                                                                  000108   26-02-09
  245   Dcl-S subfileRRN      int(5);                                                                          000109   26-02-09
  246   Dcl-S initialPos      int(10) inz(0);                                                                  000110   26-02-09
  247   Dcl-S finalPos        int(10) inz(10);                                                                 000111   26-02-09
  248   Dcl-S prevInitialPos  int(10);                                                                         000112   26-02-09
  249   Dcl-S prevFinalPos    int(10);                                                                         000113   26-02-09
  250                                                                                                          000114   26-02-09
  251   // Task data for cursor operations                                                                     000115   26-02-09
  252   Dcl-Ds taskData likeds(t_taskData);                                                                    000116   26-02-09
  253                                                                                                          000117   26-02-09
  254   // Query filtering                                                                                     000118   26-02-09
  255   Dcl-S whereClause     varchar(500) inz('');                                                            000119   26-02-09
  256                                                                                                          000120   26-02-09
  257   // Operation control                                                                                   000121   26-02-09
  258   Dcl-S crudFinalized   ind;                                                                             000122   26-02-09
  259   Dcl-S currentUser     char(10) inz(*user);                                                             000123   26-02-09
  260                                                                                                          000124   26-02-09
  261   // ============================================================================                        000125   26-02-09
  262   // MAIN PROCEDURE                                                                                      000126   26-02-09
  263   // ============================================================================                        000127   26-02-09
  264                                                                                                          000128   26-02-09
  265   Dcl-Proc mainline;                                                                                     000129   26-02-09
  266     Dcl-S screenMode char(1);                                                                            000130   26-02-09
  267                                                                                                          000131   26-02-09
  268     monitor;                                                                                             000132   26-02-09
  269       open CRUD01PNL;                                                                                    000133   26-02-09
  270                                                                                                          000134   26-02-09
  271       screenMode = MODE_SUBFILE;                                                                         000135   26-02-09
  272       ShowScreen(screenMode);                                                                            000136   26-02-09
  273                                                                                                          000137   26-02-09
  274       close CRUD01PNL;                                                                                   000138   26-02-09
  275       *Inlr = *On;                                                                                       000139   26-02-09
  276                                                                                                          000140   26-02-09
  277     on-error;                                                                                            000141   26-02-09
  278       // Handle any unexpected errors                                                                    000142   26-02-09
  279       If %open(CRUD01PNL);                                                                               000143   26-02-09
  280         close CRUD01PNL;                                                                                 000144   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     7
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  281       EndIf;                                                                                             000145   26-02-09
  282       *Inlr = *On;                                                                                       000146   26-02-09
  283     endmon;                                                                                              000147   26-02-09
  284   end-proc;                                                                                              000148   26-02-09
  285                                                                                                          000149   26-02-09
  286   // ============================================================================                        000150   26-02-09
  287   // SCREEN MANAGEMENT PROCEDURES                                                                        000151   26-02-09
  288   // ============================================================================                        000152   26-02-09
  289   // WriteScreen - Set screen titles and footer based on mode                                            000153   26-02-09
  290   Dcl-Proc WriteScreen;                                                                                  000154   26-02-09
  291     Dcl-Pi *N;                                                                                           000155   26-02-09
  292       mode char(1) const;                                                                                000156   26-02-09
  293     end-pi;                                                                                              000157   26-02-09
  294                                                                                                          000158   26-02-09
  295     // Set secondary titles                                                                              000159   26-02-09
  296     TITLE2 = centerText('Task Management System' : %len(TITLE2));                                        000160   26-02-09
  297     TITLE3 = centerText('Version 2.0' : %len(TITLE3));                                                   000161   26-02-09
  298                                                                                                          000162   26-02-09
  299     // Set primary title based on mode                                                                   000163   26-02-09
  300     Select;                                                                                              000164   26-02-09
  301       When mode = MODE_INSERT;                                                                           000165   26-02-09
  302         TITLE1 = centerText('TASKS ADMINISTRATOR - INSERT' : %len(TITLE1));                              000166   26-02-09
  303         FOOTTEXT = 'F3=Exit  F10=Confirm';                                                               000167   26-02-09
  304                                                                                                          000168   26-02-09
  305       When mode = MODE_MODIFY;                                                                           000169   26-02-09
  306         TITLE1 = centerText('TASKS ADMINISTRATOR - MODIFY' : %len(TITLE1));                              000170   26-02-09
  307         FOOTTEXT = 'F3=Exit  F10=Confirm';                                                               000171   26-02-09
  308                                                                                                          000172   26-02-09
  309       When mode = MODE_DELETE;                                                                           000173   26-02-09
  310         TITLE1 = centerText('TASKS ADMINISTRATOR - DELETE' : %len(TITLE1));                              000174   26-02-09
  311         FOOTTEXT = 'F3=Exit  F10=Confirm';                                                               000175   26-02-09
  312                                                                                                          000176   26-02-09
  313       When mode = MODE_VIEW;                                                                             000177   26-02-09
  314         TITLE1 = centerText('TASKS ADMINISTRATOR - VIEW' : %len(TITLE1));                                000178   26-02-09
  315         FOOTTEXT = 'F3=Exit';                                                                            000179   26-02-09
  316                                                                                                          000180   26-02-09
  317       When mode = MODE_SUBFILE;                                                                          000181   26-02-09
  318         TITLE1 = centerText('TASKS ADMINISTRATOR - MAIN MENU' : %len(TITLE1));                           000182   26-02-09
  319         FOOTTEXT = 'F3=Exit  F5=Refresh  F6=Create';                                                     000183   26-02-09
  320     EndSl;                                                                                               000184   26-02-09
  321                                                                                                          000185   26-02-09
  322     write HEADER;                                                                                        000186   26-02-09
  323     write FOOTER;                                                                                        000187   26-02-09
  324   end-proc;                                                                                              000188   26-02-09
  325                                                                                                          000189   26-02-09
  326                                                                                                          000190   26-02-09
  327                                                                                                          000191   26-02-09
  328                                                                                                          000192   26-02-09
  329                                                                                                          000193   26-02-09
  330   // ShowScreen - Route to appropriate screen based on mode                                              000194   26-02-09
  331   Dcl-Proc ShowScreen;                                                                                   000195   26-02-09
  332     Dcl-Pi *N;                                                                                           000196   26-02-09
  333       mode char(1) const;                                                                                000197   26-02-09
  334     end-pi;                                                                                              000198   26-02-09
  335                                                                                                          000199   26-02-09
  336     Select;                                                                                              000200   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     8
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  337       When mode = MODE_INSERT;                                                                           000201   26-02-09
  338         InsertScreen(mode);                                                                              000202   26-02-09
  339       When mode = MODE_SUBFILE;                                                                          000203   26-02-09
  340         ShowSubfile(mode);                                                                               000204   26-02-09
  341       When mode = MODE_MODIFY;                                                                           000205   26-02-09
  342         ModifyScreen(mode);                                                                              000206   26-02-09
  343       When mode = MODE_DELETE;                                                                           000207   26-02-09
  344         DeleteScreen(mode);                                                                              000208   26-02-09
  345       When mode = MODE_VIEW;                                                                             000209   26-02-09
  346         ViewScreen(mode);                                                                                000210   26-02-09
  347     EndSl;                                                                                               000211   26-02-09
  348   end-proc;                                                                                              000212   26-02-09
  349                                                                                                          000213   26-02-09
  350                                                                                                          000214   26-02-09
  351                                                                                                          000215   26-02-09
  352                                                                                                          000216   26-02-09
  353                                                                                                          000217   26-02-09
  354   // ShowWindow - Display confirmation or message windows                                                000218   26-02-09
  355   Dcl-Proc ShowWindow;                                                                                   000219   26-02-09
  356     Dcl-Pi *N;                                                                                           000220   26-02-09
  357       windowType char(1) const;                                                                          000221   26-02-09
  358     end-pi;                                                                                              000222   26-02-09
  359                                                                                                          000223   26-02-09
  360     Select;                                                                                              000224   26-02-09
  361       When windowType = WDW_CONFIRM;                                                                     000225   26-02-09
  362         WDWTEXT1 = 'Are you sure you want to proceed?';                                                  000226   26-02-09
  363         WDWTEXT2 = 'Please type Y/N';                                                                    000227   26-02-09
  364         write WDWCONFIRM;                                                                                000228   26-02-09
  365         exfmt WDWCONFIRM;                                                                                000229   26-02-09
  366                                                                                                          000230   26-02-09
  367       When windowType = WDW_MESSAGE;                                                                     000231   26-02-09
  368         WDWMSG1 = 'Record saved successfully';                                                           000232   26-02-09
  369         exfmt WDWMESSAGE;                                                                                000233   26-02-09
  370                                                                                                          000234   26-02-09
  371       When windowType = WDW_DELETE;                                                                      000235   26-02-09
  372         WDWMSG1 = 'Record deleted successfully';                                                         000236   26-02-09
  373         exfmt WDWMESSAGE;                                                                                000237   26-02-09
  374                                                                                                          000238   26-02-09
  375       When windowType = WDW_ERROR;                                                                       000239   26-02-09
  376         WDWMSG1 = 'Error executing operation';                                                           000240   26-02-09
  377         exfmt WDWMESSAGE;                                                                                000241   26-02-09
  378     EndSl;                                                                                               000242   26-02-09
  379   end-proc;                                                                                              000243   26-02-09
  380                                                                                                          000244   26-02-09
  381   // ============================================================================                        000245   26-02-09
  382   // UTILITY PROCEDURES                                                                                  000246   26-02-09
  383   // ============================================================================                        000247   26-02-09
  384   // centerText - Center text within specified length                                                    000248   26-02-09
  385   Dcl-Proc centerText;                                                                                   000249   26-02-09
  386     Dcl-Pi *N char(80);                                                                                  000250   26-02-09
  387       text char(80) const;                                                                               000251   26-02-09
  388       length int(5) const;                                                                               000252   26-02-09
  389     end-pi;                                                                                              000253   26-02-09
  390                                                                                                          000254   26-02-09
  391     Dcl-S blanksNeeded int(5);                                                                           000255   26-02-09
  392     Dcl-S startPos int(5);                                                                               000256   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page     9
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  393     Dcl-S centered char(80) inz(*blanks);                                                                000257   26-02-09
  394     Dcl-S textLen int(5);                                                                                000258   26-02-09
  395                                                                                                          000259   26-02-09
  396     textLen = %len(%trim(text));                                                                         000260   26-02-09
  397                                                                                                          000261   26-02-09
  398     // Ensure we don't exceed the target length                                                          000262   26-02-09
  399     If textLen >= length;                                                                                000263   26-02-09
  400       Return %subst(text : 1 : length);                                                                  000264   26-02-09
  401     EndIf;                                                                                               000265   26-02-09
  402                                                                                                          000266   26-02-09
  403     blanksNeeded = length - textLen;                                                                     000267   26-02-09
  404     startPos = (blanksNeeded / 2) + 1;                                                                   000268   26-02-09
  405                                                                                                          000269   26-02-09
  406     If startPos > 0;                                                                                     000270   26-02-09
  407       %subst(centered : startPos) = %trim(text);                                                         000271   26-02-09
  408     Else;                                                                                                000272   26-02-09
  409       centered = text;                                                                                   000273   26-02-09
  410     EndIf;                                                                                               000274   26-02-09
  411                                                                                                          000275   26-02-09
  412     Return centered;                                                                                     000276   26-02-09
  413   end-proc;                                                                                              000277   26-02-09
  414                                                                                                          000278   26-02-09
  415                                                                                                          000279   26-02-09
  416                                                                                                          000280   26-02-09
  417                                                                                                          000281   26-02-09
  418                                                                                                          000282   26-02-09
  419   // resetErrors - Clear all validation error indicators                                                 000283   26-02-09
  420   Dcl-Proc resetErrors;                                                                                  000284   26-02-09
  421     TaskIdExistsError = *off;                                                                            000285   26-02-09
  422     StartDateError = *off;                                                                               000286   26-02-09
  423     EndDateError = *off;                                                                                 000287   26-02-09
  424     DateRangeError = *off;                                                                               000288   26-02-09
  425   end-proc;                                                                                              000289   26-02-09
  426                                                                                                          000290   26-02-09
  427                                                                                                          000291   26-02-09
  428                                                                                                          000292   26-02-09
  429                                                                                                          000293   26-02-09
  430                                                                                                          000294   26-02-09
  431   // handleSqlError - Centralized SQL error handling                                                     000295   26-02-09
  432   Dcl-Proc handleSqlError;                                                                               000296   26-02-09
  433     Dcl-Pi *N ind;                                                                                       000297   26-02-09
  434       operation varchar(50) const;                                                                       000298   26-02-09
  435     end-pi;                                                                                              000299   26-02-09
  436                                                                                                          000300   26-02-09
  437     If xSqlstate <> SUCCESS_ON_SQL;                                                                      000301   26-02-09
  438       WDWMSG1 = 'SQL Error: ' + %trim(operation);                                                        000302   26-02-09
  439       WDWMSG2 = 'SQLSTATE: ' + SQLSTATE + ' Code: ' + %char(SQLCODE);                                    000303   26-02-09
  440       exfmt WDWMESSAGE;                                                                                  000304   26-02-09
  441       Return *on;                                                                                        000305   26-02-09
  442     EndIf;                                                                                               000306   26-02-09
  443                                                                                                          000307   26-02-09
  444     Return *off;                                                                                         000308   26-02-09
  445   end-proc;                                                                                              000309   26-02-09
  446                                                                                                          000310   26-02-09
  447   // ============================================================================                        000311   26-02-09
  448   // SUBFILE MANAGEMENT PROCEDURES                                                                       000312   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    10
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  449   // ============================================================================                        000313   26-02-09
  450   // ShowSubfile - Main subfile display loop                                                             000314   26-02-09
  451   Dcl-Proc ShowSubfile;                                                                                  000315   26-02-09
  452     Dcl-Pi *N;                                                                                           000316   26-02-09
  453       mode char(1) const;                                                                                000317   26-02-09
  454     end-pi;                                                                                              000318   26-02-09
  455                                                                                                          000319   26-02-09
  456     Dcl-S nextMode char(1);                                                                              000320   26-02-09
  457                                                                                                          000321   26-02-09
  458     dow not pfkey(03);                                                                                   000322   26-02-09
  459       WriteScreen(mode);                                                                                 000323   26-02-09
  460       ActivateSubfile();                                                                                 000324   26-02-09
  461       exfmt SFLTASKCTL;                                                                                  000325   26-02-09
  462                                                                                                          000326   26-02-09
  463       Select;                                                                                            000327   26-02-09
  464         When pfkey(03);                                                                                  000328   26-02-09
  465           pfkey(03) = *off;                                                                              000329   26-02-09
  466           initialPos = 0;                                                                                000330   26-02-09
  467           finalPos = PERPAGE;                                                                            000331   26-02-09
  468           leave;                                                                                         000332   26-02-09
  469                                                                                                          000333   26-02-09
  470         When infds.funcKey = PAGEUP;                                                                     000334   26-02-09
  471           handlePageUp(mode);                                                                            000335   26-02-09
  472                                                                                                          000336   26-02-09
  473         When infds.funcKey = PAGEDOWN;                                                                   000337   26-02-09
  474           handlePageDown(mode);                                                                          000338   26-02-09
  475                                                                                                          000339   26-02-09
  476         When pfkey(05);                                                                                  000340   26-02-09
  477           initialPos = 0;                                                                                000341   26-02-09
  478           finalPos = PERPAGE;                                                                            000342   26-02-09
  479           iter;                                                                                          000343   26-02-09
  480                                                                                                          000344   26-02-09
  481         When pfkey(06);                                                                                  000345   26-02-09
  482           nextMode = MODE_INSERT;                                                                        000346   26-02-09
  483           ShowScreen(nextMode);                                                                          000347   26-02-09
  484           leave;                                                                                         000348   26-02-09
  485                                                                                                          000349   26-02-09
  486         Other;                                                                                           000350   26-02-09
  487           processSubfileOptions(nextMode);                                                               000351   26-02-09
  488           If nextMode <> *blanks;                                                                        000352   26-02-09
  489             ShowScreen(nextMode);                                                                        000353   26-02-09
  490             leave;                                                                                       000354   26-02-09
  491           EndIf;                                                                                         000355   26-02-09
  492       EndSl;                                                                                             000356   26-02-09
  493                                                                                                          000357   26-02-09
  494       If crudFinalized;                                                                                  000358   26-02-09
  495         crudFinalized = *off;                                                                            000359   26-02-09
  496         leave;                                                                                           000360   26-02-09
  497       EndIf;                                                                                             000361   26-02-09
  498     enddo;                                                                                               000362   26-02-09
  499   end-proc;                                                                                              000363   26-02-09
  500                                                                                                          000364   26-02-09
  501                                                                                                          000365   26-02-09
  502                                                                                                          000366   26-02-09
  503                                                                                                          000367   26-02-09
  504                                                                                                          000368   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    11
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  505   // handlePageUp - Process page up request                                                              000369   26-02-09
  506   Dcl-Proc handlePageUp;                                                                                 000370   26-02-09
  507     Dcl-Pi *N;                                                                                           000371   26-02-09
  508       mode char(1) const;                                                                                000372   26-02-09
  509     end-pi;                                                                                              000373   26-02-09
  510                                                                                                          000374   26-02-09
  511     If initialPos = 0 and finalPos = PERPAGE;                                                            000375   26-02-09
  512       // Already at first page                                                                           000376   26-02-09
  513       Return;                                                                                            000377   26-02-09
  514     EndIf;                                                                                               000378   26-02-09
  515                                                                                                          000379   26-02-09
  516     If initialPos > 1;                                                                                   000380   26-02-09
  517       initialPos -= (PERPAGE + 1);                                                                       000381   26-02-09
  518       finalPos -= PERPAGE;                                                                               000382   26-02-09
  519       ShowScreen(mode);                                                                                  000383   26-02-09
  520     EndIf;                                                                                               000384   26-02-09
  521   end-proc;                                                                                              000385   26-02-09
  522                                                                                                          000386   26-02-09
  523                                                                                                          000387   26-02-09
  524                                                                                                          000388   26-02-09
  525                                                                                                          000389   26-02-09
  526                                                                                                          000390   26-02-09
  527   // handlePageDown - Process page down request                                                          000391   26-02-09
  528   Dcl-Proc handlePageDown;                                                                               000392   26-02-09
  529     Dcl-Pi *N;                                                                                           000393   26-02-09
  530       mode char(1) const;                                                                                000394   26-02-09
  531     end-pi;                                                                                              000395   26-02-09
  532                                                                                                          000396   26-02-09
  533     Dcl-S recordExists ind;                                                                              000397   26-02-09
  534                                                                                                          000398   26-02-09
  535     If initialPos > 0 and finalPos > PERPAGE;                                                            000399   26-02-09
  536       recordExists = checkRecordsExist(initialPos : finalPos);                                           000400   26-02-09
  537                                                                                                          000401   26-02-09
  538       If not recordExists;                                                                               000402   26-02-09
  539         initialPos -= (PERPAGE + 1);                                                                     000403   26-02-09
  540         finalPos -= PERPAGE;                                                                             000404   26-02-09
  541       EndIf;                                                                                             000405   26-02-09
  542                                                                                                          000406   26-02-09
  543       ShowScreen(mode);                                                                                  000407   26-02-09
  544     Else;                                                                                                000408   26-02-09
  545       ShowScreen(mode);                                                                                  000409   26-02-09
  546     EndIf;                                                                                               000410   26-02-09
  547   end-proc;                                                                                              000411   26-02-09
  548                                                                                                          000412   26-02-09
  549                                                                                                          000413   26-02-09
  550                                                                                                          000414   26-02-09
  551                                                                                                          000415   26-02-09
  552                                                                                                          000416   26-02-09
  553   // checkRecordsExist - Verify records exist in range                                                   000417   26-02-09
  554   Dcl-Proc checkRecordsExist;                                                                            000418   26-02-09
  555     Dcl-Pi *N ind;                                                                                       000419   26-02-09
  556       startPos int(10) const;                                                                            000420   26-02-09
  557       endPos int(10) const;                                                                              000421   26-02-09
  558     end-pi;                                                                                              000422   26-02-09
  559                                                                                                          000423   26-02-09
  560     Dcl-S recordCount int(10);                                                                           000424   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    12
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  561                                                                                                          000425   26-02-09
  562     exec sql                                                                                             000426   26-02-09
  563       SELECT COUNT(*) INTO :recordCount                                                                  000427   26-02-09
  564       FROM CRUD01TBL;                                                                                    000428   26-02-09
  565                                                                                                          000429   26-02-09
  566     // Check if the requested range is within available records                                          000430   26-02-09
  567     Return (recordCount >= startPos);                                                                    000431   26-02-09
  568   end-proc;                                                                                              000432   26-02-09
  569                                                                                                          000433   26-02-09
  570                                                                                                          000434   26-02-09
  571                                                                                                          000435   26-02-09
  572                                                                                                          000436   26-02-09
  573                                                                                                          000437   26-02-09
  574   // processSubfileOptions - Handle user selections in subfile                                           000438   26-02-09
  575   Dcl-Proc processSubfileOptions;                                                                        000439   26-02-09
  576     Dcl-Pi *N;                                                                                           000440   26-02-09
  577       nextMode char(1);                                                                                  000441   26-02-09
  578     end-pi;                                                                                              000442   26-02-09
  579                                                                                                          000443   26-02-09
  580     Dcl-S rrn int(5);                                                                                    000444   26-02-09
  581                                                                                                          000445   26-02-09
  582     nextMode = *blanks;                                                                                  000446   26-02-09
  583                                                                                                          000447   26-02-09
  584     If subfileRRN = 0;                                                                                   000448   26-02-09
  585       Return;                                                                                            000449   26-02-09
  586     EndIf;                                                                                               000450   26-02-09
  587                                                                                                          000451   26-02-09
  588     For rrn = 1 to PERPAGE;                                                                              000452   26-02-09
  589       chain rrn SFLTASK;                                                                                 000453   26-02-09
  590                                                                                                          000454   26-02-09
  591       If not %found();                                                                                   000455   26-02-09
  592         leave;                                                                                           000456   26-02-09
  593       EndIf;                                                                                             000457   26-02-09
  594                                                                                                          000458   26-02-09
  595       If OPCTASK = *blanks;                                                                              000459   26-02-09
  596         iter;                                                                                            000460   26-02-09
  597       EndIf;                                                                                             000461   26-02-09
  598                                                                                                          000462   26-02-09
  599       // Load task data                                                                                  000463   26-02-09
  600       If not loadTaskById(SFLTASKID);                                                                    000464   26-02-09
  601         OPCTASK = *blanks;                                                                               000465   26-02-09
  602         update SFLTASK;                                                                                  000466   26-02-09
  603         iter;                                                                                            000467   26-02-09
  604       EndIf;                                                                                             000468   26-02-09
  605                                                                                                          000469   26-02-09
  606       // Determine next screen based on option                                                           000470   26-02-09
  607       Select;                                                                                            000471   26-02-09
  608         When OPCTASK = OPT_MODIFY;                                                                       000472   26-02-09
  609           nextMode = MODE_MODIFY;                                                                        000473   26-02-09
  610         When OPCTASK = OPT_DELETE;                                                                       000474   26-02-09
  611           nextMode = MODE_DELETE;                                                                        000475   26-02-09
  612         When OPCTASK = OPT_VIEW;                                                                         000476   26-02-09
  613           nextMode = MODE_VIEW;                                                                          000477   26-02-09
  614       EndSl;                                                                                             000478   26-02-09
  615                                                                                                          000479   26-02-09
  616       OPCTASK = *blanks;                                                                                 000480   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    13
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  617       update SFLTASK;                                                                                    000481   26-02-09
  618       leave;                                                                                             000482   26-02-09
  619     EndFor;                                                                                              000483   26-02-09
  620   end-proc;                                                                                              000484   26-02-09
  621                                                                                                          000485   26-02-09
  622                                                                                                          000486   26-02-09
  623                                                                                                          000487   26-02-09
  624                                                                                                          000488   26-02-09
  625                                                                                                          000489   26-02-09
  626   // loadTaskById - Load task record by ID                                                               000490   26-02-09
  627   Dcl-Proc loadTaskById;                                                                                 000491   26-02-09
  628     Dcl-Pi *N ind;                                                                                       000492   26-02-09
  629       taskId int(10) const;                                                                              000493   26-02-09
  630     end-pi;                                                                                              000494   26-02-09
  631                                                                                                          000495   26-02-09
  632     clear taskRecord;                                                                                    000496   26-02-09
  633                                                                                                          000497   26-02-09
  634     exec sql                                                                                             000498   26-02-09
  635       SELECT * INTO :taskRecord                                                                          000499   26-02-09
  636       FROM CRUD01TBL                                                                                     000500   26-02-09
  637       WHERE TASK_ID = :taskId;                                                                           000501   26-02-09
  638                                                                                                          000502   26-02-09
  639     Return (xSqlstate = SUCCESS_ON_SQL);                                                                 000503   26-02-09
  640   end-proc;                                                                                              000504   26-02-09
  641                                                                                                          000505   26-02-09
  642                                                                                                          000506   26-02-09
  643                                                                                                          000507   26-02-09
  644                                                                                                          000508   26-02-09
  645                                                                                                          000509   26-02-09
  646   // SflInitial - Initialize subfile for loading                                                         000510   26-02-09
  647   Dcl-Proc SflInitial;                                                                                   000511   26-02-09
  648     SflEnd = *off;                                                                                       000512   26-02-09
  649     SflClr = *on;                                                                                        000513   26-02-09
  650     write SFLTASKCTL;                                                                                    000514   26-02-09
  651     SflClr = *off;                                                                                       000515   26-02-09
  652     subfileRRN = 0;                                                                                      000516   26-02-09
  653     SflDsp = *off;                                                                                       000517   26-02-09
  654     SflDspCtl = *off;                                                                                    000518   26-02-09
  655   end-proc;                                                                                              000519   26-02-09
  656                                                                                                          000520   26-02-09
  657                                                                                                          000521   26-02-09
  658                                                                                                          000522   26-02-09
  659                                                                                                          000523   26-02-09
  660                                                                                                          000524   26-02-09
  661   // ActivateSubfile - Prepare and display subfile                                                       000525   26-02-09
  662   Dcl-Proc ActivateSubfile;                                                                              000526   26-02-09
  663     Dcl-S totalRecords int(10);                                                                          000527   26-02-09
  664                                                                                                          000528   26-02-09
  665     SflInitial();                                                                                        000529   26-02-09
  666     FillSubfile();                                                                                       000530   26-02-09
  667                                                                                                          000531   26-02-09
  668     totalRecords = getTotalRecords();                                                                    000532   26-02-09
  669     // Set end indicator based on whether we've loaded all records                                       000533   26-02-09
  670     SflEnd = (initialPos + subfileRRN >= totalRecords);                                                  000534   26-02-09
  671                                                                                                          000535   26-02-09
  672     If subfileRRN > 0;                                                                                   000536   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    14
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  673       SflDsp = *on;                                                                                      000537   26-02-09
  674     Else;                                                                                                000538   26-02-09
  675       write EMPTY;                                                                                       000539   26-02-09
  676     EndIf;                                                                                               000540   26-02-09
  677                                                                                                          000541   26-02-09
  678     SflDspCtl = *on;                                                                                     000542   26-02-09
  679   end-proc;                                                                                              000543   26-02-09
  680                                                                                                          000544   26-02-09
  681                                                                                                          000545   26-02-09
  682                                                                                                          000546   26-02-09
  683                                                                                                          000547   26-02-09
  684                                                                                                          000548   26-02-09
  685   // FillSubfile - Load subfile with data using cursor                                                   000549   26-02-09
  686   Dcl-Proc FillSubfile;                                                                                  000550   26-02-09
  687     Dcl-S count int(5) inz(0);                                                                           000551   26-02-09
  688                                                                                                          000552   26-02-09
  689     prevInitialPos = initialPos;                                                                         000553   26-02-09
  690     prevFinalPos = finalPos;                                                                             000554   26-02-09
  691                                                                                                          000555   26-02-09
  692     clear taskData;                                                                                      000556   26-02-09
  693                                                                                                          000557   26-02-09
  694     exec sql                                                                                             000558   26-02-09
  695       DECLARE TASK_CURSOR CURSOR FOR                                                                     000559   26-02-09
  696       SELECT TASK_ID, NAME, STARTDATE, ENDDATE, STATE                                                    000560   26-02-09
  697       FROM CRUD01TBL                                                                                     000561   26-02-09
  698       ORDER BY TASK_ID                                                                                   000562   26-02-09
  699       OFFSET :initialPos ROWS                                                                            000563   26-02-09
  700       FETCH FIRST :PERPAGE ROWS ONLY;                                                                    000564   26-02-09
  701                                                                                                          000565   26-02-09
  702     exec sql OPEN TASK_CURSOR;                                                                           000566   26-02-09
  703                                                                                                          000567   26-02-09
  704     If xSqlstate <> SUCCESS_ON_SQL;                                                                      000568   26-02-09
  705       Return;                                                                                            000569   26-02-09
  706     EndIf;                                                                                               000570   26-02-09
  707                                                                                                          000571   26-02-09
  708     exec sql FETCH TASK_CURSOR INTO :taskData.taskId, :taskData.name,                                    000572   26-02-09
  709                                      :taskData.startDate, :taskData.endDate,                             000573   26-02-09
  710                                      :taskData.state;                                                    000574   26-02-09
  711                                                                                                          000575   26-02-09
  712     dow (xSqlstate = SUCCESS_ON_SQL) and (count < PERPAGE);                                              000576   26-02-09
  713       count += 1;                                                                                        000577   26-02-09
  714       addToSubfile();                                                                                    000578   26-02-09
  715       exec sql FETCH TASK_CURSOR INTO :taskData.taskId, :taskData.name,                                  000579   26-02-09
  716                                        :taskData.startDate, :taskData.endDate,                           000580   26-02-09
  717                                        :taskData.state;                                                  000581   26-02-09
  718     enddo;                                                                                               000582   26-02-09
  719                                                                                                          000583   26-02-09
  720     exec sql CLOSE TASK_CURSOR;                                                                          000584   26-02-09
  721                                                                                                          000585   26-02-09
  722     // Update position for next page                                                                     000586   26-02-09
  723     If count = PERPAGE;                                                                                  000587   26-02-09
  724       initialPos += count + 1;                                                                           000588   26-02-09
  725       finalPos += count;                                                                                 000589   26-02-09
  726     EndIf;                                                                                               000590   26-02-09
  727   end-proc;                                                                                              000591   26-02-09
  728                                                                                                          000592   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    15
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  729                                                                                                          000593   26-02-09
  730                                                                                                          000594   26-02-09
  731                                                                                                          000595   26-02-09
  732                                                                                                          000596   26-02-09
  733   // addToSubfile - Add current record to subfile                                                        000597   26-02-09
  734   Dcl-Proc addToSubfile;                                                                                 000598   26-02-09
  735     subfileRRN += 1;                                                                                     000599   26-02-09
  736     SFLTASKID = taskData.taskId;                                                                         000600   26-02-09
  737     SFLTASKNAM = taskData.name;                                                                          000601   26-02-09
  738     SFLSTRDATE = %dec(taskData.startDate);                                                               000602   26-02-09
  739     SFLENDDATE = %dec(taskData.endDate);                                                                 000603   26-02-09
  740     SFLSTATE = taskData.state;                                                                           000604   26-02-09
  741     write SFLTASK;                                                                                       000605   26-02-09
  742     clear SFLTASK;                                                                                       000606   26-02-09
  743   end-proc;                                                                                              000607   26-02-09
  744                                                                                                          000608   26-02-09
  745                                                                                                          000609   26-02-09
  746                                                                                                          000610   26-02-09
  747                                                                                                          000611   26-02-09
  748                                                                                                          000612   26-02-09
  749   // getTotalRecords - Get count of all records                                                          000613   26-02-09
  750   Dcl-Proc getTotalRecords;                                                                              000614   26-02-09
  751     Dcl-Pi *N int(10);                                                                                   000615   26-02-09
  752     end-pi;                                                                                              000616   26-02-09
  753                                                                                                          000617   26-02-09
  754     Dcl-S total int(10);                                                                                 000618   26-02-09
  755                                                                                                          000619   26-02-09
  756     exec sql                                                                                             000620   26-02-09
  757       SELECT COUNT(*) INTO :total                                                                        000621   26-02-09
  758       FROM CRUD01TBL;                                                                                    000622   26-02-09
  759                                                                                                          000623   26-02-09
  760     If xSqlstate <> SUCCESS_ON_SQL;                                                                      000624   26-02-09
  761       total = 0;                                                                                         000625   26-02-09
  762     EndIf;                                                                                               000626   26-02-09
  763                                                                                                          000627   26-02-09
  764     Return total;                                                                                        000628   26-02-09
  765   end-proc;                                                                                              000629   26-02-09
  766                                                                                                          000630   26-02-09
  767   // ============================================================================                        000631   26-02-09
  768   // VALIDATION PROCEDURES                                                                               000632   26-02-09
  769   // ============================================================================                        000633   26-02-09
  770   // validateScreen - Validate input based on mode                                                       000634   26-02-09
  771   Dcl-Proc validateScreen;                                                                               000635   26-02-09
  772     Dcl-Pi *N ind;                                                                                       000636   26-02-09
  773       mode char(1) const;                                                                                000637   26-02-09
  774     end-pi;                                                                                              000638   26-02-09
  775                                                                                                          000639   26-02-09
  776     Dcl-S hasErrors ind inz(*off);                                                                       000640   26-02-09
  777                                                                                                          000641   26-02-09
  778     IndErrors = *zeros;                                                                                  000642   26-02-09
  779     resetErrors();                                                                                       000643   26-02-09
  780                                                                                                          000644   26-02-09
  781     Select;                                                                                              000645   26-02-09
  782       When mode = MODE_INSERT;                                                                           000646   26-02-09
  783         hasErrors = validateInsert();                                                                    000647   26-02-09
  784       When mode = MODE_MODIFY;                                                                           000648   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    16
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  785         hasErrors = validateModify();                                                                    000649   26-02-09
  786       Other;                                                                                             000650   26-02-09
  787         // No validation needed for DELETE or VIEW modes                                                 000651   26-02-09
  788         hasErrors = *off;                                                                                000652   26-02-09
  789     EndSl;                                                                                               000653   26-02-09
  790                                                                                                          000654   26-02-09
  791     Return hasErrors;                                                                                    000655   26-02-09
  792   end-proc;                                                                                              000656   26-02-09
  793                                                                                                          000657   26-02-09
  794                                                                                                          000658   26-02-09
  795                                                                                                          000659   26-02-09
  796                                                                                                          000660   26-02-09
  797                                                                                                          000661   26-02-09
  798   // validateInsert - Validation specific to insert operation                                            000662   26-02-09
  799   Dcl-Proc validateInsert;                                                                               000663   26-02-09
  800     Dcl-Pi *N ind;                                                                                       000664   26-02-09
  801     end-pi;                                                                                              000665   26-02-09
  802                                                                                                          000666   26-02-09
  803     Dcl-S exists char(1);                                                                                000667   26-02-09
  804     Dcl-S hasErrors ind inz(*off);                                                                       000668   26-02-09
  805                                                                                                          000669   26-02-09
  806     // Check if task ID already exists                                                                   000670   26-02-09
  807     clear exists;                                                                                        000671   26-02-09
  808     exec sql                                                                                             000672   26-02-09
  809       SELECT '1' INTO :exists                                                                            000673   26-02-09
  810       FROM CRUD01TBL                                                                                     000674   26-02-09
  811       WHERE TASK_ID = :CRUDTASKID                                                                        000675   26-02-09
  812       FETCH FIRST ROW ONLY;                                                                              000676   26-02-09
  813                                                                                                          000677   26-02-09
  814     If xSqlstate = SUCCESS_ON_SQL and exists = '1';                                                      000678   26-02-09
  815       TaskIdExistsError = *on;                                                                           000679   26-02-09
  816       hasErrors = *on;                                                                                   000680   26-02-09
  817     EndIf;                                                                                               000681   26-02-09
  818                                                                                                          000682   26-02-09
  819     // Validate start date                                                                               000683   26-02-09
  820     test(de) *iso STARTDATE;                                                                             000684   26-02-09
  821     If %error;                                                                                           000685   26-02-09
  822       StartDateError = *on;                                                                              000686   26-02-09
  823       hasErrors = *on;                                                                                   000687   26-02-09
  824     EndIf;                                                                                               000688   26-02-09
  825                                                                                                          000689   26-02-09
  826     // Validate end date                                                                                 000690   26-02-09
  827     test(de) *iso ENDDATE;                                                                               000691   26-02-09
  828     If %error;                                                                                           000692   26-02-09
  829       EndDateError = *on;                                                                                000693   26-02-09
  830       hasErrors = *on;                                                                                   000694   26-02-09
  831     EndIf;                                                                                               000695   26-02-09
  832                                                                                                          000696   26-02-09
  833     // Validate date range                                                                               000697   26-02-09
  834     If STARTDATE <> 0 and ENDDATE <> 0                                                                   000698   26-02-09
  835        and not StartDateError and not EndDateError;                                                      000699   26-02-09
  836       If STARTDATE > ENDDATE;                                                                            000700   26-02-09
  837         DateRangeError = *on;                                                                            000701   26-02-09
  838         hasErrors = *on;                                                                                 000702   26-02-09
  839       EndIf;                                                                                             000703   26-02-09
  840     EndIf;                                                                                               000704   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    17
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  841                                                                                                          000705   26-02-09
  842     Return hasErrors;                                                                                    000706   26-02-09
  843   end-proc;                                                                                              000707   26-02-09
  844                                                                                                          000708   26-02-09
  845                                                                                                          000709   26-02-09
  846                                                                                                          000710   26-02-09
  847                                                                                                          000711   26-02-09
  848                                                                                                          000712   26-02-09
  849   // validateModify - Validation specific to modify operation                                            000713   26-02-09
  850   Dcl-Proc validateModify;                                                                               000714   26-02-09
  851     Dcl-Pi *N ind;                                                                                       000715   26-02-09
  852     end-pi;                                                                                              000716   26-02-09
  853                                                                                                          000717   26-02-09
  854     Dcl-S hasErrors ind inz(*off);                                                                       000718   26-02-09
  855                                                                                                          000719   26-02-09
  856     // Validate start date                                                                               000720   26-02-09
  857     test(de) *iso STARTDATE;                                                                             000721   26-02-09
  858     If %error;                                                                                           000722   26-02-09
  859       StartDateError = *on;                                                                              000723   26-02-09
  860       hasErrors = *on;                                                                                   000724   26-02-09
  861     EndIf;                                                                                               000725   26-02-09
  862                                                                                                          000726   26-02-09
  863     // Validate end date                                                                                 000727   26-02-09
  864     test(de) *iso ENDDATE;                                                                               000728   26-02-09
  865     If %error;                                                                                           000729   26-02-09
  866       EndDateError = *on;                                                                                000730   26-02-09
  867       hasErrors = *on;                                                                                   000731   26-02-09
  868     EndIf;                                                                                               000732   26-02-09
  869                                                                                                          000733   26-02-09
  870     // Validate date range                                                                               000734   26-02-09
  871     If STARTDATE <> 0 and ENDDATE <> 0                                                                   000735   26-02-09
  872        and not StartDateError and not EndDateError;                                                      000736   26-02-09
  873       If STARTDATE > ENDDATE;                                                                            000737   26-02-09
  874         DateRangeError = *on;                                                                            000738   26-02-09
  875         hasErrors = *on;                                                                                 000739   26-02-09
  876       EndIf;                                                                                             000740   26-02-09
  877     EndIf;                                                                                               000741   26-02-09
  878                                                                                                          000742   26-02-09
  879     Return hasErrors;                                                                                    000743   26-02-09
  880   end-proc;                                                                                              000744   26-02-09
  881                                                                                                          000745   26-02-09
  882   // ============================================================================                        000746   26-02-09
  883   // CRUD OPERATION PROCEDURES                                                                           000747   26-02-09
  884   // ============================================================================                        000748   26-02-09
  885   // InsertScreen - Handle insert operation                                                              000749   26-02-09
  886   Dcl-Proc InsertScreen;                                                                                 000750   26-02-09
  887     Dcl-Pi *N;                                                                                           000751   26-02-09
  888       mode char(1) const;                                                                                000752   26-02-09
  889     end-pi;                                                                                              000753   26-02-09
  890                                                                                                          000754   26-02-09
  891     Dcl-S nextMode char(1);                                                                              000755   26-02-09
  892                                                                                                          000756   26-02-09
  893     WriteScreen(mode);                                                                                   000757   26-02-09
  894                                                                                                          000758   26-02-09
  895     dow not pfkey(03);                                                                                   000759   26-02-09
  896       ProtectFields_35 = *off;                                                                           000760   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    18
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  897       ProtectFields_36 = *off;                                                                           000761   26-02-09
  898       exfmt CRUDTASK;                                                                                    000762   26-02-09
  899                                                                                                          000763   26-02-09
  900       Select;                                                                                            000764   26-02-09
  901         When pfkey(03);                                                                                  000765   26-02-09
  902           cleanupAndReturn(nextMode);                                                                    000766   26-02-09
  903           ShowScreen(nextMode);                                                                          000767   26-02-09
  904           leave;                                                                                         000768   26-02-09
  905                                                                                                          000769   26-02-09
  906         When pfkey(10);                                                                                  000770   26-02-09
  907           If not validateScreen(mode);                                                                   000771   26-02-09
  908             If confirmAction();                                                                          000772   26-02-09
  909               If performInsert();                                                                        000773   26-02-09
  910                 ShowWindow(WDW_MESSAGE);                                                                 000774   26-02-09
  911                 cleanupAndReturn(nextMode);                                                              000775   26-02-09
  912                 ShowScreen(nextMode);                                                                    000776   26-02-09
  913                 leave;                                                                                   000777   26-02-09
  914               Else;                                                                                      000778   26-02-09
  915                 ShowWindow(WDW_ERROR);                                                                   000779   26-02-09
  916               EndIf;                                                                                     000780   26-02-09
  917             Else;                                                                                        000781   26-02-09
  918               clear CRUDTASK;                                                                            000782   26-02-09
  919             EndIf;                                                                                       000783   26-02-09
  920           EndIf;                                                                                         000784   26-02-09
  921                                                                                                          000785   26-02-09
  922         Other;                                                                                           000786   26-02-09
  923           If validateScreen(mode);                                                                       000787   26-02-09
  924             iter;                                                                                        000788   26-02-09
  925           EndIf;                                                                                         000789   26-02-09
  926       EndSl;                                                                                             000790   26-02-09
  927     enddo;                                                                                               000791   26-02-09
  928   end-proc;                                                                                              000792   26-02-09
  929                                                                                                          000793   26-02-09
  930                                                                                                          000794   26-02-09
  931                                                                                                          000795   26-02-09
  932                                                                                                          000796   26-02-09
  933                                                                                                          000797   26-02-09
  934   // performInsert - Execute insert with transaction control                                             000798   26-02-09
  935   Dcl-Proc performInsert;                                                                                000799   26-02-09
  936     Dcl-Pi *N ind;                                                                                       000800   26-02-09
  937     end-pi;                                                                                              000801   26-02-09
  938                                                                                                          000802   26-02-09
  939     loadDataToRecord();                                                                                  000803   26-02-09
  940                                                                                                          000804   26-02-09
  941     monitor;                                                                                             000805   26-02-09
  942       exec sql                                                                                           000806   26-02-09
  943         INSERT INTO CRUD01TBL (                                                                          000807   26-02-09
  944           TASK_ID, NAME, DESCR, ENDDES,                                                                  000808   26-02-09
  945           STARTDATE, ENDDATE, STATE, OWNER                                                               000809   26-02-09
  946         ) VALUES (                                                                                       000810   26-02-09
  947           :taskRecord.Task_id,                                                                           000811   26-02-09
  948           :taskRecord.Name,                                                                              000812   26-02-09
  949           :taskRecord.Descr,                                                                             000813   26-02-09
  950           :taskRecord.Enddes,                                                                            000814   26-02-09
  951           :taskRecord.Startdate,                                                                         000815   26-02-09
  952           :taskRecord.Enddate,                                                                           000816   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    19
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
  953           :taskRecord.State,                                                                             000817   26-02-09
  954           :taskRecord.Owner                                                                              000818   26-02-09
  955         );                                                                                               000819   26-02-09
  956                                                                                                          000820   26-02-09
  957       If xSqlstate = SUCCESS_ON_SQL;                                                                     000821   26-02-09
  958         exec sql COMMIT;                                                                                 000822   26-02-09
  959         Return *on;                                                                                      000823   26-02-09
  960       Else;                                                                                              000824   26-02-09
  961         exec sql ROLLBACK;                                                                               000825   26-02-09
  962         Return *off;                                                                                     000826   26-02-09
  963       EndIf;                                                                                             000827   26-02-09
  964                                                                                                          000828   26-02-09
  965     on-error;                                                                                            000829   26-02-09
  966       exec sql ROLLBACK;                                                                                 000830   26-02-09
  967       Return *off;                                                                                       000831   26-02-09
  968     endmon;                                                                                              000832   26-02-09
  969   end-proc;                                                                                              000833   26-02-09
  970                                                                                                          000834   26-02-09
  971                                                                                                          000835   26-02-09
  972                                                                                                          000836   26-02-09
  973                                                                                                          000837   26-02-09
  974                                                                                                          000838   26-02-09
  975   // ModifyScreen - Handle modify operation                                                              000839   26-02-09
  976   Dcl-Proc ModifyScreen;                                                                                 000840   26-02-09
  977     Dcl-Pi *N;                                                                                           000841   26-02-09
  978       mode char(1) const;                                                                                000842   26-02-09
  979     end-pi;                                                                                              000843   26-02-09
  980                                                                                                          000844   26-02-09
  981     Dcl-S nextMode char(1);                                                                              000845   26-02-09
  982                                                                                                          000846   26-02-09
  983     loadDataToScreen();                                                                                  000847   26-02-09
  984     WriteScreen(mode);                                                                                   000848   26-02-09
  985                                                                                                          000849   26-02-09
  986     dow not pfkey(03);                                                                                   000850   26-02-09
  987       ProtectFields_35 = *on;                                                                            000851   26-02-09
  988       exfmt CRUDTASK;                                                                                    000852   26-02-09
  989                                                                                                          000853   26-02-09
  990       Select;                                                                                            000854   26-02-09
  991         When pfkey(03);                                                                                  000855   26-02-09
  992           ProtectFields_35 = *off;                                                                       000856   26-02-09
  993           cleanupAndReturn(nextMode);                                                                    000857   26-02-09
  994           crudFinalized = *on;                                                                           000858   26-02-09
  995           ShowScreen(nextMode);                                                                          000859   26-02-09
  996           leave;                                                                                         000860   26-02-09
  997                                                                                                          000861   26-02-09
  998         When pfkey(10);                                                                                  000862   26-02-09
  999           If not validateScreen(mode);                                                                   000863   26-02-09
 1000             If confirmAction();                                                                          000864   26-02-09
 1001               If performUpdate();                                                                        000865   26-02-09
 1002                 ShowWindow(WDW_MESSAGE);                                                                 000866   26-02-09
 1003                 cleanupAndReturn(nextMode);                                                              000867   26-02-09
 1004                 crudFinalized = *on;                                                                     000868   26-02-09
 1005                 ShowScreen(nextMode);                                                                    000869   26-02-09
 1006                 leave;                                                                                   000870   26-02-09
 1007               Else;                                                                                      000871   26-02-09
 1008                 ShowWindow(WDW_ERROR);                                                                   000872   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    20
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
 1009               EndIf;                                                                                     000873   26-02-09
 1010             Else;                                                                                        000874   26-02-09
 1011               clear CRUDTASK;                                                                            000875   26-02-09
 1012             EndIf;                                                                                       000876   26-02-09
 1013           EndIf;                                                                                         000877   26-02-09
 1014                                                                                                          000878   26-02-09
 1015         Other;                                                                                           000879   26-02-09
 1016           If validateScreen(mode);                                                                       000880   26-02-09
 1017             iter;                                                                                        000881   26-02-09
 1018           EndIf;                                                                                         000882   26-02-09
 1019       EndSl;                                                                                             000883   26-02-09
 1020     enddo;                                                                                               000884   26-02-09
 1021   end-proc;                                                                                              000885   26-02-09
 1022                                                                                                          000886   26-02-09
 1023                                                                                                          000887   26-02-09
 1024                                                                                                          000888   26-02-09
 1025                                                                                                          000889   26-02-09
 1026                                                                                                          000890   26-02-09
 1027   // performUpdate - Execute update operation                                                            000891   26-02-09
 1028   Dcl-Proc performUpdate;                                                                                000892   26-02-09
 1029     Dcl-Pi *N ind;                                                                                       000893   26-02-09
 1030     end-pi;                                                                                              000894   26-02-09
 1031                                                                                                          000895   26-02-09
 1032     monitor;                                                                                             000896   26-02-09
 1033       exec sql                                                                                           000897   26-02-09
 1034         UPDATE CRUD01TBL                                                                                 000898   26-02-09
 1035         SET NAME = :NAMETASK,                                                                            000899   26-02-09
 1036             DESCR = :DESCRP,                                                                             000900   26-02-09
 1037             ENDDES = :SOLUTION,                                                                          000901   26-02-09
 1038             STARTDATE = :STARTDATE,                                                                      000902   26-02-09
 1039             ENDDATE = :ENDDATE,                                                                          000903   26-02-09
 1040             STATE = :STATETASK,                                                                          000904   26-02-09
 1041             OWNER = :currentUser                                                                         000905   26-02-09
 1042         WHERE TASK_ID = :CRUDTASKID;                                                                     000906   26-02-09
 1043                                                                                                          000907   26-02-09
 1044       If xSqlstate = SUCCESS_ON_SQL;                                                                     000908   26-02-09
 1045         exec sql COMMIT;                                                                                 000909   26-02-09
 1046         Return *on;                                                                                      000910   26-02-09
 1047       Else;                                                                                              000911   26-02-09
 1048         exec sql ROLLBACK;                                                                               000912   26-02-09
 1049         Return *off;                                                                                     000913   26-02-09
 1050       EndIf;                                                                                             000914   26-02-09
 1051                                                                                                          000915   26-02-09
 1052     on-error;                                                                                            000916   26-02-09
 1053       exec sql ROLLBACK;                                                                                 000917   26-02-09
 1054       Return *off;                                                                                       000918   26-02-09
 1055     endmon;                                                                                              000919   26-02-09
 1056   end-proc;                                                                                              000920   26-02-09
 1057                                                                                                          000921   26-02-09
 1058                                                                                                          000922   26-02-09
 1059                                                                                                          000923   26-02-09
 1060                                                                                                          000924   26-02-09
 1061                                                                                                          000925   26-02-09
 1062   // DeleteScreen - Handle delete operation                                                              000926   26-02-09
 1063   Dcl-Proc DeleteScreen;                                                                                 000927   26-02-09
 1064     Dcl-Pi *N;                                                                                           000928   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    21
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
 1065       mode char(1) const;                                                                                000929   26-02-09
 1066     end-pi;                                                                                              000930   26-02-09
 1067                                                                                                          000931   26-02-09
 1068     Dcl-S nextMode char(1);                                                                              000932   26-02-09
 1069                                                                                                          000933   26-02-09
 1070     loadDataToScreen();                                                                                  000934   26-02-09
 1071     WriteScreen(mode);                                                                                   000935   26-02-09
 1072                                                                                                          000936   26-02-09
 1073     dow not pfkey(03);                                                                                   000937   26-02-09
 1074       ProtectFields_35 = *on;                                                                            000938   26-02-09
 1075       ProtectFields_36 = *on;                                                                            000939   26-02-09
 1076       exfmt CRUDTASK;                                                                                    000940   26-02-09
 1077                                                                                                          000941   26-02-09
 1078       Select;                                                                                            000942   26-02-09
 1079         When pfkey(03);                                                                                  000943   26-02-09
 1080           ProtectFields_35 = *off;                                                                       000944   26-02-09
 1081           ProtectFields_36 = *off;                                                                       000945   26-02-09
 1082           cleanupAndReturn(nextMode);                                                                    000946   26-02-09
 1083           crudFinalized = *on;                                                                           000947   26-02-09
 1084           ShowScreen(nextMode);                                                                          000948   26-02-09
 1085           leave;                                                                                         000949   26-02-09
 1086                                                                                                          000950   26-02-09
 1087         When pfkey(10);                                                                                  000951   26-02-09
 1088           If confirmAction();                                                                            000952   26-02-09
 1089             If performDelete();                                                                          000953   26-02-09
 1090               ShowWindow(WDW_DELETE);                                                                    000954   26-02-09
 1091               cleanupAndReturn(nextMode);                                                                000955   26-02-09
 1092               crudFinalized = *on;                                                                       000956   26-02-09
 1093               ShowScreen(nextMode);                                                                      000957   26-02-09
 1094               leave;                                                                                     000958   26-02-09
 1095             Else;                                                                                        000959   26-02-09
 1096               ShowWindow(WDW_ERROR);                                                                     000960   26-02-09
 1097             EndIf;                                                                                       000961   26-02-09
 1098           Else;                                                                                          000962   26-02-09
 1099             clear CRUDTASK;                                                                              000963   26-02-09
 1100           EndIf;                                                                                         000964   26-02-09
 1101                                                                                                          000965   26-02-09
 1102         Other;                                                                                           000966   26-02-09
 1103           iter;                                                                                          000967   26-02-09
 1104       EndSl;                                                                                             000968   26-02-09
 1105     enddo;                                                                                               000969   26-02-09
 1106   end-proc;                                                                                              000970   26-02-09
 1107                                                                                                          000971   26-02-09
 1108                                                                                                          000972   26-02-09
 1109                                                                                                          000973   26-02-09
 1110                                                                                                          000974   26-02-09
 1111                                                                                                          000975   26-02-09
 1112   // performDelete - Execute delete operation                                                            000976   26-02-09
 1113   Dcl-Proc performDelete;                                                                                000977   26-02-09
 1114     Dcl-Pi *N ind;                                                                                       000978   26-02-09
 1115     end-pi;                                                                                              000979   26-02-09
 1116                                                                                                          000980   26-02-09
 1117     monitor;                                                                                             000981   26-02-09
 1118       exec sql                                                                                           000982   26-02-09
 1119         DELETE FROM CRUD01TBL                                                                            000983   26-02-09
 1120         WHERE TASK_ID = :CRUDTASKID;                                                                     000984   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    22
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
 1121                                                                                                          000985   26-02-09
 1122       If xSqlstate = SUCCESS_ON_SQL;                                                                     000986   26-02-09
 1123         exec sql COMMIT;                                                                                 000987   26-02-09
 1124         Return *on;                                                                                      000988   26-02-09
 1125       Else;                                                                                              000989   26-02-09
 1126         exec sql ROLLBACK;                                                                               000990   26-02-09
 1127         Return *off;                                                                                     000991   26-02-09
 1128       EndIf;                                                                                             000992   26-02-09
 1129                                                                                                          000993   26-02-09
 1130     on-error;                                                                                            000994   26-02-09
 1131       exec sql ROLLBACK;                                                                                 000995   26-02-09
 1132       Return *off;                                                                                       000996   26-02-09
 1133     endmon;                                                                                              000997   26-02-09
 1134   end-proc;                                                                                              000998   26-02-09
 1135                                                                                                          000999   26-02-09
 1136                                                                                                          001000   26-02-09
 1137                                                                                                          001001   26-02-09
 1138                                                                                                          001002   26-02-09
 1139                                                                                                          001003   26-02-09
 1140   // ViewScreen - Display record in read-only mode                                                       001004   26-02-09
 1141   Dcl-Proc ViewScreen;                                                                                   001005   26-02-09
 1142     Dcl-Pi *N;                                                                                           001006   26-02-09
 1143       mode char(1) const;                                                                                001007   26-02-09
 1144     end-pi;                                                                                              001008   26-02-09
 1145                                                                                                          001009   26-02-09
 1146     Dcl-S nextMode char(1);                                                                              001010   26-02-09
 1147                                                                                                          001011   26-02-09
 1148     loadDataToScreen();                                                                                  001012   26-02-09
 1149     WriteScreen(mode);                                                                                   001013   26-02-09
 1150                                                                                                          001014   26-02-09
 1151     dow not pfkey(03);                                                                                   001015   26-02-09
 1152       ProtectFields_35 = *on;                                                                            001016   26-02-09
 1153       ProtectFields_36 = *on;                                                                            001017   26-02-09
 1154       exfmt CRUDTASK;                                                                                    001018   26-02-09
 1155                                                                                                          001019   26-02-09
 1156       If pfkey(03);                                                                                      001020   26-02-09
 1157         ProtectFields_35 = *off;                                                                         001021   26-02-09
 1158         ProtectFields_36 = *off;                                                                         001022   26-02-09
 1159         cleanupAndReturn(nextMode);                                                                      001023   26-02-09
 1160         crudFinalized = *on;                                                                             001024   26-02-09
 1161         ShowScreen(nextMode);                                                                            001025   26-02-09
 1162         leave;                                                                                           001026   26-02-09
 1163       EndIf;                                                                                             001027   26-02-09
 1164     enddo;                                                                                               001028   26-02-09
 1165   end-proc;                                                                                              001029   26-02-09
 1166                                                                                                          001030   26-02-09
 1167   // ============================================================================                        001031   26-02-09
 1168   // DATA TRANSFER PROCEDURES                                                                            001032   26-02-09
 1169   // ============================================================================                        001033   26-02-09
 1170   // loadDataToScreen - Transfer data from record to screen                                              001034   26-02-09
 1171   Dcl-Proc loadDataToScreen;                                                                             001035   26-02-09
 1172     clear CRUDTASK;                                                                                      001036   26-02-09
 1173     CRUDTASKID = taskRecord.Task_id;                                                                     001037   26-02-09
 1174     NAMETASK = taskRecord.Name;                                                                          001038   26-02-09
 1175     DESCRP = taskRecord.Descr;                                                                           001039   26-02-09
 1176     SOLUTION = taskRecord.Enddes;                                                                        001040   26-02-09
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    23
Record  *...+... 1 ...+... 2 ...+... 3 ...+... 4 ...+... 5 ...+... 6 ...+... 7 ...+... 8 ...+... 9 ...+... 0   SEQNBR  Last change
 1177     STARTDATE = taskRecord.Startdate;                                                                    001041   26-02-09
 1178     ENDDATE = taskRecord.Enddate;                                                                        001042   26-02-09
 1179     STATETASK = taskRecord.State;                                                                        001043   26-02-09
 1180   end-proc;                                                                                              001044   26-02-09
 1181                                                                                                          001045   26-02-09
 1182                                                                                                          001046   26-02-09
 1183                                                                                                          001047   26-02-09
 1184                                                                                                          001048   26-02-09
 1185                                                                                                          001049   26-02-09
 1186   // loadDataToRecord - Transfer data from screen to record                                              001050   26-02-09
 1187   Dcl-Proc loadDataToRecord;                                                                             001051   26-02-09
 1188     clear taskRecord;                                                                                    001052   26-02-09
 1189     taskRecord.Task_id = CRUDTASKID;                                                                     001053   26-02-09
 1190     taskRecord.Name = %trim(NAMETASK);                                                                   001054   26-02-09
 1191     taskRecord.Descr = %trim(DESCRP);                                                                    001055   26-02-09
 1192     taskRecord.Enddes = %trim(SOLUTION);                                                                 001056   26-02-09
 1193     taskRecord.Startdate = STARTDATE;                                                                    001057   26-02-09
 1194     taskRecord.Enddate = ENDDATE;                                                                        001058   26-02-09
 1195     taskRecord.State = STATETASK;                                                                        001059   26-02-09
 1196     taskRecord.Owner = currentUser;                                                                      001060   26-02-09
 1197   end-proc;                                                                                              001061   26-02-09
 1198                                                                                                          001062   26-02-09
 1199                                                                                                          001063   26-02-09
 1200                                                                                                          001064   26-02-09
 1201                                                                                                          001065   26-02-09
 1202                                                                                                          001066   26-02-09
 1203   // confirmAction - Get user confirmation                                                               001067   26-02-09
 1204   Dcl-Proc confirmAction;                                                                                001068   26-02-09
 1205     Dcl-Pi *N ind;                                                                                       001069   26-02-09
 1206     end-pi;                                                                                              001070   26-02-09
 1207                                                                                                          001071   26-02-09
 1208     ShowWindow(WDW_CONFIRM);                                                                             001072   26-02-09
 1209     Return (WDWCHOICE = 'Y');                                                                            001073   26-02-09
 1210   end-proc;                                                                                              001074   26-02-09
 1211                                                                                                          001075   26-02-09
 1212                                                                                                          001076   26-02-09
 1213                                                                                                          001077   26-02-09
 1214                                                                                                          001078   26-02-09
 1215                                                                                                          001079   26-02-09
 1216   // cleanupAndReturn - Clean up and prepare to return to subfile                                        001080   26-02-09
 1217   Dcl-Proc cleanupAndReturn;                                                                             001081   26-02-09
 1218     Dcl-Pi *N;                                                                                           001082   26-02-09
 1219       nextMode char(1);                                                                                  001083   26-02-09
 1220     end-pi;                                                                                              001084   26-02-09
 1221                                                                                                          001085   26-02-09
 1222     clear CRUDTASK;                                                                                      001086   26-02-09
 1223     clear OPCTASK;                                                                                       001087   26-02-09
 1224     pfkey(03) = *off;                                                                                    001088   26-02-09
 1225     initialPos = 0;                                                                                      001089   26-02-09
 1226     finalPos = PERPAGE;                                                                                  001090   26-02-09
 1227     nextMode = MODE_SUBFILE;                                                                             001091   26-02-09
 1228   end-proc;                                                                                              001092   26-02-09
                                * * * * *  E N D  O F  S O U R C E  * * * * *
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    24
                                               CROSS REFERENCE
Data Names                    Define    Reference
ACCESSTYPE                       71       CHARACTER(2) IN INFDS
ACCESSTYPE                       118      CHARACTER(2) IN INFDS_DB
ACCESSTYPE                       119      CHARACTER(2) IN INFDS_DSPF
ACCESSTYPE                       120      CHARACTER(2) IN INFDS_PRTF
ACQUIRESTATUS                    80       CHARACTER(1) IN INFDS
ACQUIRESTATUS                    118      CHARACTER(1) IN INFDS_DB
ACQUIRESTATUS                    119      CHARACTER(1) IN INFDS_DSPF
ACQUIRESTATUS                    120      CHARACTER(1) IN INFDS_PRTF
ACTIVATESUBFILE                  662      RPG PROCEDURE
ACTUALCURSOR                     65       CHARACTER(2) IN INFDS
ACTUALCURSOR                     118      CHARACTER(2) IN INFDS_DB
ACTUALCURSOR                     119      CHARACTER(2) IN INFDS_DSPF
ACTUALCURSOR                     120      CHARACTER(2) IN INFDS_PRTF
ADDTOSUBFILE                     734      RPG PROCEDURE
ALLOWBLINK                       83       CHARACTER(1) IN INFDS
ALLOWBLINK                       118      CHARACTER(1) IN INFDS_DB
ALLOWBLINK                       119      CHARACTER(1) IN INFDS_DSPF
ALLOWBLINK                       120      CHARACTER(1) IN INFDS_PRTF
BLANKSNEEDED                     391      SMALL INTEGER PRECISION(4,0) IN RPG PROCEDURE CENTERTEXT
BLOCKINCREMENT                   76       SMALL INTEGER PRECISION(4,0) IN INFDS
BLOCKINCREMENT                   118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
BLOCKINCREMENT                   119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
BLOCKINCREMENT                   120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
CCSID                            36       SMALL INTEGER PRECISION(4,0) IN INFDS
CCSID                            118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
CCSID                            119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
CCSID                            120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    25
                                               CROSS REFERENCE
CENTERED                         393      CHARACTER(80) IN RPG PROCEDURE CENTERTEXT
CENTERTEXT                       385      RPG PROCEDURE
CHECKRECORDSEXIST                554      RPG PROCEDURE
CLEANUPANDRETURN                 1217     RPG PROCEDURE
CLEAR                            155      CHARACTER(1) CCSID 65535 CONSTANT
COLORCAPABLE                     89       CHARACTER(1) IN INFDS
COLORCAPABLE                     118      CHARACTER(1) IN INFDS_DB
COLORCAPABLE                     119      CHARACTER(1) IN INFDS_DSPF
COLORCAPABLE                     120      CHARACTER(1) IN INFDS_PRTF
CONFIRMACTION                    1204     RPG PROCEDURE
CONTROLLERINFO                   88       CHARACTER(1) IN INFDS
CONTROLLERINFO                   118      CHARACTER(1) IN INFDS_DB
CONTROLLERINFO                   119      CHARACTER(1) IN INFDS_DSPF
CONTROLLERINFO                   120      CHARACTER(1) IN INFDS_PRTF
COUNT                            687      SMALL INTEGER PRECISION(4,0) IN RPG PROCEDURE FILLSUBFILE
CRUDFINALIZED                    258      CHARACTER(1)
CRUDTASKID                       18       DECIMAL(10,0)
                                          811 1042 1120
CRUD01TBL                        ****     TABLE
                                          564 636 697 758 810 943 1034 1119
CURRENTLINE                      53       SMALL INTEGER PRECISION(4,0) IN INFDS
CURRENTLINE                      118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
CURRENTLINE                      119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
CURRENTLINE                      120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
CURRENTOPERATIONS                102      CHARACTER(1) IN INFDS
CURRENTOPERATIONS                118      CHARACTER(1) IN INFDS_DB
CURRENTOPERATIONS                119      CHARACTER(1) IN INFDS_DSPF
CURRENTOPERATIONS                120      CHARACTER(1) IN INFDS_PRTF
CURRENTPAGE                      54       INTEGER PRECISION(9,0) IN INFDS
CURRENTPAGE                      118      INTEGER PRECISION(9,0) IN INFDS_DB
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    26
                                               CROSS REFERENCE
CURRENTPAGE                      119      INTEGER PRECISION(9,0) IN INFDS_DSPF
CURRENTPAGE                      120      INTEGER PRECISION(9,0) IN INFDS_PRTF
CURRENTUSER                      259      CHARACTER(10)
                                          1041
DATAAVAILABLE                    82       CHARACTER(1) IN INFDS
DATAAVAILABLE                    118      CHARACTER(1) IN INFDS_DB
DATAAVAILABLE                    119      CHARACTER(1) IN INFDS_DSPF
DATAAVAILABLE                    120      CHARACTER(1) IN INFDS_PRTF
DATERANGEERROR                   205      CHARACTER(1) IN DISPLAYINDICATORS
DELETESCREEN                     1063     RPG PROCEDURE
DESCR                            238      VARCHAR(150) IN TASKRECORD
                                          949
DESCR                            697      VARCHAR(150) CCSID 37 COLUMN (NOT NULL) IN CRUD01TBL
DESCR                            ****     COLUMN
                                          944 1036
DESCRP                           18       CHARACTER(150)
                                          1036
DEVCLASS                         103      CHARACTER(2) IN INFDS
DEVCLASS                         118      CHARACTER(2) IN INFDS_DB
DEVCLASS                         119      CHARACTER(2) IN INFDS_DSPF
DEVCLASS                         120      CHARACTER(2) IN INFDS_PRTF
DEVICECLASS                      77       CHARACTER(1) IN INFDS
DEVICECLASS                      118      CHARACTER(1) IN INFDS_DB
DEVICECLASS                      119      CHARACTER(1) IN INFDS_DSPF
DEVICECLASS                      120      CHARACTER(1) IN INFDS_PRTF
DEVICEDESC                       107      CHARACTER(10) IN INFDS
DEVICEDESC                       118      CHARACTER(10) IN INFDS_DB
DEVICEDESC                       119      CHARACTER(10) IN INFDS_DSPF
DEVICEDESC                       120      CHARACTER(10) IN INFDS_PRTF
DEVICETYPE                       78       CHARACTER(6) IN INFDS
DEVICETYPE                       118      CHARACTER(6) IN INFDS_DB
DEVICETYPE                       119      CHARACTER(6) IN INFDS_DSPF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    27
                                               CROSS REFERENCE
DEVICETYPE                       120      CHARACTER(6) IN INFDS_PRTF
DISPLAYINDICATORS                194      STRUCTURE
DISPLAYLOCATION                  85       CHARACTER(1) IN INFDS
DISPLAYLOCATION                  118      CHARACTER(1) IN INFDS_DB
DISPLAYLOCATION                  119      CHARACTER(1) IN INFDS_DSPF
DISPLAYLOCATION                  120      CHARACTER(1) IN INFDS_PRTF
DISPLAYTYPE                      86       CHARACTER(1) IN INFDS
DISPLAYTYPE                      118      CHARACTER(1) IN INFDS_DB
DISPLAYTYPE                      119      CHARACTER(1) IN INFDS_DSPF
DISPLAYTYPE                      120      CHARACTER(1) IN INFDS_PRTF
DS_SQLSTATE                      218      STRUCTURE
DUPKEY                           72       CHARACTER(1) IN INFDS
DUPKEY                           118      CHARACTER(1) IN INFDS_DB
DUPKEY                           119      CHARACTER(1) IN INFDS_DSPF
DUPKEY                           120      CHARACTER(1) IN INFDS_PRTF
ENDDATE                          238      NUMERIC(8,0) IN TASKRECORD
                                          952
ENDDATE                          18       DECIMAL(8,0)
                                          1039
ENDDATE                          252      DATE(8) IN TASKDATA
                                          709 716
ENDDATE                          ****     COLUMN
                                          696 945 1039
ENDDATE                          697      NUMERIC(8,0) COLUMN (NOT NULL) IN CRUD01TBL
ENDDATEERROR                     204      CHARACTER(1) IN DISPLAYINDICATORS
ENDDES                           238      VARCHAR(150) IN TASKRECORD
                                          950
ENDDES                           697      VARCHAR(150) CCSID 37 COLUMN IN CRUD01TBL
ENDDES                           ****     COLUMN
                                          944 1037
ENDPOS                           557      INTEGER PRECISION(9,0) IN RPG PROCEDURE CHECKRECORDSEXIST
ENTER                            125      CHARACTER(1) CCSID 65535 CONSTANT
EXISTS                           803      CHARACTER(1) IN RPG PROCEDURE VALIDATEINSERT
                                          809
FILE                             29       CHARACTER(10) IN INFDS
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    28
                                               CROSS REFERENCE
FILE                             118      CHARACTER(10) IN INFDS_DB
FILE                             119      CHARACTER(10) IN INFDS_DSPF
FILE                             120      CHARACTER(10) IN INFDS_PRTF
FILEEOF                          26       CHARACTER(1) IN INFDS
FILEEOF                          118      CHARACTER(1) IN INFDS_DB
FILEEOF                          119      CHARACTER(1) IN INFDS_DSPF
FILEEOF                          120      CHARACTER(1) IN INFDS_PRTF
FILEOPEN                         25       CHARACTER(1) IN INFDS
FILEOPEN                         118      CHARACTER(1) IN INFDS_DB
FILEOPEN                         119      CHARACTER(1) IN INFDS_DSPF
FILEOPEN                         120      CHARACTER(1) IN INFDS_PRTF
FILEPOSBITS                      111      CHARACTER(1) IN INFDS
FILEPOSBITS                      118      CHARACTER(1) IN INFDS_DB
FILEPOSBITS                      119      CHARACTER(1) IN INFDS_DSPF
FILEPOSBITS                      120      CHARACTER(1) IN INFDS_PRTF
FILETYPE                         30       SMALL INTEGER PRECISION(4,0) IN INFDS
FILETYPE                         118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
FILETYPE                         119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
FILETYPE                         120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
FILLSUBFILE                      686      RPG PROCEDURE
FINALPOS                         247      INTEGER PRECISION(9,0)
FIRSTRRNONSCREEN                 44       SMALL INTEGER PRECISION(4,0) IN INFDS
FIRSTRRNONSCREEN                 118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
FIRSTRRNONSCREEN                 119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
FIRSTRRNONSCREEN                 120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
FOOTTEXT                         18       CHARACTER(50)
FUNCKEY                          42       CHARACTER(1) IN INFDS
FUNCKEY                          118      CHARACTER(1) IN INFDS_DB
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    29
                                               CROSS REFERENCE
FUNCKEY                          119      CHARACTER(1) IN INFDS_DSPF
FUNCKEY                          120      CHARACTER(1) IN INFDS_PRTF
GETTOTALRECORDS                  750      RPG PROCEDURE
HANDLEPAGEDOWN                   528      RPG PROCEDURE
HANDLEPAGEUP                     506      RPG PROCEDURE
HANDLESQLERROR                   432      RPG PROCEDURE
HASERRORS                        776      CHARACTER(1) IN RPG PROCEDURE VALIDATESCREEN
HASERRORS                        804      CHARACTER(1) IN RPG PROCEDURE VALIDATEINSERT
HASERRORS                        854      CHARACTER(1) IN RPG PROCEDURE VALIDATEMODIFY
HELP                             126      CHARACTER(1) CCSID 65535 CONSTANT
INDERRORS                        210      CHARACTER(20) IN DISPLAYINDICATORS
INFDS                            24       STRUCTURE
INFDS_DB                         118      STRUCTURE
INFDS_DSPF                       119      STRUCTURE
INFDS_PRTF                       120      STRUCTURE
INITIALPOS                       246      INTEGER PRECISION(9,0)
                                          699
INSERTSCREEN                     886      RPG PROCEDURE
INVITESTATUS                     81       CHARACTER(1) IN INFDS
INVITESTATUS                     118      CHARACTER(1) IN INFDS_DB
INVITESTATUS                     119      CHARACTER(1) IN INFDS_DSPF
INVITESTATUS                     120      CHARACTER(1) IN INFDS_PRTF
IORCDLEN                         105      INTEGER PRECISION(9,0) IN INFDS
IORCDLEN                         118      INTEGER PRECISION(9,0) IN INFDS_DB
IORCDLEN                         119      INTEGER PRECISION(9,0) IN INFDS_DSPF
IORCDLEN                         120      INTEGER PRECISION(9,0) IN INFDS_PRTF
KEYBOARDTYPE                     87       CHARACTER(1) IN INFDS
KEYBOARDTYPE                     118      CHARACTER(1) IN INFDS_DB
KEYBOARDTYPE                     119      CHARACTER(1) IN INFDS_DSPF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    30
                                               CROSS REFERENCE
KEYBOARDTYPE                     120      CHARACTER(1) IN INFDS_PRTF
KEYLEN                           33       SMALL INTEGER PRECISION(4,0) IN INFDS
KEYLEN                           118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
KEYLEN                           119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
KEYLEN                           120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
KEYLENGTH                        114      SMALL INTEGER PRECISION(4,0) IN INFDS
KEYLENGTH                        118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
KEYLENGTH                        119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
KEYLENGTH                        120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
LENGTH                           388      SMALL INTEGER PRECISION(4,0) IN RPG PROCEDURE CENTERTEXT
LIB                              31       CHARACTER(10) IN INFDS
LIB                              118      CHARACTER(10) IN INFDS_DB
LIB                              119      CHARACTER(10) IN INFDS_DSPF
LIB                              120      CHARACTER(10) IN INFDS_PRTF
LISTINGLINE                      27       CHARACTER(8) IN INFDS
LISTINGLINE                      118      CHARACTER(8) IN INFDS_DB
LISTINGLINE                      119      CHARACTER(8) IN INFDS_DSPF
LISTINGLINE                      120      CHARACTER(8) IN INFDS_PRTF
LOADDATATORECORD                 1187     RPG PROCEDURE
LOADDATATOSCREEN                 1171     RPG PROCEDURE
LOADTASKBYID                     627      RPG PROCEDURE
MAINLINE                         265      RPG PROCEDURE
MAX_RRN                          187      SMALL INTEGER PRECISION(4,0) CONSTANT
MAXRCDSINBLOCK                   75       SMALL INTEGER PRECISION(4,0) IN INFDS
MAXRCDSINBLOCK                   118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
MAXRCDSINBLOCK                   119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
MAXRCDSINBLOCK                   120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
MBR                              34       CHARACTER(10) IN INFDS
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    31
                                               CROSS REFERENCE
MBR                              118      CHARACTER(10) IN INFDS_DB
MBR                              119      CHARACTER(10) IN INFDS_DSPF
MBR                              120      CHARACTER(10) IN INFDS_PRTF
MEMBERNUMBER                     115      SMALL INTEGER PRECISION(4,0) IN INFDS
MEMBERNUMBER                     118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
MEMBERNUMBER                     119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
MEMBERNUMBER                     120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
MISCFLAGS1                       90       CHARACTER(1) IN INFDS
MISCFLAGS1                       118      CHARACTER(1) IN INFDS_DB
MISCFLAGS1                       119      CHARACTER(1) IN INFDS_DSPF
MISCFLAGS1                       120      CHARACTER(1) IN INFDS_PRTF
MISCFLAGS2                       93       CHARACTER(1) IN INFDS
MISCFLAGS2                       118      CHARACTER(1) IN INFDS_DB
MISCFLAGS2                       119      CHARACTER(1) IN INFDS_DSPF
MISCFLAGS2                       120      CHARACTER(1) IN INFDS_PRTF
MISCFLAGS3                       96       CHARACTER(1) IN INFDS
MISCFLAGS3                       118      CHARACTER(1) IN INFDS_DB
MISCFLAGS3                       119      CHARACTER(1) IN INFDS_DSPF
MISCFLAGS3                       120      CHARACTER(1) IN INFDS_PRTF
MODE                             292      CHARACTER(1) IN RPG PROCEDURE WRITESCREEN
MODE                             333      CHARACTER(1) IN RPG PROCEDURE SHOWSCREEN
MODE                             453      CHARACTER(1) IN RPG PROCEDURE SHOWSUBFILE
MODE                             508      CHARACTER(1) IN RPG PROCEDURE HANDLEPAGEUP
MODE                             530      CHARACTER(1) IN RPG PROCEDURE HANDLEPAGEDOWN
MODE                             773      CHARACTER(1) IN RPG PROCEDURE VALIDATESCREEN
MODE                             888      CHARACTER(1) IN RPG PROCEDURE INSERTSCREEN
MODE                             978      CHARACTER(1) IN RPG PROCEDURE MODIFYSCREEN
MODE                             1065     CHARACTER(1) IN RPG PROCEDURE DELETESCREEN
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    32
                                               CROSS REFERENCE
MODE                             1143     CHARACTER(1) IN RPG PROCEDURE VIEWSCREEN
MODE_DELETE                      165      CHARACTER(1) CONSTANT
MODE_INSERT                      163      CHARACTER(1) CONSTANT
MODE_MODIFY                      164      CHARACTER(1) CONSTANT
MODE_SUBFILE                     167      CHARACTER(1) CONSTANT
MODE_VIEW                        166      CHARACTER(1) CONSTANT
MODIFYSCREEN                     976      RPG PROCEDURE
MSGID                            56       CHARACTER(7) IN INFDS
MSGID                            118      CHARACTER(7) IN INFDS_DB
MSGID                            119      CHARACTER(7) IN INFDS_DSPF
MSGID                            120      CHARACTER(7) IN INFDS_PRTF
NAME                             238      VARCHAR(10) IN TASKRECORD
                                          948
NAME                             252      CHARACTER(20) IN TASKDATA
                                          708 715
NAME                             ****     COLUMN
                                          696 944 1035
NAME                             697      VARCHAR(10) CCSID 37 COLUMN (NOT NULL) IN CRUD01TBL
NAMETASK                         18       CHARACTER(10)
                                          1035
NBRLOCKEDRCDS                    110      SMALL INTEGER PRECISION(4,0) IN INFDS
NBRLOCKEDRCDS                    118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NBRLOCKEDRCDS                    119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NBRLOCKEDRCDS                    120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NBROFCOL                         69       SMALL INTEGER PRECISION(4,0) IN INFDS
NBROFCOL                         118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NBROFCOL                         119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NBROFCOL                         120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NBROFROWS                        68       SMALL INTEGER PRECISION(4,0) IN INFDS
NBROFROWS                        118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NBROFROWS                        119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NBROFROWS                        120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    33
                                               CROSS REFERENCE
NBRRCDS                          70       INTEGER PRECISION(9,0) IN INFDS
NBRRCDS                          118      INTEGER PRECISION(9,0) IN INFDS_DB
NBRRCDS                          119      INTEGER PRECISION(9,0) IN INFDS_DSPF
NBRRCDS                          120      INTEGER PRECISION(9,0) IN INFDS_PRTF
NEXTMODE                         456      CHARACTER(1) IN RPG PROCEDURE SHOWSUBFILE
NEXTMODE                         577      CHARACTER(1) IN RPG PROCEDURE PROCESSSUBFILEOPTIONS
NEXTMODE                         891      CHARACTER(1) IN RPG PROCEDURE INSERTSCREEN
NEXTMODE                         981      CHARACTER(1) IN RPG PROCEDURE MODIFYSCREEN
NEXTMODE                         1068     CHARACTER(1) IN RPG PROCEDURE DELETESCREEN
NEXTMODE                         1146     CHARACTER(1) IN RPG PROCEDURE VIEWSCREEN
NEXTMODE                         1219     CHARACTER(1) IN RPG PROCEDURE CLEANUPANDRETURN
NODATA_ON_SQL                    183      CHARACTER(2) CONSTANT
NUM_DEVS                         97       SMALL INTEGER PRECISION(4,0) IN INFDS
NUM_DEVS                         118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUM_DEVS                         119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUM_DEVS                         120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NUMBASEDMBRS                     92       SMALL INTEGER PRECISION(4,0) IN INFDS
NUMBASEDMBRS                     118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUMBASEDMBRS                     119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUMBASEDMBRS                     120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NUMBEROFCOLS                     67       SMALL INTEGER PRECISION(4,0) IN INFDS
NUMBEROFCOLS                     118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUMBEROFCOLS                     119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUMBEROFCOLS                     120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
NUMBEROFROWS                     66       SMALL INTEGER PRECISION(4,0) IN INFDS
NUMBEROFROWS                     118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUMBEROFROWS                     119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUMBEROFROWS                     120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    34
                                               CROSS REFERENCE
NUMKEYS                          113      SMALL INTEGER PRECISION(4,0) IN INFDS
NUMKEYS                          118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
NUMKEYS                          119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
NUMKEYS                          120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
ODPTYPE                          57       CHARACTER(2) IN INFDS
ODPTYPE                          118      CHARACTER(2) IN INFDS_DB
ODPTYPE                          119      CHARACTER(2) IN INFDS_DSPF
ODPTYPE                          120      CHARACTER(2) IN INFDS_PRTF
OEPCOUNT                         91       SMALL INTEGER PRECISION(4,0) IN INFDS
OEPCOUNT                         118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
OEPCOUNT                         119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
OEPCOUNT                         120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
ONLINEOFFLINE                    84       CHARACTER(1) IN INFDS
ONLINEOFFLINE                    118      CHARACTER(1) IN INFDS_DB
ONLINEOFFLINE                    119      CHARACTER(1) IN INFDS_DSPF
ONLINEOFFLINE                    120      CHARACTER(1) IN INFDS_PRTF
OPCTASK                          18       CHARACTER(1)
OPENID                           94       CHARACTER(2) IN INFDS
OPENID                           118      CHARACTER(2) IN INFDS_DB
OPENID                           119      CHARACTER(2) IN INFDS_DSPF
OPENID                           120      CHARACTER(2) IN INFDS_PRTF
OPERATION                        434      VARCHAR(50) IN RPG PROCEDURE HANDLESQLERROR
OPT_DELETE                       177      CHARACTER(1) CONSTANT
OPT_MODIFY                       176      CHARACTER(1) CONSTANT
OPT_VIEW                         178      CHARACTER(1) CONSTANT
OTHERIOCOUNT                     101      INTEGER PRECISION(9,0) IN INFDS
OTHERIOCOUNT                     118      INTEGER PRECISION(9,0) IN INFDS_DB
OTHERIOCOUNT                     119      INTEGER PRECISION(9,0) IN INFDS_DSPF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    35
                                               CROSS REFERENCE
OTHERIOCOUNT                     120      INTEGER PRECISION(9,0) IN INFDS_PRTF
OVERFLOW                         52       SMALL INTEGER PRECISION(4,0) IN INFDS
OVERFLOW                         118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
OVERFLOW                         119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
OVERFLOW                         120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
OWNER                            238      VARCHAR(10) IN TASKRECORD
                                          954
OWNER                            697      VARCHAR(10) CCSID 37 COLUMN (NOT NULL) IN CRUD01TBL
OWNER                            ****     COLUMN
                                          945 1041
PAGEDOWN                         128      CHARACTER(1) CCSID 65535 CONSTANT
PAGESIZE                         51       SMALL INTEGER PRECISION(4,0) IN INFDS
PAGESIZE                         118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
PAGESIZE                         119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
PAGESIZE                         120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
PAGEUP                           127      CHARACTER(1) CCSID 65535 CONSTANT
PERFORMDELETE                    1113     RPG PROCEDURE
PERFORMINSERT                    935      RPG PROCEDURE
PERFORMUPDATE                    1028     RPG PROCEDURE
PERPAGE                          186      SMALL INTEGER PRECISION(4,0) CONSTANT
                                          700
PFKEY01                          131      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY02                          132      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY03                          133      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY04                          134      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY05                          135      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY06                          136      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY07                          137      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY08                          138      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY09                          139      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY10                          140      CHARACTER(1) CCSID 65535 CONSTANT
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    36
                                               CROSS REFERENCE
PFKEY11                          141      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY12                          142      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY13                          143      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY14                          144      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY15                          145      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY16                          146      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY17                          147      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY18                          148      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY19                          149      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY20                          150      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY21                          151      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY22                          152      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY23                          153      CHARACTER(1) CCSID 65535 CONSTANT
PFKEY24                          154      CHARACTER(1) CCSID 65535 CONSTANT
PGMDEVICE                        106      CHARACTER(10) IN INFDS
PGMDEVICE                        118      CHARACTER(10) IN INFDS_DB
PGMDEVICE                        119      CHARACTER(10) IN INFDS_DSPF
PGMDEVICE                        120      CHARACTER(10) IN INFDS_PRTF
PGMDEVNAME                       104      CHARACTER(10) IN INFDS
PGMDEVNAME                       118      CHARACTER(10) IN INFDS_DB
PGMDEVNAME                       119      CHARACTER(10) IN INFDS_DSPF
PGMDEVNAME                       120      CHARACTER(10) IN INFDS_PRTF
PREVFINALPOS                     249      INTEGER PRECISION(9,0)
PREVINITIALPOS                   248      INTEGER PRECISION(9,0)
PRINT                            129      CHARACTER(1) CCSID 65535 CONSTANT
PRINTCURRENTLINE                 49       SMALL INTEGER PRECISION(4,0) IN INFDS
PRINTCURRENTLINE                 118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
PRINTCURRENTLINE                 119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    37
                                               CROSS REFERENCE
PRINTCURRENTLINE                 120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
PRINTOVERFLOW                    48       SMALL INTEGER PRECISION(4,0) IN INFDS
PRINTOVERFLOW                    118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
PRINTOVERFLOW                    119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
PRINTOVERFLOW                    120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
PRINTPAGESIZE                    47       SMALL INTEGER PRECISION(4,0) IN INFDS
PRINTPAGESIZE                    118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
PRINTPAGESIZE                    119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
PRINTPAGESIZE                    120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
PROCESSSUBFILEOPTIONS            575      RPG PROCEDURE
PROTECTFIELDS_35                 206      CHARACTER(1) IN DISPLAYINDICATORS
PROTECTFIELDS_36                 207      CHARACTER(1) IN DISPLAYINDICATORS
PSQLSTATE                        217
PTRDISPLAYINDICATORS             193
RCDDELETEDBITS                   112      CHARACTER(1) IN INFDS
RCDDELETEDBITS                   118      CHARACTER(1) IN INFDS_DB
RCDDELETEDBITS                   119      CHARACTER(1) IN INFDS_DSPF
RCDDELETEDBITS                   120      CHARACTER(1) IN INFDS_PRTF
RCDFMT                           38       CHARACTER(10) IN INFDS
RCDFMT                           118      CHARACTER(10) IN INFDS_DB
RCDFMT                           119      CHARACTER(10) IN INFDS_DSPF
RCDFMT                           120      CHARACTER(10) IN INFDS_PRTF
RCDFMTLEN                        95       SMALL INTEGER PRECISION(4,0) IN INFDS
RCDFMTLEN                        118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
RCDFMTLEN                        119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
RCDFMTLEN                        120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
RCDLEN                           32       SMALL INTEGER PRECISION(4,0) IN INFDS
RCDLEN                           118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
RCDLEN                           119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    38
                                               CROSS REFERENCE
RCDLEN                           120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
RCDSREADSINCEOPEN                35       INTEGER PRECISION(9,0) IN INFDS
RCDSREADSINCEOPEN                118      INTEGER PRECISION(9,0) IN INFDS_DB
RCDSREADSINCEOPEN                119      INTEGER PRECISION(9,0) IN INFDS_DSPF
RCDSREADSINCEOPEN                120      INTEGER PRECISION(9,0) IN INFDS_PRTF
READCOUNT                        99       INTEGER PRECISION(9,0) IN INFDS
READCOUNT                        118      INTEGER PRECISION(9,0) IN INFDS_DB
READCOUNT                        119      INTEGER PRECISION(9,0) IN INFDS_DSPF
READCOUNT                        120      INTEGER PRECISION(9,0) IN INFDS_PRTF
RECORDBACKSPAC                   130      CHARACTER(1) CCSID 65535 CONSTANT
RECORDCOUNT                      560      INTEGER PRECISION(9,0) IN RPG PROCEDURE CHECKRECORDSEXIST
                                          563
RECORDEXISTS                     533      CHARACTER(1) IN RPG PROCEDURE HANDLEPAGEDOWN
REQUESTER                        79       CHARACTER(1) IN INFDS
REQUESTER                        118      CHARACTER(1) IN INFDS_DB
REQUESTER                        119      CHARACTER(1) IN INFDS_DSPF
REQUESTER                        120      CHARACTER(1) IN INFDS_PRTF
RESETERRORS                      420      RPG PROCEDURE
ROWCOLUMN                        43       SMALL INTEGER PRECISION(4,0) IN INFDS
ROWCOLUMN                        118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
ROWCOLUMN                        119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
ROWCOLUMN                        120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
RRN                              40       INTEGER PRECISION(9,0) IN INFDS
RRN                              580      SMALL INTEGER PRECISION(4,0) IN RPG PROCEDURE PROCESSSUBFILEOPTIONS
RRN                              118      INTEGER PRECISION(9,0) IN INFDS_DB
RRN                              119      INTEGER PRECISION(9,0) IN INFDS_DSPF
RRN                              120      INTEGER PRECISION(9,0) IN INFDS_PRTF
RRNLASTREAD                      37       INTEGER PRECISION(9,0) IN INFDS
RRNLASTREAD                      118      INTEGER PRECISION(9,0) IN INFDS_DB
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    39
                                               CROSS REFERENCE
RRNLASTREAD                      119      INTEGER PRECISION(9,0) IN INFDS_DSPF
RRNLASTREAD                      120      INTEGER PRECISION(9,0) IN INFDS_PRTF
SCREENMODE                       266      CHARACTER(1) IN RPG PROCEDURE MAINLINE
SFLCLR                           198      CHARACTER(1) IN DISPLAYINDICATORS
SFLDSP                           196      CHARACTER(1) IN DISPLAYINDICATORS
SFLDSPCTL                        197      CHARACTER(1) IN DISPLAYINDICATORS
SFLEND                           199      CHARACTER(1) IN DISPLAYINDICATORS
SFLENDDATE                       18       DECIMAL(8,0)
SFLINITIAL                       647      RPG PROCEDURE
SFLMINRRN                        63       SMALL INTEGER PRECISION(4,0) IN INFDS
SFLMINRRN                        118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
SFLMINRRN                        119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SFLMINRRN                        120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SFLNUMRCDS                       64       SMALL INTEGER PRECISION(4,0) IN INFDS
SFLNUMRCDS                       118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
SFLNUMRCDS                       119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SFLNUMRCDS                       120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SFLRCDNBR                        39       SMALL INTEGER PRECISION(4,0) IN INFDS
SFLRCDNBR                        118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
SFLRCDNBR                        119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SFLRCDNBR                        120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SFLRRN                           62       SMALL INTEGER PRECISION(4,0) IN INFDS
SFLRRN                           118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
SFLRRN                           119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SFLRRN                           120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SFLSTATE                         18       DECIMAL(2,0)
SFLSTRDATE                       18       DECIMAL(8,0)
SFLTASKID                        18       DECIMAL(10,0)
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    40
                                               CROSS REFERENCE
SFLTASKNAM                       18       CHARACTER(10)
SHOWSCREEN                       331      RPG PROCEDURE
SHOWSUBFILE                      451      RPG PROCEDURE
SHOWWINDOW                       355      RPG PROCEDURE
SOLUTION                         18       CHARACTER(150)
                                          1037
SPLF                             58       CHARACTER(10) IN INFDS
SPLF                             118      CHARACTER(10) IN INFDS_DB
SPLF                             119      CHARACTER(10) IN INFDS_DSPF
SPLF                             120      CHARACTER(10) IN INFDS_PRTF
SPLFLIB                          59       CHARACTER(10) IN INFDS
SPLFLIB                          118      CHARACTER(10) IN INFDS_DB
SPLFLIB                          119      CHARACTER(10) IN INFDS_DSPF
SPLFLIB                          120      CHARACTER(10) IN INFDS_PRTF
SPLFNUMBER                       60       SMALL INTEGER PRECISION(4,0) IN INFDS
SPLFNUMBER                       118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
SPLFNUMBER                       119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
SPLFNUMBER                       120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
SRCFILE                          73       CHARACTER(1) IN INFDS
SRCFILE                          118      CHARACTER(1) IN INFDS_DB
SRCFILE                          119      CHARACTER(1) IN INFDS_DSPF
SRCFILE                          120      CHARACTER(1) IN INFDS_PRTF
STARTDATE                        238      NUMERIC(8,0) IN TASKRECORD
                                          951
STARTDATE                        18       DECIMAL(8,0)
                                          1038
STARTDATE                        252      DATE(8) IN TASKDATA
                                          709 716
STARTDATE                        ****     COLUMN
                                          696 945 1038
STARTDATE                        697      NUMERIC(8,0) COLUMN (NOT NULL) IN CRUD01TBL
STARTDATEERROR                   203      CHARACTER(1) IN DISPLAYINDICATORS
STARTPOS                         392      SMALL INTEGER PRECISION(4,0) IN RPG PROCEDURE CENTERTEXT
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    41
                                               CROSS REFERENCE
STARTPOS                         556      INTEGER PRECISION(9,0) IN RPG PROCEDURE CHECKRECORDSEXIST
STATE                            238      NUMERIC(1,0) IN TASKRECORD
                                          953
STATE                            252
STATE                            ****     COLUMN
                                          696 945 1040
STATE                            697      NUMERIC(1,0) COLUMN (NOT NULL) IN CRUD01TBL
STATE                            ****     IN TASKDATA
                                          710 717
STATETASK                        18       DECIMAL(1,0)
                                          1040
SUBFILERRN                       245      SMALL INTEGER PRECISION(4,0)
SUCCESS_ON_SQL                   181      CHARACTER(2) CONSTANT
TASK_CURSOR                      695      CURSOR
                                          702 708 715 720
TASK_ID                          238      NUMERIC(10,0) IN TASKRECORD
                                          947
TASK_ID                          ****     COLUMN
                                          637 696 698 811 944 1042 1120
TASK_ID                          697      NUMERIC(10,0) COLUMN (NOT NULL) IN CRUD01TBL
TASKDATA                         252      STRUCTURE
TASKDATA                         ****     710
TASKID                           629      INTEGER PRECISION(9,0) IN RPG PROCEDURE LOADTASKBYID
                                          637
TASKID                           252      INTEGER PRECISION(9,0) IN TASKDATA
                                          708 715
TASKIDEXISTSERROR                202      CHARACTER(1) IN DISPLAYINDICATORS
TASKRECORD                       238      STRUCTURE
                                          635
TEXT                             387      CHARACTER(80) IN RPG PROCEDURE CENTERTEXT
TEXTLEN                          394      SMALL INTEGER PRECISION(4,0) IN RPG PROCEDURE CENTERTEXT
TITLE1                           18       CHARACTER(50)
TITLE2                           18       CHARACTER(50)
TITLE3                           18       CHARACTER(50)
TOTAL                            754      INTEGER PRECISION(9,0) IN RPG PROCEDURE GETTOTALRECORDS
                                          757
TOTALRECORDS                     663      INTEGER PRECISION(9,0) IN RPG PROCEDURE ACTIVATESUBFILE
TOTALSFLROWS                     45       SMALL INTEGER PRECISION(4,0) IN INFDS
TOTALSFLROWS                     118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
TOTALSFLROWS                     119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    42
                                               CROSS REFERENCE
TOTALSFLROWS                     120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
USER                             108      CHARACTER(10) IN INFDS
USER                             118      CHARACTER(10) IN INFDS_DB
USER                             119      CHARACTER(10) IN INFDS_DSPF
USER                             120      CHARACTER(10) IN INFDS_PRTF
VALIDATEINSERT                   799      RPG PROCEDURE
VALIDATEMODIFY                   850      RPG PROCEDURE
VALIDATESCREEN                   771      RPG PROCEDURE
VIEWSCREEN                       1141     RPG PROCEDURE
VOLUMELAVELOFFSET                74       SMALL INTEGER PRECISION(4,0) IN INFDS
VOLUMELAVELOFFSET                118      SMALL INTEGER PRECISION(4,0) IN INFDS_DB
VOLUMELAVELOFFSET                119      SMALL INTEGER PRECISION(4,0) IN INFDS_DSPF
VOLUMELAVELOFFSET                120      SMALL INTEGER PRECISION(4,0) IN INFDS_PRTF
WARNING_ON_SQL                   182      CHARACTER(2) CONSTANT
WDW_CONFIRM                      170      CHARACTER(1) CONSTANT
WDW_DELETE                       172      CHARACTER(1) CONSTANT
WDW_ERROR                        173      CHARACTER(1) CONSTANT
WDW_MESSAGE                      171      CHARACTER(1) CONSTANT
WDWCHOICE                        18       CHARACTER(1)
WDWMSG1                          18       CHARACTER(40)
WDWMSG2                          18       CHARACTER(40)
WDWTEXT1                         18       CHARACTER(40)
WDWTEXT2                         18       CHARACTER(40)
WHERECLAUSE                      255      VARCHAR(500)
WINDOWTYPE                       357      CHARACTER(1) IN RPG PROCEDURE SHOWWINDOW
WRITECOUNT                       98       INTEGER PRECISION(9,0) IN INFDS
WRITECOUNT                       118      INTEGER PRECISION(9,0) IN INFDS_DB
WRITECOUNT                       119      INTEGER PRECISION(9,0) IN INFDS_DSPF
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    43
                                               CROSS REFERENCE
WRITECOUNT                       120      INTEGER PRECISION(9,0) IN INFDS_PRTF
WRITEREADCOUNT                   100      INTEGER PRECISION(9,0) IN INFDS
WRITEREADCOUNT                   118      INTEGER PRECISION(9,0) IN INFDS_DB
WRITEREADCOUNT                   119      INTEGER PRECISION(9,0) IN INFDS_DSPF
WRITEREADCOUNT                   120      INTEGER PRECISION(9,0) IN INFDS_PRTF
WRITESCREEN                      290      RPG PROCEDURE
XSQLSTATE                        219      CHARACTER(2) IN DS_SQLSTATE
5770ST1 V7R5M0 220415            Create SQL ILE RPG Object         CRUD01RPG                   26-02-09 16:36:34          Page    44
                                             DIAGNOSTIC MESSAGES
MSG ID  SEV  RECORD  TEXT
SQL0312  30     710  Position 37 Variable TASKDATA not defined or not usable
                     for reason code 1.
SQL0312  30     710  Position 46 Variable STATE not defined or not usable for
                     reason code 1.
SQL0312  30     717  Position 48 Variable STATE not defined or not usable for
                     reason code 1.
                    Message Summary
  Total     Info   Warning      Error   Severe  Terminal
      3        0         0          0        3         0
30 level severity errors found in source
 1228 Source records processed
                               * * * * *  E N D  O F  L I S T I N G  * * * * *
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

